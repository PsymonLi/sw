rx: 0, bad :0, processed: 0 linesrx: 0, bad :0, processed: 0 linesrx: 0, bad :0, processed: 0 linesrx: 0, bad :0, processed: 0 linesrx: 0, bad :0, processed: 0 linesrx: 0, bad :0, processed: 0 linesrx: 0, bad :0, processed: 0 linesrx: 293, bad :0, processed: 293 linesrx: 293, bad :0, processed: 293 linesrx: 294, bad :0, processed: 294 linesrx: 294, bad :0, processed: 294 linesrx: 294, bad :0, processed: 294 linesrx: 330, bad :0, processed: 330 linesrx: 330, bad :0, processed: 330 linesrx: 330, bad :0, processed: 330 linesrx: 415, bad :0, processed: 415 linesrx: 415, bad :0, processed: 415 linesrx: 415, bad :0, processed: 415 linesrx: 416, bad :0, processed: 416 linesrx: 416, bad :0, processed: 416 linesrx: 416, bad :0, processed: 416 linesrx: 479, bad :0, processed: 479 linesrx: 479, bad :0, processed: 479 linesrx: 479, bad :0, processed: 479 linesrx: 480, bad :0, processed: 480 linesrx: 480, bad :0, processed: 480 linesrx: 480, bad :0, processed: 480 linesrx: 543, bad :0, processed: 543 linesrx: 543, bad :0, processed: 543 linesrx: 543, bad :0, processed: 543 linesrx: 544, bad :0, processed: 544 linesrx: 544, bad :0, processed: 544 linesrx: 544, bad :0, processed: 544 linesrx: 619, bad :0, processed: 619 linesrx: 619, bad :0, processed: 619 linesrx: 619, bad :0, processed: 619 linesrx: 620, bad :0, processed: 620 linesrx: 620, bad :0, processed: 620 linesrx: 620, bad :0, processed: 620 linesrx: 703, bad :0, processed: 703 linesrx: 703, bad :0, processed: 703 linesrx: 703, bad :0, processed: 703 linesrx: 704, bad :0, processed: 704 linesrx: 704, bad :0, processed: 704 linesrx: 704, bad :0, processed: 704 linesrx: 707, bad :0, processed: 707 linesrx: 707, bad :0, processed: 707 linesrx: 707, bad :0, processed: 707 linesrx: 719, bad :0, processed: 719 linesrx: 719, bad :0, processed: 719 linesrx: 719, bad :0, processed: 719 linesrx: 744, bad :0, processed: 744 linesrx: 784, bad :0, processed: 784 linesrx: 784, bad :0, processed: 784 linesrx: 784, bad :0, processed: 784 linesrx: 896, bad :0, processed: 896 linesrx: 896, bad :0, processed: 896 linesrx: 896, bad :0, processed: 896 linesrx: 897, bad :0, processed: 897 linesrx: 897, bad :0, processed: 897 linesrx: 897, bad :0, processed: 897 linesrx: 914, bad :0, processed: 914 linesrx: 952, bad :0, processed: 952 linesrx: 952, bad :0, processed: 952 linesrx: 952, bad :0, processed: 952 linesrx: 1050, bad :0, processed: 1050 linesrx: 1050, bad :0, processed: 1050 linesrx: 1050, bad :0, processed: 1050 linesrx: 1051, bad :0, processed: 1051 linesrx: 1051, bad :0, processed: 1051 linesrx: 1051, bad :0, processed: 1051 linesrx: 1068, bad :0, processed: 1068 linesrx: 1068, bad :0, processed: 1068 linesrx: 1106, bad :0, processed: 1106 linesrx: 1106, bad :0, processed: 1106 linesrx: 1106, bad :0, processed: 1106 linesrx: 1192, bad :0, processed: 1192 linesrx: 1192, bad :0, processed: 1192 linesrx: 1192, bad :0, processed: 1192 linesrx: 1193, bad :0, processed: 1193 linesrx: 1193, bad :0, processed: 1193 linesrx: 1193, bad :0, processed: 1193 linesrx: 1214, bad :0, processed: 1214 linesrx: 1252, bad :0, processed: 1252 linesrx: 1252, bad :0, processed: 1252 linesrx: 1252, bad :0, processed: 1252 linesrx: 1338, bad :0, processed: 1338 linesrx: 1338, bad :0, processed: 1338 linesrx: 1338, bad :0, processed: 1338 linesrx: 1339, bad :0, processed: 1339 linesrx: 1339, bad :0, processed: 1339 linesrx: 1339, bad :0, processed: 1339 linesrx: 1368, bad :0, processed: 1368 linesrx: 1406, bad :0, processed: 1406 linesrx: 1406, bad :0, processed: 1406 linesrx: 1406, bad :0, processed: 1406 linesrx: 1516, bad :0, processed: 1516 linesrx: 1516, bad :0, processed: 1516 linesrx: 1516, bad :0, processed: 1516 linesrx: 1517, bad :0, processed: 1517 linesrx: 1517, bad :0, processed: 1517 linesrx: 1517, bad :0, processed: 1517 linesrx: 1520, bad :0, processed: 1520 linesrx: 1520, bad :0, processed: 1520 linesrx: 1520, bad :0, processed: 1520 linesrx: 1530, bad :0, processed: 1530 linesrx: 1530, bad :0, processed: 1530 linesrx: 1530, bad :0, processed: 1530 linesrx: 1563, bad :0, processed: 1563 linesrx: 1563, bad :0, processed: 1563 linesrx: 1563, bad :0, processed: 1563 linesrx: 1584, bad :0, processed: 1584 linesrx: 1584, bad :0, processed: 1584 linesrx: 1584, bad :0, processed: 1584 linesrx: 1605, bad :0, processed: 1605 linesrx: 1605, bad :0, processed: 1605 linesrx: 1605, bad :0, processed: 1605 linesrx: 1626, bad :0, processed: 1626 linesrx: 1626, bad :0, processed: 1626 linesrx: 1626, bad :0, processed: 1626 linesrx: 1647, bad :0, processed: 1647 linesrx: 1647, bad :0, processed: 1647 linesrx: 1647, bad :0, processed: 1647 linesrx: 1650, bad :0, processed: 1650 linesrx: 1650, bad :0, processed: 1650 linesrx: 1650, bad :0, processed: 1650 linesrx: 1674, bad :0, processed: 1674 linesrx: 1674, bad :0, processed: 1674 linesrx: 1674, bad :0, processed: 1674 linesrx: 1692, bad :0, processed: 1692 linesrx: 1692, bad :0, processed: 1692 linesrx: 1692, bad :0, processed: 1692 linesrx: 1818, bad :0, processed: 1818 linesrx: 1818, bad :0, processed: 1818 linesrx: 1818, bad :0, processed: 1818 linesrx: 1885, bad :0, processed: 1885 linesrx: 1885, bad :0, processed: 1885 linesrx: 1885, bad :0, processed: 1885 linesrx: 1906, bad :0, processed: 1906 linesrx: 1906, bad :0, processed: 1906 linesrx: 1906, bad :0, processed: 1906 linesrx: 2048, bad :0, processed: 2048 linesrx: 2207, bad :0, processed: 2207 linesrx: 2207, bad :0, processed: 2207 linesrx: 2207, bad :0, processed: 2207 linesrx: 2337, bad :0, processed: 2337 linesrx: 2337, bad :0, processed: 2337 linesrx: 2337, bad :0, processed: 2337 linesrx: 2423, bad :0, processed: 2423 linesrx: 2423, bad :0, processed: 2423 linesrx: 2423, bad :0, processed: 2423 linesrx: 2509, bad :0, processed: 2509 linesrx: 2509, bad :0, processed: 2509 linesrx: 2509, bad :0, processed: 2509 linesrx: 2512, bad :0, processed: 2512 linesrx: 2512, bad :0, processed: 2512 linesrx: 2512, bad :0, processed: 2512 linesrx: 2545, bad :0, processed: 2545 linesrx: 2545, bad :0, processed: 2545 linesrx: 2545, bad :0, processed: 2545 linesrx: 2638, bad :0, processed: 2638 linesrx: 2664, bad :0, processed: 2664 linesrx: 2664, bad :0, processed: 2664 linesrx: 2664, bad :0, processed: 2664 linesrx: 2731, bad :0, processed: 2731 linesrx: 2731, bad :0, processed: 2731 linesrx: 2731, bad :0, processed: 2731 linesrx: 2732, bad :0, processed: 2732 linesrx: 2732, bad :0, processed: 2732 linesrx: 2732, bad :0, processed: 2732 linesrx: 2795, bad :0, processed: 2795 linesrx: 2795, bad :0, processed: 2795 linesrx: 2795, bad :0, processed: 2795 linesrx: 2796, bad :0, processed: 2796 linesrx: 2796, bad :0, processed: 2796 linesrx: 2796, bad :0, processed: 2796 linesrx: 2877, bad :0, processed: 2877 linesrx: 2877, bad :0, processed: 2877 linesrx: 2877, bad :0, processed: 2877 linesrx: 2878, bad :0, processed: 2878 linesrx: 2878, bad :0, processed: 2878 linesrx: 2878, bad :0, processed: 2878 linesrx: 2947, bad :0, processed: 2947 linesrx: 2947, bad :0, processed: 2947 linesrx: 2947, bad :0, processed: 2947 linesrx: 2948, bad :0, processed: 2948 linesrx: 2948, bad :0, processed: 2948 linesrx: 2948, bad :0, processed: 2948 linesrx: 2951, bad :0, processed: 2951 linesrx: 2951, bad :0, processed: 2951 linesrx: 2951, bad :0, processed: 2951 linesrx: 2980, bad :0, processed: 2980 linesrx: 2980, bad :0, processed: 2980 linesrx: 2980, bad :0, processed: 2980 linesrx: 3022, bad :0, processed: 3022 linesrx: 3022, bad :0, processed: 3022 linesrx: 3022, bad :0, processed: 3022 linesrx: 3056, bad :0, processed: 3056 linesrx: 3056, bad :0, processed: 3056 linesrx: 3056, bad :0, processed: 3056 linesrx: 3081, bad :0, processed: 3081 linesrx: 3120, bad :0, processed: 3120 linesrx: 3120, bad :0, processed: 3120 linesrx: 3120, bad :0, processed: 3120 linesrx: 3141, bad :0, processed: 3141 linesrx: 3141, bad :0, processed: 3141 linesrx: 3141, bad :0, processed: 3141 linesrx: 3162, bad :0, processed: 3162 linesrx: 3162, bad :0, processed: 3162 linesrx: 3162, bad :0, processed: 3162 linesrx: 3183, bad :0, processed: 3183 linesrx: 3183, bad :0, processed: 3183 linesrx: 3183, bad :0, processed: 3183 linesrx: 3186, bad :0, processed: 3186 linesrx: 3186, bad :0, processed: 3186 linesrx: 3186, bad :0, processed: 3186 linesrx: 3217, bad :0, processed: 3217 linesrx: 3217, bad :0, processed: 3217 linesrx: 3217, bad :0, processed: 3217 lines====================== done =============== 
github.com/pensando/sw/venice/citadel/test/integ (0/1) failed 
[1] TestCitadelInteg	 failed
0 === RUN   TestCitadelInteg

ts=2019-03-01T04:16:03.477231Z module=Default pid=20890 caller=meta.go:164 level=warn msg="failed to load etcd credentials"

ts=2019-03-01T04:16:03.478831Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7400, TLS: false"

ts=2019-03-01T04:16:03.479117Z module=Default pid=20890 caller=watcher.go:128 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/tstore, version: 0"

ts=2019-03-01T04:16:03.479288Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.479318Z module=Default pid=20890 caller=watcher.go:141 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/kstore, version: 0"

ts=2019-03-01T04:16:03.479353Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.480838Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info nodeuuid=dnode-0 msg="created query aggregator with db /tmp/citadel/qstore/0"

ts=2019-03-01T04:16:03.480881Z module=Default pid=20890 caller=meta.go:502 level=error msg="Error reading cluster state. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/tstore, version: 0"

ts=2019-03-01T04:16:03.480905Z module=Default pid=20890 caller=meta.go:502 level=error msg="Error reading cluster state. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/kstore, version: 0"

ts=2019-03-01T04:16:03.480948Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info nodeuuid=dnode-0 msg="Datanode RPC server is listening on: 127.0.0.1:7400"

ts=2019-03-01T04:16:03.480983Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:03.48114Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:03.48117Z module=Default pid=20890 caller=watcher.go:128 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/tstore, version: 0"

ts=2019-03-01T04:16:03.481392Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.481431Z module=Default pid=20890 caller=watcher.go:141 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/kstore, version: 0"

ts=2019-03-01T04:16:03.481464Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.481721Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7401, TLS: false"

ts=2019-03-01T04:16:03.481817Z module=Default pid=20890 caller=watcher.go:128 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/tstore, version: 0"

ts=2019-03-01T04:16:03.481878Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.481904Z module=Default pid=20890 caller=watcher.go:141 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/kstore, version: 0"

ts=2019-03-01T04:16:03.481938Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.482425Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:16:03.482462Z module=Default pid=20890 caller=meta.go:502 level=error msg="Error reading cluster state. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/tstore, version: 0"

ts=2019-03-01T04:16:03.482483Z module=Default pid=20890 caller=meta.go:502 level=error msg="Error reading cluster state. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/kstore, version: 0"

ts=2019-03-01T04:16:03.482512Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:16:03.482532Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:03.482604Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:03.482631Z module=Default pid=20890 caller=watcher.go:128 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/tstore, version: 0"

ts=2019-03-01T04:16:03.482693Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.482713Z module=Default pid=20890 caller=watcher.go:141 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/kstore, version: 0"

ts=2019-03-01T04:16:03.482743Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.483214Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7402, TLS: false"

ts=2019-03-01T04:16:03.483307Z module=Default pid=20890 caller=watcher.go:128 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/tstore, version: 0"

ts=2019-03-01T04:16:03.483357Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.483375Z module=Default pid=20890 caller=watcher.go:141 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/kstore, version: 0"

ts=2019-03-01T04:16:03.483396Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.483515Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Elected Leader:dnode-0}"

ts=2019-03-01T04:16:03.483538Z module=Default pid=20890 caller=node.go:213 level=info msg="dnode-0 is becoming leader"

ts=2019-03-01T04:16:03.483724Z module=Default pid=20890 caller=metamgr.go:364 level=info msg="Creating cluster tstore with nodes: map[]"

ts=2019-03-01T04:16:03.483858Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info nodeuuid=dnode-2 msg="created query aggregator with db /tmp/citadel/qstore/2"

ts=2019-03-01T04:16:03.484314Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="tstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc00023ca80 0xc00023cb60]}"

ts=2019-03-01T04:16:03.484345Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:03.484429Z module=Default pid=20890 caller=meta.go:502 level=error msg="Error reading cluster state. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/kstore, version: 0"

ts=2019-03-01T04:16:03.484513Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info nodeuuid=dnode-2 msg="Datanode RPC server is listening on: 127.0.0.1:7402"

ts=2019-03-01T04:16:03.484539Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7402"

ts=2019-03-01T04:16:03.484592Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402} at Path /venice/citadel/nodes/dnode-2"

ts=2019-03-01T04:16:03.484871Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:03.485189Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:2 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00029df40 NodeMap:map[dnode-0:0xc00033fe00] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.485328Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7403, TLS: false"

ts=2019-03-01T04:16:03.485698Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-2 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:03.485695Z module=Default pid=20890 caller=metamgr.go:364 level=info msg="Creating cluster kstore with nodes: map[]"

ts=2019-03-01T04:16:03.485704Z module=Default pid=20890 caller=watcher.go:141 level=info msg="Cluster key not found. Err: KVError: Key not found, key: /venice/citadel/meta/cluster/kstore, version: 0"

ts=2019-03-01T04:16:03.485805Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:<nil> NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.485967Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:3 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000285600 NodeMap:map[dnode-0:0xc0002879e0 dnode-1:0xc000287a40] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.486158Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info nodeuuid=dnode-3 msg="created query aggregator with db /tmp/citadel/qstore/3"

ts=2019-03-01T04:16:03.486396Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="kstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc0003c9180 0xc0003c9260 0xc0003c9340]}"

ts=2019-03-01T04:16:03.486425Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:03.486472Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000406540 NodeMap:map[] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.486909Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:03.487097Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info nodeuuid=dnode-3 msg="Datanode RPC server is listening on: 127.0.0.1:7403"

ts=2019-03-01T04:16:03.487142Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:03.487165Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:03.487282Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:16:03.487633Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:03.487896Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:3 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000370c40 NodeMap:map[dnode-0:0xc0004ac600 dnode-1:0xc0004ac660] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.487965Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:03.488005Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7404, TLS: false"

ts=2019-03-01T04:16:03.488547Z module=Default pid=20890 caller=node.go:272 level=info msg="dnode-0 leader started watching node events"

ts=2019-03-01T04:16:03.488606Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:03.488617Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:4 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000406f00 NodeMap:map[dnode-0:0xc00046fce0 dnode-1:0xc00046fd40 dnode-2:0xc00046fda0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.488625Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:03.488685Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info nodeuuid=dnode-4 msg="created query aggregator with db /tmp/citadel/qstore/4"

ts=2019-03-01T04:16:03.488977Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:3 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00023ec80 NodeMap:map[dnode-0:0xc0002c1da0 dnode-1:0xc0002c1e00] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.489124Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info nodeuuid=dnode-4 msg="Datanode RPC server is listening on: 127.0.0.1:7404"

ts=2019-03-01T04:16:03.489188Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7404"

ts=2019-03-01T04:16:03.489239Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} at Path /venice/citadel/nodes/dnode-4"

ts=2019-03-01T04:16:03.489732Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:03.489829Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:4 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000407ac0 NodeMap:map[dnode-2:0xc000519e00 dnode-0:0xc000519d40 dnode-1:0xc000519da0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.490075Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:4 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00023f240 NodeMap:map[dnode-0:0xc00050af00 dnode-1:0xc00050af60] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.490149Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:03.491616Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:03.491656Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:03.491698Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:5 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0005067c0 NodeMap:map[dnode-1:0xc0000a8720 dnode-2:0xc0000a8780 dnode-0:0xc0000a86c0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:03.492215Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:03.492849Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:03.49287Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:03.493488Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:03.494102Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:03.494122Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:03.494829Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:03.495543Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:03.495563Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:03.496354Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:03.597365Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 1 on node dnode-4"

ts=2019-03-01T04:16:03.598409Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:03.598941Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:03.599346Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-4 msg="dnode-4 Received CreateShard req ClusterType:\"tstore\" ReplicaID:1 ShardID:1 "

ts=2019-03-01T04:16:03.601502Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 1 on node dnode-4 as primary for shard 1"

ts=2019-03-01T04:16:03.601776Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:1 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:03.601832Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:1 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:03.601845Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.60343Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 1 on node dnode-0"

ts=2019-03-01T04:16:03.604364Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:03.604711Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:03.60498Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"kstore\" ReplicaID:1 ShardID:1 "

ts=2019-03-01T04:16:03.605417Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 2 on node dnode-0"

ts=2019-03-01T04:16:03.605728Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 1 on node dnode-0 as primary for shard 1"

ts=2019-03-01T04:16:03.605961Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:1 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.606015Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:1 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.606047Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.606444Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:03.60679Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:03.607026Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"tstore\" ReplicaID:2 ShardID:2 "

ts=2019-03-01T04:16:03.607735Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 2 on node dnode-0 as primary for shard 2"

ts=2019-03-01T04:16:03.607958Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:2 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.608Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:2 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.608016Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.608866Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 2 on node dnode-1"

ts=2019-03-01T04:16:03.61097Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 3 on node dnode-1"

ts=2019-03-01T04:16:03.611946Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:03.612275Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:03.612573Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"kstore\" ReplicaID:2 ShardID:2 "

ts=2019-03-01T04:16:03.61325Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:03.613266Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 2 on node dnode-1 as primary for shard 2"

ts=2019-03-01T04:16:03.613522Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:03.613638Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:2 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:03.613668Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:2 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:03.613681Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.613782Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"tstore\" ReplicaID:3 ShardID:3 "

ts=2019-03-01T04:16:03.614493Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 3 on node dnode-1 as primary for shard 3"

ts=2019-03-01T04:16:03.614763Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:3 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:03.614817Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:3 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:03.614836Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.618133Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 3 on node dnode-2"

ts=2019-03-01T04:16:03.61919Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 4 on node dnode-2"

ts=2019-03-01T04:16:03.620124Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:03.620475Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:03.620737Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"kstore\" ReplicaID:3 ShardID:3 "

ts=2019-03-01T04:16:03.621331Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:03.621473Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 3 on node dnode-2 as primary for shard 3"

ts=2019-03-01T04:16:03.62158Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:03.621708Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:03.62175Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:03.621767Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.621805Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"tstore\" ReplicaID:4 ShardID:4 "

ts=2019-03-01T04:16:03.622621Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 4 on node dnode-2 as primary for shard 4"

ts=2019-03-01T04:16:03.622846Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:03.622887Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:03.622909Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.624153Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 4 on node dnode-3"

ts=2019-03-01T04:16:03.626158Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 5 on node dnode-3"

ts=2019-03-01T04:16:03.627237Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:03.627546Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:03.627832Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:4 ShardID:4 "

ts=2019-03-01T04:16:03.628522Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 4 on node dnode-3 as primary for shard 4"

ts=2019-03-01T04:16:03.628598Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:03.62887Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:4 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.628881Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:03.628989Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:4 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.629013Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-3 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.629175Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:5 ShardID:5 "

ts=2019-03-01T04:16:03.629916Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 5 on node dnode-3 as primary for shard 5"

ts=2019-03-01T04:16:03.630167Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.63023Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.630245Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-3 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.632742Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 5 on node dnode-4"

ts=2019-03-01T04:16:03.634897Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:03.635232Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:03.635449Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-4 msg="dnode-4 Received CreateShard req ClusterType:\"kstore\" ReplicaID:5 ShardID:5 "

ts=2019-03-01T04:16:03.636069Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 5 on node dnode-4 as primary for shard 5"

ts=2019-03-01T04:16:03.636293Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:03.636319Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:03.636332Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.64466Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 1 on node dnode-0"

ts=2019-03-01T04:16:03.646056Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"tstore\" ReplicaID:6 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:03.646737Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 1 on node dnode-4 to secondary 6 on node dnode-0"

ts=2019-03-01T04:16:03.647006Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:1 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.647447Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:03.648118Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:03.648458Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:1 DestReplicaID:6 ShardID:1 ChunkMeta:\"\\010\\000\\020\\001\\030\\204\\272\\235\\234\\357\\230\\237\\371A8\\000@\\000H\\000\" "

ts=2019-03-01T04:16:03.649406Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:03.649454Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 1 on node dnode-2"

ts=2019-03-01T04:16:03.65094Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"kstore\" ReplicaID:6 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.651474Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 1 on node dnode-0 to secondary 6 on node dnode-2"

ts=2019-03-01T04:16:03.651675Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:1 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:03.651744Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:03.65212Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:03.652176Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 2 on node dnode-4"

ts=2019-03-01T04:16:03.652388Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:1 DestReplicaID:6 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:03.652678Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:03.652704Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 1 chunk 1 len: 16384"

ts=2019-03-01T04:16:03.652935Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info nodeuuid=dnode-2 msg="dnode-2 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:16:03.654794Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 2 on node dnode-0"

ts=2019-03-01T04:16:03.656045Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-4 msg="dnode-4 Received CreateShard req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.656805Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 2 on node dnode-0 to secondary 7 on node dnode-4"

ts=2019-03-01T04:16:03.657047Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:2 DestReplicaID:7 ShardID:2 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.65714Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:03.657504Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:03.657617Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"kstore\" ReplicaID:7 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:03.657765Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:2 DestReplicaID:7 ShardID:2 ChunkMeta:\"\\010\\000\\020\\001\\030\\247\\214\\245\\257\\371\\325\\326\\222h8\\000@\\000H\\000\" "

ts=2019-03-01T04:16:03.658214Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 2 on node dnode-1 to secondary 7 on node dnode-0"

ts=2019-03-01T04:16:03.658494Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:2 DestReplicaID:7 ShardID:2 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.658583Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:03.658616Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:03.658935Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:03.659143Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:2 DestReplicaID:7 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:03.659417Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:03.659428Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-1 msg="Syncing data from replica 2 chunk 2 len: 16384"

ts=2019-03-01T04:16:03.659605Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:03.662007Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 3 on node dnode-1"

ts=2019-03-01T04:16:03.663169Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 3 on node dnode-2"

ts=2019-03-01T04:16:03.664511Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"kstore\" ReplicaID:8 ShardID:3 Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:03.665095Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 3 on node dnode-2 to secondary 8 on node dnode-1"

ts=2019-03-01T04:16:03.6654Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:8 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:03.665469Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:03.665863Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:03.665962Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"tstore\" ReplicaID:8 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:03.666099Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 Chunks:<ChunkID:3 Database:\"default\" > "

ts=2019-03-01T04:16:03.666662Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-2 msg="Syncing data from replica 3 chunk 3 len: 16384"

ts=2019-03-01T04:16:03.666398Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:03.66729Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 3 on node dnode-1 to secondary 8 on node dnode-2"

ts=2019-03-01T04:16:03.667311Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 3 on shard 3"

ts=2019-03-01T04:16:03.667754Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:03.667842Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:03.668286Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:03.668554Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 ChunkMeta:\"\\010\\000\\020\\001\\030\\266\\362\\305\\322\\253\\364\\277\\266\\0338\\000@\\000H\\000\" "

ts=2019-03-01T04:16:03.669307Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:03.671357Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 4 on node dnode-1"

ts=2019-03-01T04:16:03.672516Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 4 on node dnode-4"

ts=2019-03-01T04:16:03.673957Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"tstore\" ReplicaID:9 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:03.674553Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 4 on node dnode-2 to secondary 9 on node dnode-1"

ts=2019-03-01T04:16:03.674818Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:03.674894Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:03.6752Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:03.675418Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 ChunkMeta:\"\\010\\000\\020\\001\\030\\324\\343\\221\\236\\230\\376\\327\\33408\\000@\\000H\\000\" "

ts=2019-03-01T04:16:03.675535Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-4 msg="dnode-4 Received CreateShard req ClusterType:\"kstore\" ReplicaID:9 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.67611Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 4 on node dnode-3 to secondary 9 on node dnode-4"

ts=2019-03-01T04:16:03.676225Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:03.676339Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:03.676411Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:03.676758Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:03.676976Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:03.677236Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:03.677321Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-3 msg="Syncing data from replica 4 chunk 4 len: 16384"

ts=2019-03-01T04:16:03.677548Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info nodeuuid=dnode-4 msg="dnode-4 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:03.679914Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 5 on node dnode-3"

ts=2019-03-01T04:16:03.681145Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 5 on node dnode-0"

ts=2019-03-01T04:16:03.682654Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:10 ShardID:5 Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:03.683164Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 5 on node dnode-4 to secondary 10 on node dnode-3"

ts=2019-03-01T04:16:03.683392Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.683453Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:03.683766Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:03.684002Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:10 ShardID:5 Chunks:<ChunkID:5 Database:\"default\" > "

ts=2019-03-01T04:16:03.684322Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-4 msg="Syncing data from replica 5 chunk 5 len: 16384"

ts=2019-03-01T04:16:03.684303Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:03.684461Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"tstore\" ReplicaID:10 ShardID:5 Replicas:<ClusterType:\"tstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.6845Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 5 on shard 5"

ts=2019-03-01T04:16:03.685264Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 5 on node dnode-3 to secondary 10 on node dnode-0"

ts=2019-03-01T04:16:03.685588Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:5 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.68566Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:03.686035Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:03.686257Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:5 DestReplicaID:10 ShardID:5 ChunkMeta:\"\\010\\000\\020\\001\\030\\213\\332\\316\\345\\207\\253\\210\\333(8\\000@\\000H\\000\" "

ts=2019-03-01T04:16:03.687103Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:03.690969Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 2/2 from node dnode-0 to dnode-3"

ts=2019-03-01T04:16:03.692684Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:11 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:03.693595Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 2 on node dnode-0 to secondary 11 on node dnode-3"

ts=2019-03-01T04:16:03.693878Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:2 DestReplicaID:11 ShardID:2 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:03.693985Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:03.694521Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:03.694855Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:2 DestReplicaID:11 ShardID:2 ChunkMeta:\"\\010\\000\\020\\001\\030\\247\\214\\245\\257\\371\\325\\326\\222h8\\000@\\000H\\000\" "

ts=2019-03-01T04:16:03.695753Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:03.698231Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 7 on node dnode-4 as primary for shard 2"

ts=2019-03-01T04:16:03.698493Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.698527Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.698541Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.698696Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="tstore Sending replica &{ReplicaID:2 ShardID:2 NodeUUID:dnode-0 IsPrimary:false State:Unreachable shard:0xc00003a600} to node dnode-0"

ts=2019-03-01T04:16:03.698917Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:2 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.69895Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:2 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.698967Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:03.699077Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="tstore Sending replica &{ReplicaID:11 ShardID:2 NodeUUID:dnode-3 IsPrimary:false State:Ready shard:0xc00003a600} to node dnode-3"

ts=2019-03-01T04:16:03.699256Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:11 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.699304Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:11 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.699324Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:03.713053Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-0 msg="dnode-0 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:2 ShardID:2 "

ts=2019-03-01T04:16:03.713083Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:03.713942Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.713978Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.713996Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:03.714303Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:11 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.714331Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:11 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:03.714343Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:04.391459Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:05.395973Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:05.396571Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:05.397162Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-4 msg="dnode-4 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:1 ShardID:1 Database:\"default\" "

ts=2019-03-01T04:16:05.399672Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-4."

ts=2019-03-01T04:16:05.399819Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:05.400297Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:05.400604Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:6 ShardID:1 Database:\"default\" "

ts=2019-03-01T04:16:05.40152Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-0."

ts=2019-03-01T04:16:05.401643Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:05.402041Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:05.402289Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-3 msg="dnode-3 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:11 ShardID:2 Database:\"default\" "

ts=2019-03-01T04:16:05.403089Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-3."

ts=2019-03-01T04:16:05.403325Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-4 msg="dnode-4 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 Database:\"default\" "

ts=2019-03-01T04:16:05.404069Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-4."

ts=2019-03-01T04:16:05.404189Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:05.404562Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:05.404873Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-1 msg="dnode-1 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:3 ShardID:3 Database:\"default\" "

ts=2019-03-01T04:16:05.405633Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-1."

ts=2019-03-01T04:16:05.40574Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:05.40607Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:05.406328Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-2 msg="dnode-2 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:8 ShardID:3 Database:\"default\" "

ts=2019-03-01T04:16:05.407051Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-2."

ts=2019-03-01T04:16:05.407261Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-1 msg="dnode-1 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:9 ShardID:4 Database:\"default\" "

ts=2019-03-01T04:16:05.40786Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-1."

ts=2019-03-01T04:16:05.408039Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-2 msg="dnode-2 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:4 ShardID:4 Database:\"default\" "

ts=2019-03-01T04:16:05.408616Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-2."

ts=2019-03-01T04:16:05.408804Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:10 ShardID:5 Database:\"default\" "

ts=2019-03-01T04:16:05.409411Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-0."

ts=2019-03-01T04:16:05.409574Z module=citadel-integ-test pid=20890 caller=ts_data.go:36 level=info nodeuuid=dnode-3 msg="dnode-3 Received CreateDatabase req ClusterType:\"tstore\" ReplicaID:5 ShardID:5 Database:\"default\" "

ts=2019-03-01T04:16:05.4102Z module=citadel-integ-test pid=20890 caller=broker_ts.go:50 level=info brokeruuid=broker-0 msg="=>created the database on node dnode-3."

ts=2019-03-01T04:16:05.410331Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreNodeRestartLeaderQuick starting =========================="

ts=2019-03-01T04:16:05.410478Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreNodeRestartLeaderQuick completed =========================="

ts=2019-03-01T04:16:05.410561Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreNodeRestartLeaderSlow starting =========================="

ts=2019-03-01T04:16:05.410682Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreNodeRestartLeaderSlow completed =========================="

ts=2019-03-01T04:16:05.410798Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreNodeRestartQuick starting =========================="

ts=2019-03-01T04:16:05.410876Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case NodeRestartQuickTest ###################"

ts=2019-03-01T04:16:06.316932Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:06.316993Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### NodeRestartQuickTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:16:06.317015Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartQuickTest/0 WriteKvs"

ts=2019-03-01T04:16:06.317038Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 0/WriteKvs, iter 0, action 0/WriteKvPattern"

ts=2019-03-01T04:16:06.331227Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:06.331752Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:06.335171Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:06.33556Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:06.338827Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:06.339104Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:06.356687Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:06.357109Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:06.378945Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:06.379312Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:06.515998Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartQuickTest/1 NodeRestatQuick"

ts=2019-03-01T04:16:06.516042Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 0, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:16:06.516069Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-1"

ts=2019-03-01T04:16:06.516116Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-1 Stopping election loop"

ts=2019-03-01T04:16:06.516138Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-1 Leader election is stopped"

ts=2019-03-01T04:16:06.516165Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-1 at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:06.516257Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:06.516305Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:06.516345Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:06.516339Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}."

ts=2019-03-01T04:16:06.516431Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:44 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-3:0xc0005ce720 dnode-4:0xc000429860 dnode-0:0xc0000a89c0 dnode-1:0xc0000a9260 dnode-2:0xc0002c1560] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:06.51644Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:06.516457Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:06.516529Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:06.518002Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7401, TLS: false"

ts=2019-03-01T04:16:06.51853Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 8 on node dnode-2 as primary for shard 3"

ts=2019-03-01T04:16:06.518857Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:3 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:06.518889Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:16:06.518902Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:3 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:06.518934Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:06.519181Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:45 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0016bca80 NodeMap:map[dnode-0:0xc000360120 dnode-1:0xc000360180 dnode-2:0xc0003601e0 dnode-3:0xc000360240 dnode-4:0xc0003602a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:06.519502Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:39 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000507c40 NodeMap:map[dnode-1:0xc000287aa0 dnode-2:0xc000287b00 dnode-3:0xc000287b60 dnode-4:0xc000287bc0 dnode-0:0xc000287a40] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:06.519527Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored tstore replica 3 shard 3"

ts=2019-03-01T04:16:06.519702Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored tstore replica 9 shard 4"

ts=2019-03-01T04:16:06.521458Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored kstore replica 2 shard 2"

ts=2019-03-01T04:16:06.521573Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored kstore replica 8 shard 3"

ts=2019-03-01T04:16:06.521612Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:16:06.521647Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 0, action 1/Sleep"

ts=2019-03-01T04:16:06.521647Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:06.521754Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:06.522969Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:39 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-0:0xc000454480 dnode-1:0xc000454d80 dnode-2:0xc000423020 dnode-3:0xc0005cff80 dnode-4:0xc0005014a0] mclient:0xc000432000}"

ts=2019-03-01T04:16:06.522994Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:06.52301Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 7 on node dnode-0 as primary for shard 2"

ts=2019-03-01T04:16:06.523201Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:06.523236Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:06.523249Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:06.523409Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:47 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00143eb80 NodeMap:map[dnode-0:0xc00046f6e0 dnode-1:0xc00046f740 dnode-2:0xc00046f7a0 dnode-3:0xc00046f800 dnode-4:0xc00046f860] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:06.523541Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:39 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00143ef00 NodeMap:map[dnode-0:0xc00046fda0 dnode-1:0xc00046fe00 dnode-2:0xc00046fe60 dnode-3:0xc00046fec0 dnode-4:0xc00046ff20] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:06.526121Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-1:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:06.528322Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:06.528333Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:06.528348Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:06.529914Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 8 on node dnode-2 to secondary 3 on node dnode-1"

ts=2019-03-01T04:16:06.530196Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:3 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:3 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:06.530278Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:06.530577Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:06.530812Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:3 ShardID:3 ChunkMeta:\"\\010\\000\\020\\004\\030\\266\\362\\305\\322\\253\\364\\277\\266\\033*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:06.531566Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:06.532005Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 4 on node dnode-2 to secondary 9 on node dnode-1"

ts=2019-03-01T04:16:06.532174Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:06.532251Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:06.532532Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:06.532755Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 ChunkMeta:\"\\010\\000\\020\\002\\030\\324\\343\\221\\236\\230\\376\\327\\3340*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:06.533447Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:06.53547Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:06.537007Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 7 on node dnode-0 to secondary 2 on node dnode-1"

ts=2019-03-01T04:16:06.537228Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:2 ShardID:2 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:06.537287Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:06.537564Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:06.537765Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:2 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:06.538041Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:06.538057Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 7 chunk 2 len: 24576"

ts=2019-03-01T04:16:06.538321Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:06.539238Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 3 on node dnode-2 to secondary 8 on node dnode-1"

ts=2019-03-01T04:16:06.539409Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:8 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:06.539465Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:06.539742Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:06.539937Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 Chunks:<ChunkID:3 Database:\"default\" > "

ts=2019-03-01T04:16:06.540175Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:06.540282Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-2 msg="Syncing data from replica 3 chunk 3 len: 24576"

ts=2019-03-01T04:16:06.540609Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 3 on shard 3"

ts=2019-03-01T04:16:07.523051Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 0, action 2/VerifyConverged"

ts=2019-03-01T04:16:08.433065Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:08.433133Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 1, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:16:08.433163Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-1"

ts=2019-03-01T04:16:08.433229Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-1 Stopping election loop"

ts=2019-03-01T04:16:08.433282Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-1 Leader election is stopped"

ts=2019-03-01T04:16:08.433334Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-1 at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:08.433452Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:08.433508Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:08.433506Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}."

ts=2019-03-01T04:16:08.433562Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:08.433637Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:51 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-2:0xc0002c1560 dnode-3:0xc0005ce720 dnode-4:0xc000429860 dnode-0:0xc0000a89c0 dnode-1:0xc0000a9260] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:08.433679Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:08.433866Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:08.434104Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:08.435903Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7401, TLS: false"

ts=2019-03-01T04:16:08.437037Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:16:08.437822Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:52 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0043bda40 NodeMap:map[dnode-0:0xc0043faea0 dnode-1:0xc0043faf00 dnode-2:0xc0043faf60 dnode-3:0xc0043fafc0 dnode-4:0xc0043fb020] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:08.43825Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored tstore replica 3 shard 3"

ts=2019-03-01T04:16:08.438489Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored tstore replica 9 shard 4"

ts=2019-03-01T04:16:08.440415Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:46 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0043d9f40 NodeMap:map[dnode-4:0xc004457380 dnode-0:0xc004457200 dnode-1:0xc004457260 dnode-2:0xc0044572c0 dnode-3:0xc004457320] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:08.440721Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored kstore replica 2 shard 2"

ts=2019-03-01T04:16:08.440862Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored kstore replica 8 shard 3"

ts=2019-03-01T04:16:08.440902Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:16:08.440973Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 1, action 1/Sleep"

ts=2019-03-01T04:16:08.440944Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:08.441055Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:08.442633Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:46 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-2:0xc000423020 dnode-3:0xc0005cff80 dnode-4:0xc0005014a0 dnode-0:0xc000454480 dnode-1:0xc000454d80] mclient:0xc000432000}"

ts=2019-03-01T04:16:08.442659Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:08.44324Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:54 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0042dd6c0 NodeMap:map[dnode-0:0xc0042e2840 dnode-1:0xc0042e28a0 dnode-2:0xc0042e2900 dnode-3:0xc0042e2960 dnode-4:0xc0042e29c0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:08.444258Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-1:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:08.445509Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:47 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004509c80 NodeMap:map[dnode-3:0xc00453d380 dnode-4:0xc00453d3e0 dnode-0:0xc00453d260 dnode-1:0xc00453d2c0 dnode-2:0xc00453d320] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:08.448857Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:08.448895Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:08.450727Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 8 on node dnode-2 to secondary 3 on node dnode-1"

ts=2019-03-01T04:16:08.45075Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:08.451048Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:3 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:3 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:08.451133Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:08.451438Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:08.45168Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:3 ShardID:3 ChunkMeta:\"\\010\\000\\020\\004\\030\\266\\362\\305\\322\\253\\364\\277\\266\\033*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:08.452495Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:08.452978Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 4 on node dnode-2 to secondary 9 on node dnode-1"

ts=2019-03-01T04:16:08.453181Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:08.453281Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:08.45356Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:08.453799Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 ChunkMeta:\"\\010\\000\\020\\002\\030\\324\\343\\221\\236\\230\\376\\327\\3340*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:08.454514Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:08.456847Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:08.458631Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 7 on node dnode-0 to secondary 2 on node dnode-1"

ts=2019-03-01T04:16:08.458874Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:2 ShardID:2 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:08.458936Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:08.459284Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:08.459475Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:2 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:08.459703Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:08.459756Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 7 chunk 2 len: 24576"

ts=2019-03-01T04:16:08.460006Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:08.460877Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 3 on node dnode-2 to secondary 8 on node dnode-1"

ts=2019-03-01T04:16:08.461075Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:8 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:08.461135Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:08.461418Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:08.461645Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 Chunks:<ChunkID:3 Database:\"default\" > "

ts=2019-03-01T04:16:08.461894Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:08.461958Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-2 msg="Syncing data from replica 3 chunk 3 len: 24576"

ts=2019-03-01T04:16:08.462227Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 3 on shard 3"

ts=2019-03-01T04:16:09.442804Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 1, action 2/VerifyConverged"

ts=2019-03-01T04:16:10.351204Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:10.351273Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 2, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:16:10.351314Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-1"

ts=2019-03-01T04:16:10.351389Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-1 Stopping election loop"

ts=2019-03-01T04:16:10.351424Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-1 Leader election is stopped"

ts=2019-03-01T04:16:10.351452Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-1 at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:10.351574Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:10.351625Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:10.35167Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:10.351708Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}."

ts=2019-03-01T04:16:10.351846Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:58 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-0:0xc0000a89c0 dnode-1:0xc0000a9260 dnode-2:0xc0002c1560 dnode-3:0xc0005ce720 dnode-4:0xc000429860] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:10.351916Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:10.35196Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:10.352197Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:10.353902Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7401, TLS: false"

ts=2019-03-01T04:16:10.355077Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:16:10.355925Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:59 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004b38100 NodeMap:map[dnode-4:0xc004b3a360 dnode-0:0xc004b3a1e0 dnode-1:0xc004b3a240 dnode-2:0xc004b3a2a0 dnode-3:0xc004b3a300] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:10.356332Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored tstore replica 3 shard 3"

ts=2019-03-01T04:16:10.356577Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored tstore replica 9 shard 4"

ts=2019-03-01T04:16:10.358537Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:53 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004adfb40 NodeMap:map[dnode-3:0xc004b8a360 dnode-4:0xc004b8a3c0 dnode-0:0xc004b8a240 dnode-1:0xc004b8a2a0 dnode-2:0xc004b8a300] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:10.358865Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored kstore replica 2 shard 2"

ts=2019-03-01T04:16:10.359005Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Restored kstore replica 8 shard 3"

ts=2019-03-01T04:16:10.359045Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:16:10.359079Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 2, action 1/Sleep"

ts=2019-03-01T04:16:10.359082Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:10.359135Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:10.359764Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-1:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:10.360859Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:53 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-0:0xc000454480 dnode-1:0xc000454d80 dnode-2:0xc000423020 dnode-3:0xc0005cff80 dnode-4:0xc0005014a0] mclient:0xc000432000}"

ts=2019-03-01T04:16:10.360896Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:10.362286Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:61 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004bbcf80 NodeMap:map[dnode-0:0xc004bc9020 dnode-1:0xc004bfd260 dnode-2:0xc004bfd2c0 dnode-3:0xc004bfd320 dnode-4:0xc004aa4120] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:10.36431Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:54 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0017355c0 NodeMap:map[dnode-4:0xc00280c240 dnode-0:0xc00280c0c0 dnode-1:0xc00280c120 dnode-2:0xc00280c180 dnode-3:0xc00280c1e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:10.367553Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:10.367591Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:10.367595Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:10.369096Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 8 on node dnode-2 to secondary 3 on node dnode-1"

ts=2019-03-01T04:16:10.369373Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:3 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:3 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:10.369455Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:10.369742Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:10.369988Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:3 ShardID:3 ChunkMeta:\"\\010\\000\\020\\004\\030\\266\\362\\305\\322\\253\\364\\277\\266\\033*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:10.370724Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:10.371208Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 4 on node dnode-2 to secondary 9 on node dnode-1"

ts=2019-03-01T04:16:10.371442Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:10.371562Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:10.371821Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:10.372025Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 ChunkMeta:\"\\010\\000\\020\\002\\030\\324\\343\\221\\236\\230\\376\\327\\3340*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:10.372762Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:10.374932Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:10.37645Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 7 on node dnode-0 to secondary 2 on node dnode-1"

ts=2019-03-01T04:16:10.376648Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:2 ShardID:2 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:10.376699Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:10.376957Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:10.377183Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:2 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:10.377454Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:10.377486Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 7 chunk 2 len: 24576"

ts=2019-03-01T04:16:10.377631Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:10.378853Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 3 on node dnode-2 to secondary 8 on node dnode-1"

ts=2019-03-01T04:16:10.379086Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:8 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:10.379179Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:10.379532Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:10.379772Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:8 ShardID:3 Chunks:<ChunkID:3 Database:\"default\" > "

ts=2019-03-01T04:16:10.380079Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-2 msg="Syncing data from replica 3 chunk 3 len: 24576"

ts=2019-03-01T04:16:10.380059Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:10.380247Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 3 on shard 3"

ts=2019-03-01T04:16:11.359248Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 2, action 2/VerifyConverged"

ts=2019-03-01T04:16:12.26424Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:12.264301Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 3, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:16:12.264324Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-4"

ts=2019-03-01T04:16:12.264372Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-4 Stopping election loop"

ts=2019-03-01T04:16:12.264404Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-4 Leader election is stopped"

ts=2019-03-01T04:16:12.264443Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-4 at Path /venice/citadel/nodes/dnode-4"

ts=2019-03-01T04:16:12.264557Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:12.264605Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:12.264615Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}."

ts=2019-03-01T04:16:12.264661Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:12.264737Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:65 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-1:0xc0000a9260 dnode-2:0xc0002c1560 dnode-3:0xc0005ce720 dnode-4:0xc000429860 dnode-0:0xc0000a89c0] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:12.264785Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-4 unreachable"

ts=2019-03-01T04:16:12.264793Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:12.264818Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 6 on node dnode-0 as primary for shard 1"

ts=2019-03-01T04:16:12.264908Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7404"

ts=2019-03-01T04:16:12.265381Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:12.265466Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:12.265511Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:12.266904Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7404, TLS: false"

ts=2019-03-01T04:16:12.268391Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 11 on node dnode-3 as primary for shard 2"

ts=2019-03-01T04:16:12.268717Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:11 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:12.268761Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:11 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:12.268781Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-3 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:12.268896Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="created query aggregator with db /tmp/citadel/qstore/4"

ts=2019-03-01T04:16:12.269257Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:66 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc001a80b00 NodeMap:map[dnode-3:0xc0023b8240 dnode-4:0xc0023b82a0 dnode-0:0xc0023b8120 dnode-1:0xc0023b8180 dnode-2:0xc0023b81e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:12.269685Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Restored tstore replica 1 shard 1"

ts=2019-03-01T04:16:12.269885Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Restored tstore replica 7 shard 2"

ts=2019-03-01T04:16:12.271709Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:60 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc002721380 NodeMap:map[dnode-1:0xc0025c3f80 dnode-2:0xc002648000 dnode-3:0xc002648060 dnode-4:0xc0026480c0 dnode-0:0xc0025c3f20] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:12.272003Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Restored kstore replica 9 shard 4"

ts=2019-03-01T04:16:12.272138Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Restored kstore replica 5 shard 5"

ts=2019-03-01T04:16:12.272189Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Datanode RPC server is listening on: 127.0.0.1:7404"

ts=2019-03-01T04:16:12.272221Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7404"

ts=2019-03-01T04:16:12.272242Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 3, action 1/Sleep"

ts=2019-03-01T04:16:12.272306Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} at Path /venice/citadel/nodes/dnode-4"

ts=2019-03-01T04:16:12.273804Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:60 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-0:0xc000454480 dnode-1:0xc000454d80 dnode-2:0xc000423020 dnode-3:0xc0005cff80 dnode-4:0xc0005014a0] mclient:0xc000432000}"

ts=2019-03-01T04:16:12.273836Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-4 unreachable"

ts=2019-03-01T04:16:12.273856Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 10 on node dnode-3 as primary for shard 5"

ts=2019-03-01T04:16:12.274118Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:10 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:12.274156Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:10 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:12.274172Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-3 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:12.274487Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:68 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc001363fc0 NodeMap:map[dnode-2:0xc0042e2300 dnode-3:0xc0042e2360 dnode-4:0xc0042e2420 dnode-0:0xc0042e2240 dnode-1:0xc0042e22a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:12.275415Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-4:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:12.276589Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:61 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0044606c0 NodeMap:map[dnode-0:0xc0043fb020 dnode-1:0xc0043fb080 dnode-2:0xc0043fb0e0 dnode-3:0xc0043fb140 dnode-4:0xc0043fb1a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:12.279749Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:12.27978Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:12.281284Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 6 on node dnode-0 to secondary 1 on node dnode-4"

ts=2019-03-01T04:16:12.281417Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:12.2815Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:1 ShardID:1 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:12.281576Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:12.281932Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:12.282134Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:1 ShardID:1 ChunkMeta:\"\\010\\000\\020\\004\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:12.282859Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:12.283289Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 11 on node dnode-3 to secondary 7 on node dnode-4"

ts=2019-03-01T04:16:12.283486Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:11 DestReplicaID:7 ShardID:2 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:12.283573Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:12.283927Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:12.284127Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:11 DestReplicaID:7 ShardID:2 ChunkMeta:\"\\010\\000\\020\\004\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:12.284746Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:12.287014Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:12.288678Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 10 on node dnode-3 to secondary 5 on node dnode-4"

ts=2019-03-01T04:16:12.288859Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:10 DestReplicaID:5 ShardID:5 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:12.288915Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:12.289191Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:12.289416Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:10 DestReplicaID:5 ShardID:5 Chunks:<ChunkID:5 Database:\"default\" > "

ts=2019-03-01T04:16:12.289654Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-3 msg="Syncing data from replica 10 chunk 5 len: 24576"

ts=2019-03-01T04:16:12.289655Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:12.289809Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Restoring kstore Chunk 5 on shard 5"

ts=2019-03-01T04:16:12.290665Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 4 on node dnode-3 to secondary 9 on node dnode-4"

ts=2019-03-01T04:16:12.290831Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:12.290887Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:12.291167Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:12.291342Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:4 DestReplicaID:9 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:12.291551Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:12.29159Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-3 msg="Syncing data from replica 4 chunk 4 len: 24576"

ts=2019-03-01T04:16:12.291742Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:13.274011Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 3, action 2/VerifyConverged"

ts=2019-03-01T04:16:14.179706Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:14.179768Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 4, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:16:14.179792Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-3"

ts=2019-03-01T04:16:14.179846Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-3 Stopping election loop"

ts=2019-03-01T04:16:14.179878Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-3 Leader election is stopped"

ts=2019-03-01T04:16:14.179923Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-3 at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:16:14.180029Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:14.180082Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:14.180097Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}."

ts=2019-03-01T04:16:14.180132Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:14.180205Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:72 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-0:0xc0000a89c0 dnode-1:0xc0000a9260 dnode-2:0xc0002c1560 dnode-3:0xc0005ce720 dnode-4:0xc000429860] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:14.180249Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-3 unreachable"

ts=2019-03-01T04:16:14.18026Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:14.180298Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 7 on node dnode-4 as primary for shard 2"

ts=2019-03-01T04:16:14.180335Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:14.180375Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:14.18095Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:14.181486Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:14.181545Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:14.181569Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:14.182293Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7403, TLS: false"

ts=2019-03-01T04:16:14.184033Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="created query aggregator with db /tmp/citadel/qstore/3"

ts=2019-03-01T04:16:14.184363Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 10 on node dnode-0 as primary for shard 5"

ts=2019-03-01T04:16:14.184668Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:14.184713Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:14.184731Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:14.185195Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:73 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0043d0d40 NodeMap:map[dnode-4:0xc0046dad80 dnode-0:0xc0046dac00 dnode-1:0xc0046dac60 dnode-2:0xc0046dacc0 dnode-3:0xc0046dad20] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:14.187579Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:67 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00424c5c0 NodeMap:map[dnode-3:0xc004252960 dnode-4:0xc0042529c0 dnode-0:0xc004252840 dnode-1:0xc0042528a0 dnode-2:0xc004252900] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:14.187613Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="Restored tstore replica 11 shard 2"

ts=2019-03-01T04:16:14.18781Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="Restored tstore replica 5 shard 5"

ts=2019-03-01T04:16:14.189426Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:67 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-2:0xc000423020 dnode-3:0xc0005cff80 dnode-4:0xc0005014a0 dnode-0:0xc000454480 dnode-1:0xc000454d80] mclient:0xc000432000}"

ts=2019-03-01T04:16:14.189467Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-3 unreachable"

ts=2019-03-01T04:16:14.189491Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 9 on node dnode-4 as primary for shard 4"

ts=2019-03-01T04:16:14.189534Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:14.189743Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="Restored kstore replica 4 shard 4"

ts=2019-03-01T04:16:14.189881Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="Restored kstore replica 10 shard 5"

ts=2019-03-01T04:16:14.189934Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:14.189958Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="Datanode RPC server is listening on: 127.0.0.1:7403"

ts=2019-03-01T04:16:14.189989Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:14.19002Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 4, action 1/Sleep"

ts=2019-03-01T04:16:14.190144Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:16:14.190356Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:9 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:4 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:14.190406Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:9 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:4 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:14.190431Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:14.190748Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:75 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00424df80 NodeMap:map[dnode-0:0xc0045c13e0 dnode-1:0xc0045c1440 dnode-2:0xc0045c14a0 dnode-3:0xc0045c1500 dnode-4:0xc0045c1560] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:14.190814Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:14.190981Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-3:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:14.19283Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 5 on node dnode-4 as primary for shard 5"

ts=2019-03-01T04:16:14.192974Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:68 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004936840 NodeMap:map[dnode-0:0xc004963140 dnode-1:0xc0049631a0 dnode-2:0xc004963200 dnode-3:0xc004963260 dnode-4:0xc0049632c0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:14.193049Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:14.193083Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:14.193097Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:14.196784Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:14.196826Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:14.198356Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 11 on node dnode-3"

ts=2019-03-01T04:16:14.198611Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:11 ShardID:2 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:11 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:14.198711Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:14.199045Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:14.199243Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:11 ShardID:2 ChunkMeta:\"\\010\\000\\020\\006\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:14.199976Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:14.200686Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 10 on node dnode-0 to secondary 5 on node dnode-3"

ts=2019-03-01T04:16:14.20089Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:5 ShardID:5 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:14.200965Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:14.20125Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:14.201424Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:5 ShardID:5 ChunkMeta:\"\\010\\000\\020\\004\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:14.202059Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:14.204474Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:14.20611Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 9 on node dnode-4 to secondary 4 on node dnode-3"

ts=2019-03-01T04:16:14.20627Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:9 DestReplicaID:4 ShardID:4 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:4 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:14.206339Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:14.206639Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:14.206854Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:9 DestReplicaID:4 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:14.207098Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:14.207233Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 9 chunk 4 len: 24576"

ts=2019-03-01T04:16:14.207476Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:14.208194Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 5 on node dnode-4 to secondary 10 on node dnode-3"

ts=2019-03-01T04:16:14.208371Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:14.208416Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:14.208776Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:14.209002Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:10 ShardID:5 Chunks:<ChunkID:5 Database:\"default\" > "

ts=2019-03-01T04:16:14.209278Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:14.209432Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 5 chunk 5 len: 24576"

ts=2019-03-01T04:16:14.209697Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 5 on shard 5"

ts=2019-03-01T04:16:15.193322Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 1/NodeRestatQuick, iter 4, action 2/VerifyConverged"

ts=2019-03-01T04:16:16.101992Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:16.102049Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartQuickTest/2 VerifyKvs"

ts=2019-03-01T04:16:16.102073Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 2/VerifyKvs, iter 0, action 0/VerifyConverged"

ts=2019-03-01T04:16:17.00514Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:17.005204Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickTest: step 2/VerifyKvs, iter 0, action 1/VerifyKvPattern"

ts=2019-03-01T04:16:17.00865Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MC0y\",\"Value\":\"VmFsdWUwLTI=\"},{\"Key\":\"S2V5MC01\",\"Value\":\"VmFsdWUwLTU=\"},{\"Key\":\"S2V5MC02\",\"Value\":\"VmFsdWUwLTY=\"},{\"Key\":\"S2V5MC04\",\"Value\":\"VmFsdWUwLTg=\"},{\"Key\":\"S2V5MC0z\",\"Value\":\"VmFsdWUwLTM=\"},{\"Key\":\"S2V5MC0x\",\"Value\":\"VmFsdWUwLTE=\"},{\"Key\":\"S2V5MC0w\",\"Value\":\"VmFsdWUwLTA=\"},{\"Key\":\"S2V5MC00\",\"Value\":\"VmFsdWUwLTQ=\"},{\"Key\":\"S2V5MC03\",\"Value\":\"VmFsdWUwLTc=\"},{\"Key\":\"S2V5MC05\",\"Value\":\"VmFsdWUwLTk=\"}]"

ts=2019-03-01T04:16:17.010721Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MS0y\",\"Value\":\"VmFsdWUxLTI=\"},{\"Key\":\"S2V5MS02\",\"Value\":\"VmFsdWUxLTY=\"},{\"Key\":\"S2V5MS0x\",\"Value\":\"VmFsdWUxLTE=\"},{\"Key\":\"S2V5MS0w\",\"Value\":\"VmFsdWUxLTA=\"},{\"Key\":\"S2V5MS03\",\"Value\":\"VmFsdWUxLTc=\"},{\"Key\":\"S2V5MS04\",\"Value\":\"VmFsdWUxLTg=\"},{\"Key\":\"S2V5MS05\",\"Value\":\"VmFsdWUxLTk=\"},{\"Key\":\"S2V5MS0z\",\"Value\":\"VmFsdWUxLTM=\"},{\"Key\":\"S2V5MS00\",\"Value\":\"VmFsdWUxLTQ=\"},{\"Key\":\"S2V5MS01\",\"Value\":\"VmFsdWUxLTU=\"}]"

ts=2019-03-01T04:16:17.012398Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5Mi0x\",\"Value\":\"VmFsdWUyLTE=\"},{\"Key\":\"S2V5Mi0y\",\"Value\":\"VmFsdWUyLTI=\"},{\"Key\":\"S2V5Mi0z\",\"Value\":\"VmFsdWUyLTM=\"},{\"Key\":\"S2V5Mi02\",\"Value\":\"VmFsdWUyLTY=\"},{\"Key\":\"S2V5Mi00\",\"Value\":\"VmFsdWUyLTQ=\"},{\"Key\":\"S2V5Mi05\",\"Value\":\"VmFsdWUyLTk=\"},{\"Key\":\"S2V5Mi01\",\"Value\":\"VmFsdWUyLTU=\"},{\"Key\":\"S2V5Mi0w\",\"Value\":\"VmFsdWUyLTA=\"},{\"Key\":\"S2V5Mi03\",\"Value\":\"VmFsdWUyLTc=\"},{\"Key\":\"S2V5Mi04\",\"Value\":\"VmFsdWUyLTg=\"}]"

ts=2019-03-01T04:16:17.01379Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5My0y\",\"Value\":\"VmFsdWUzLTI=\"},{\"Key\":\"S2V5My01\",\"Value\":\"VmFsdWUzLTU=\"},{\"Key\":\"S2V5My0w\",\"Value\":\"VmFsdWUzLTA=\"},{\"Key\":\"S2V5My0z\",\"Value\":\"VmFsdWUzLTM=\"},{\"Key\":\"S2V5My0x\",\"Value\":\"VmFsdWUzLTE=\"},{\"Key\":\"S2V5My02\",\"Value\":\"VmFsdWUzLTY=\"},{\"Key\":\"S2V5My04\",\"Value\":\"VmFsdWUzLTg=\"},{\"Key\":\"S2V5My05\",\"Value\":\"VmFsdWUzLTk=\"},{\"Key\":\"S2V5My00\",\"Value\":\"VmFsdWUzLTQ=\"},{\"Key\":\"S2V5My03\",\"Value\":\"VmFsdWUzLTc=\"}]"

ts=2019-03-01T04:16:17.015089Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5NC0z\",\"Value\":\"VmFsdWU0LTM=\"},{\"Key\":\"S2V5NC04\",\"Value\":\"VmFsdWU0LTg=\"},{\"Key\":\"S2V5NC0x\",\"Value\":\"VmFsdWU0LTE=\"},{\"Key\":\"S2V5NC0w\",\"Value\":\"VmFsdWU0LTA=\"},{\"Key\":\"S2V5NC00\",\"Value\":\"VmFsdWU0LTQ=\"},{\"Key\":\"S2V5NC01\",\"Value\":\"VmFsdWU0LTU=\"},{\"Key\":\"S2V5NC02\",\"Value\":\"VmFsdWU0LTY=\"},{\"Key\":\"S2V5NC03\",\"Value\":\"VmFsdWU0LTc=\"},{\"Key\":\"S2V5NC05\",\"Value\":\"VmFsdWU0LTk=\"},{\"Key\":\"S2V5NC0y\",\"Value\":\"VmFsdWU0LTI=\"}]"

ts=2019-03-01T04:16:17.015284Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreNodeRestartQuick completed =========================="

ts=2019-03-01T04:16:17.015398Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreNodeRestartQuickWriteLoss starting =========================="

ts=2019-03-01T04:16:17.015601Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreNodeRestartQuickWriteLoss completed =========================="

ts=2019-03-01T04:16:17.015744Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreNodeRestartSlow starting =========================="

ts=2019-03-01T04:16:17.015836Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case NodeRestartSlowTest ###################"

ts=2019-03-01T04:16:17.923871Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:17.92393Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### NodeRestartSlowTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:16:17.923953Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartSlowTest/0 WriteKvs"

ts=2019-03-01T04:16:17.923974Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 0/WriteKvs, iter 0, action 0/WriteKvPattern"

ts=2019-03-01T04:16:17.938686Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:17.939192Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:17.941198Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:17.941545Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:18.123648Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartSlowTest/1 NodeRestatSlow"

ts=2019-03-01T04:16:18.123695Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 0, action 0/RestartSlowAnyNode"

ts=2019-03-01T04:16:18.123713Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-3"

ts=2019-03-01T04:16:18.123755Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-3 Stopping election loop"

ts=2019-03-01T04:16:18.123774Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-3 Leader election is stopped"

ts=2019-03-01T04:16:18.123793Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-3 at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:16:18.123874Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:18.123905Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:18.123932Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:18.123935Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}."

ts=2019-03-01T04:16:18.124021Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:18.124041Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:79 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-0:0xc0000a89c0 dnode-1:0xc0000a9260 dnode-2:0xc0002c1560 dnode-3:0xc0005ce720 dnode-4:0xc000429860] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:18.124082Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:18.124081Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-3 unreachable"

ts=2019-03-01T04:16:18.124589Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-3:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:18.12954Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:74 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-0:0xc000454480 dnode-1:0xc000454d80 dnode-2:0xc000423020 dnode-3:0xc0005cff80 dnode-4:0xc0005014a0] mclient:0xc000432000}"

ts=2019-03-01T04:16:18.129565Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-3 unreachable"

ts=2019-03-01T04:16:18.625957Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="tstore/dnode-0 Node dnode-3 was unreachable for 501.779ms since 2019-02-28T20:16:18.124154-08:00. Removing it"

ts=2019-03-01T04:16:18.63689Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="kstore/dnode-0 Node dnode-3 was unreachable for 507.306ms since 2019-02-28T20:16:18.129576-08:00. Removing it"

ts=2019-03-01T04:16:18.642413Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 2 on node dnode-0"

ts=2019-03-01T04:16:18.644221Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"tstore\" ReplicaID:12 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:18.645061Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 12 on node dnode-0"

ts=2019-03-01T04:16:18.645299Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:12 ShardID:2 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:12 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:18.645413Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:18.645768Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:18.646035Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:12 ShardID:2 ChunkMeta:\"\\010\\000\\020\\006\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:18.646825Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:18.648359Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 5 on node dnode-2"

ts=2019-03-01T04:16:18.649923Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"tstore\" ReplicaID:13 ShardID:5 Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:18.650671Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 10 on node dnode-0 to secondary 13 on node dnode-2"

ts=2019-03-01T04:16:18.650935Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:13 ShardID:5 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:13 ShardID:5 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:18.651019Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:18.65139Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:18.651603Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:13 ShardID:5 ChunkMeta:\"\\010\\000\\020\\004\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:18.652343Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:18.652709Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 4 on node dnode-0"

ts=2019-03-01T04:16:18.654466Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"kstore\" ReplicaID:11 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:18.655023Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 9 on node dnode-4 to secondary 11 on node dnode-0"

ts=2019-03-01T04:16:18.655225Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:9 DestReplicaID:11 ShardID:4 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:18.655301Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:18.655691Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:18.655902Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:9 DestReplicaID:11 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:18.656166Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:18.656187Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 9 chunk 4 len: 24576"

ts=2019-03-01T04:16:18.656432Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:18.659123Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 5 on node dnode-1"

ts=2019-03-01T04:16:18.660501Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:18.660886Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:18.661146Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"kstore\" ReplicaID:12 ShardID:5 Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:18.661845Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 5 on node dnode-4 to secondary 12 on node dnode-1"

ts=2019-03-01T04:16:18.662041Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:12 ShardID:5 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:12 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:18.66213Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:18.662378Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:18.662596Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:12 ShardID:5 Chunks:<ChunkID:5 Database:\"default\" > "

ts=2019-03-01T04:16:18.662848Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:18.662869Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 5 chunk 5 len: 24576"

ts=2019-03-01T04:16:18.663194Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 5 on shard 5"

ts=2019-03-01T04:16:19.625956Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7403, TLS: false"

ts=2019-03-01T04:16:19.626956Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:91 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005fb1300 NodeMap:map[dnode-1:0xc005f9b7a0 dnode-2:0xc005f9b800 dnode-4:0xc005f9b860 dnode-0:0xc005f9b740] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:19.62721Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:86 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005fb1680 NodeMap:map[dnode-0:0xc005f9b9e0 dnode-1:0xc005f9ba40 dnode-2:0xc005f9baa0 dnode-4:0xc005f9bb00] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:19.627965Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="created query aggregator with db /tmp/citadel/qstore/3"

ts=2019-03-01T04:16:19.628586Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Datanode RPC server is listening on: 127.0.0.1:7403"

ts=2019-03-01T04:16:19.628638Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 0, action 1/Sleep"

ts=2019-03-01T04:16:19.628636Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:19.628729Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:16:19.629445Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:91 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00593de40 NodeMap:map[dnode-0:0xc00595c7e0 dnode-1:0xc00595c840 dnode-2:0xc00595c8a0 dnode-4:0xc00595c900] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:19.629583Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:19.629647Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:19.629837Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:86 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0060041c0 NodeMap:map[dnode-1:0xc00595cae0 dnode-2:0xc00595cb40 dnode-4:0xc00595cba0 dnode-0:0xc00595ca80] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:19.632573Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:19.632703Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:19.635207Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 1/1 from node dnode-0 to dnode-3"

ts=2019-03-01T04:16:19.635807Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 2/12 from node dnode-0 to dnode-3"

ts=2019-03-01T04:16:19.637449Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:19.637826Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:19.638111Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:13 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:19.638765Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 1 on node dnode-0 to secondary 13 on node dnode-3"

ts=2019-03-01T04:16:19.639009Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:1 DestReplicaID:13 ShardID:1 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.639074Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:19.639503Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:19.639689Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:19.63978Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:1 DestReplicaID:13 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:19.639958Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:19.64012Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:19.64014Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 1 chunk 1 len: 24576"

ts=2019-03-01T04:16:19.640242Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:14 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:12 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:19.640452Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:16:19.641039Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 14 on node dnode-3"

ts=2019-03-01T04:16:19.641283Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:14 ShardID:2 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:12 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.641382Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:19.641654Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:19.64189Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:14 ShardID:2 ChunkMeta:\"\\010\\000\\020\\006\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:19.642575Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:19.647904Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 6 on node dnode-2 as primary for shard 1"

ts=2019-03-01T04:16:19.648206Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.648241Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.648257Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:19.64842Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="kstore Sending replica &{ReplicaID:13 ShardID:1 NodeUUID:dnode-3 IsPrimary:false State:Ready shard:0xc0003d5800} to node dnode-3"

ts=2019-03-01T04:16:19.648728Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:13 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.648769Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:13 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.648783Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.648927Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="kstore Sending replica &{ReplicaID:1 ShardID:1 NodeUUID:dnode-0 IsPrimary:false State:Unreachable shard:0xc0003d5800} to node dnode-0"

ts=2019-03-01T04:16:19.649122Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:1 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.649153Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:1 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.649166Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.667177Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-0 msg="dnode-0 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:12 ShardID:2 "

ts=2019-03-01T04:16:19.667263Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.667206Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-0 msg="dnode-0 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:1 ShardID:1 "

ts=2019-03-01T04:16:19.667316Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.667916Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 4/4 from node dnode-2 to dnode-3"

ts=2019-03-01T04:16:19.668603Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:19.66869Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:19.668675Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.66874Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:19.668828Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.66888Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:19.669425Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:14 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:19.669461Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 2/2 from node dnode-1 to dnode-3"

ts=2019-03-01T04:16:19.669551Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:14 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:19.669607Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.669611Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:13 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.669707Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:13 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:13 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.669779Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.67177Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:15 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:19.672691Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 4 on node dnode-2 to secondary 15 on node dnode-3"

ts=2019-03-01T04:16:19.673062Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:15 ShardID:4 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:19.673183Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:19.674482Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:19.675156Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:4 DestReplicaID:15 ShardID:4 ChunkMeta:\"\\010\\000\\020\\002\\030\\324\\343\\221\\236\\230\\376\\327\\3340*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:19.67582Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:14 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:19.676347Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:19.676628Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 7 on node dnode-0 to secondary 14 on node dnode-3"

ts=2019-03-01T04:16:19.676954Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:14 ShardID:2 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:2 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.677047Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:19.677411Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:19.677742Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:14 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:19.678052Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:19.678079Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 7 chunk 2 len: 24576"

ts=2019-03-01T04:16:19.678518Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:19.6839Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 9 on node dnode-1 as primary for shard 4"

ts=2019-03-01T04:16:19.683926Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:19.684224Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:19.684438Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.684482Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.684501Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:19.684628Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="tstore Sending replica &{ReplicaID:4 ShardID:4 NodeUUID:dnode-2 IsPrimary:false State:Unreachable shard:0xc00003a6c0} to node dnode-2"

ts=2019-03-01T04:16:19.684829Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:4 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.684868Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:4 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.684882Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.685004Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="tstore Sending replica &{ReplicaID:15 ShardID:4 NodeUUID:dnode-3 IsPrimary:false State:Ready shard:0xc00003a6c0} to node dnode-3"

ts=2019-03-01T04:16:19.685232Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:15 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.685314Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:15 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:4 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.685336Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.700984Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:2 ShardID:2 "

ts=2019-03-01T04:16:19.701039Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.702258Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.702316Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.70234Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:19.702814Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:14 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.702843Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-2 msg="dnode-2 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:4 ShardID:4 "

ts=2019-03-01T04:16:19.702871Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:14 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:14 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:19.70288Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.702891Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:19.703779Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:19.703825Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:19.703845Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:19.704208Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:15 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:19.704252Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:15 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:15 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:19.704271Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:20.633263Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 0, action 2/VerifyConverged"

ts=2019-03-01T04:16:21.540095Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:21.540162Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 1, action 0/RestartSlowAnyNode"

ts=2019-03-01T04:16:21.540187Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-3"

ts=2019-03-01T04:16:21.540243Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-3 Stopping election loop"

ts=2019-03-01T04:16:21.540279Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-3 Leader election is stopped"

ts=2019-03-01T04:16:21.540315Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-3 at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:16:21.540437Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:21.540489Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}."

ts=2019-03-01T04:16:21.540537Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:21.540579Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:104 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-0:0xc0000a89c0 dnode-1:0xc0000a9260 dnode-2:0xc0002c1560 dnode-3:0xc005f68600 dnode-4:0xc000429860] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:21.540625Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-3 unreachable"

ts=2019-03-01T04:16:21.540616Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:21.541133Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:21.541285Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:21.546834Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:99 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-0:0xc000454480 dnode-1:0xc000454d80 dnode-2:0xc000423020 dnode-3:0xc006056600 dnode-4:0xc0005014a0] mclient:0xc000432000}"

ts=2019-03-01T04:16:21.546863Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-3 unreachable"

ts=2019-03-01T04:16:21.552226Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-3:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:22.050793Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="kstore/dnode-0 Node dnode-3 was unreachable for 503.892ms since 2019-02-28T20:16:21.546874-08:00. Removing it"

ts=2019-03-01T04:16:22.050796Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="tstore/dnode-0 Node dnode-3 was unreachable for 510.112ms since 2019-02-28T20:16:21.540655-08:00. Removing it"

ts=2019-03-01T04:16:22.070124Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 1 on node dnode-4"

ts=2019-03-01T04:16:22.072412Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 2 on node dnode-2"

ts=2019-03-01T04:16:22.073179Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received CreateShard req ClusterType:\"kstore\" ReplicaID:15 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:22.07485Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 6 on node dnode-2 to secondary 15 on node dnode-4"

ts=2019-03-01T04:16:22.075156Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"tstore\" ReplicaID:16 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:22.075217Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:6 DestReplicaID:15 ShardID:1 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:22.07531Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:22.075766Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:22.076087Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:6 DestReplicaID:15 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:22.076187Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 16 on node dnode-2"

ts=2019-03-01T04:16:22.076514Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:16 ShardID:2 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:16 ShardID:2 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:22.076527Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-2 msg="Syncing data from replica 6 chunk 1 len: 24576"

ts=2019-03-01T04:16:22.076514Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:22.076674Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:22.076826Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:16:22.077216Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:22.077574Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:16 ShardID:2 ChunkMeta:\"\\010\\000\\020\\006\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:22.078537Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:22.081468Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 2 on node dnode-1"

ts=2019-03-01T04:16:22.082776Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 4 on node dnode-4"

ts=2019-03-01T04:16:22.084512Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"kstore\" ReplicaID:16 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:22.085082Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 7 on node dnode-0 to secondary 16 on node dnode-1"

ts=2019-03-01T04:16:22.08533Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:16 ShardID:2 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:16 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:22.08541Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:22.085818Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:22.08595Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received CreateShard req ClusterType:\"tstore\" ReplicaID:17 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:22.086074Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:16 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:22.086437Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 7 chunk 2 len: 24576"

ts=2019-03-01T04:16:22.086479Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:22.086665Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:22.086923Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 9 on node dnode-1 to secondary 17 on node dnode-4"

ts=2019-03-01T04:16:22.087141Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:9 DestReplicaID:17 ShardID:4 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:22.087227Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:22.0876Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:22.087805Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:9 DestReplicaID:17 ShardID:4 ChunkMeta:\"\\010\\000\\020\\004\\030\\324\\343\\221\\236\\230\\376\\327\\3340*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:22.088496Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:23.043225Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7403, TLS: false"

ts=2019-03-01T04:16:23.043959Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:116 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005c481c0 NodeMap:map[dnode-0:0xc005f68840 dnode-1:0xc005f688a0 dnode-2:0xc005f68900 dnode-4:0xc005f68960] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:23.044145Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:111 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005c48540 NodeMap:map[dnode-0:0xc005f68ae0 dnode-1:0xc005f68b40 dnode-2:0xc005f68ba0 dnode-4:0xc005f68c00] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:23.044202Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="created query aggregator with db /tmp/citadel/qstore/3"

ts=2019-03-01T04:16:23.044645Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Datanode RPC server is listening on: 127.0.0.1:7403"

ts=2019-03-01T04:16:23.044672Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:23.044699Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 1, action 1/Sleep"

ts=2019-03-01T04:16:23.04479Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:16:23.045288Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:116 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005c49680 NodeMap:map[dnode-0:0xc006676600 dnode-1:0xc0066766c0 dnode-2:0xc006676780 dnode-4:0xc006676840] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:23.04539Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:23.045431Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:23.045619Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:111 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005c49a00 NodeMap:map[dnode-4:0xc006676ae0 dnode-0:0xc0066769c0 dnode-1:0xc006676a20 dnode-2:0xc006676a80] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:23.04863Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:23.048962Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 2/16 from node dnode-2 to dnode-3"

ts=2019-03-01T04:16:23.050762Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 4/9 from node dnode-4 to dnode-3"

ts=2019-03-01T04:16:23.050824Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:23.052542Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:23.052889Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:23.053194Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:18 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:16 ShardID:2 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:23.05399Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 18 on node dnode-3"

ts=2019-03-01T04:16:23.054207Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:18 ShardID:2 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:16 ShardID:2 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.054318Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:23.054608Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:23.054699Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:23.054898Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:23.055015Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:18 ShardID:2 ChunkMeta:\"\\010\\000\\020\\006\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:23.055132Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:17 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:23.055751Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 9 on node dnode-4 to secondary 17 on node dnode-3"

ts=2019-03-01T04:16:23.055792Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:23.056064Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:9 DestReplicaID:17 ShardID:4 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.056123Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:23.056456Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:23.056649Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:9 DestReplicaID:17 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:23.056916Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:23.056928Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 9 chunk 4 len: 24576"

ts=2019-03-01T04:16:23.057126Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:23.062471Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 11 on node dnode-0 as primary for shard 4"

ts=2019-03-01T04:16:23.062691Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.062726Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.06274Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:23.062869Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="kstore Sending replica &{ReplicaID:9 ShardID:4 NodeUUID:dnode-4 IsPrimary:false State:Unreachable shard:0xc0003d5920} to node dnode-4"

ts=2019-03-01T04:16:23.063067Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:9 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.063112Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:9 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.063136Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:23.063264Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="kstore Sending replica &{ReplicaID:17 ShardID:4 NodeUUID:dnode-3 IsPrimary:false State:Ready shard:0xc0003d5920} to node dnode-3"

ts=2019-03-01T04:16:23.063477Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:17 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.063508Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:17 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.063521Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:23.07694Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-2 msg="dnode-2 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:16 ShardID:2 "

ts=2019-03-01T04:16:23.07698Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:23.077873Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.077927Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.077948Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:23.078422Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:18 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.078475Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:18 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.078499Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:23.079591Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:9 ShardID:4 "

ts=2019-03-01T04:16:23.079638Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:23.080548Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:23.080603Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:23.080634Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:23.080932Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 1/1 from node dnode-4 to dnode-3"

ts=2019-03-01T04:16:23.081067Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:17 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:23.081112Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:17 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:23.081129Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:23.082598Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 2/16 from node dnode-1 to dnode-3"

ts=2019-03-01T04:16:23.083307Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:19 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:23.084129Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 6 on node dnode-0 to secondary 19 on node dnode-3"

ts=2019-03-01T04:16:23.084347Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:19 ShardID:1 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:1 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:19 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.084443Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:23.08485Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:23.085139Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:19 ShardID:1 ChunkMeta:\"\\010\\000\\020\\004\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:23.085626Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:18 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:16 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:23.086005Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:23.086321Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 7 on node dnode-0 to secondary 18 on node dnode-3"

ts=2019-03-01T04:16:23.086576Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:18 ShardID:2 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:16 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.086634Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:23.087042Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:23.087232Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:18 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:23.087504Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 7 chunk 2 len: 24576"

ts=2019-03-01T04:16:23.087508Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:23.087684Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:23.107347Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:1 ShardID:1 "

ts=2019-03-01T04:16:23.107379Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:23.108045Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:19 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.108079Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:19 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.108093Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:23.108404Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:19 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:19 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.108437Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:19 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:19 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.108451Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:23.114625Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:16 ShardID:2 "

ts=2019-03-01T04:16:23.114682Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:23.116019Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.116082Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.116106Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:23.116639Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:18 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.116699Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:18 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:18 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:23.116724Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:24.047214Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 1, action 2/VerifyConverged"

ts=2019-03-01T04:16:24.951574Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:24.951656Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 2, action 0/RestartSlowAnyNode"

ts=2019-03-01T04:16:24.951694Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-3"

ts=2019-03-01T04:16:24.951796Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-3 Stopping election loop"

ts=2019-03-01T04:16:24.951849Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-3 Leader election is stopped"

ts=2019-03-01T04:16:24.951885Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-3 at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:16:24.952021Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:24.952063Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:24.952102Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:24.952071Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}."

ts=2019-03-01T04:16:24.952257Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:129 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-0:0xc0000a89c0 dnode-1:0xc0000a9260 dnode-2:0xc0002c1560 dnode-3:0xc006240a20 dnode-4:0xc000429860] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:24.95231Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-3 unreachable"

ts=2019-03-01T04:16:24.952471Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:24.952725Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:24.95968Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:124 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-0:0xc000454480 dnode-1:0xc000454d80 dnode-2:0xc000423020 dnode-3:0xc006704ea0 dnode-4:0xc0005014a0] mclient:0xc000432000}"

ts=2019-03-01T04:16:24.959714Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-3 unreachable"

ts=2019-03-01T04:16:24.962475Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-3:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:25.463832Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="tstore/dnode-0 Node dnode-3 was unreachable for 511.463ms since 2019-02-28T20:16:24.952338-08:00. Removing it"

ts=2019-03-01T04:16:25.463883Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="kstore/dnode-0 Node dnode-3 was unreachable for 504.144ms since 2019-02-28T20:16:24.959726-08:00. Removing it"

ts=2019-03-01T04:16:25.485782Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 1 on node dnode-4"

ts=2019-03-01T04:16:25.485801Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 2 on node dnode-1"

ts=2019-03-01T04:16:25.488105Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received CreateShard req ClusterType:\"tstore\" ReplicaID:20 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:25.489281Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 6 on node dnode-0 to secondary 20 on node dnode-4"

ts=2019-03-01T04:16:25.489591Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:20 ShardID:1 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:20 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:25.489742Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:25.490174Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:25.490188Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"kstore\" ReplicaID:19 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:25.490465Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:20 ShardID:1 ChunkMeta:\"\\010\\000\\020\\004\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:25.491146Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 7 on node dnode-0 to secondary 19 on node dnode-1"

ts=2019-03-01T04:16:25.491455Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:19 ShardID:2 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:19 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:25.491547Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:25.491605Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:25.492021Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:25.492351Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:19 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:25.492776Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:25.492784Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 7 chunk 2 len: 24576"

ts=2019-03-01T04:16:25.492995Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:25.494277Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 2 on node dnode-0"

ts=2019-03-01T04:16:25.497064Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 4 on node dnode-2"

ts=2019-03-01T04:16:25.498444Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"tstore\" ReplicaID:21 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:25.499333Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 21 on node dnode-0"

ts=2019-03-01T04:16:25.499585Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:21 ShardID:2 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:25.499675Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:25.50004Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:25.500272Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:21 ShardID:2 ChunkMeta:\"\\010\\000\\020\\006\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:25.50062Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"kstore\" ReplicaID:20 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:25.501188Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:25.501253Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 11 on node dnode-0 to secondary 20 on node dnode-2"

ts=2019-03-01T04:16:25.50154Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:11 DestReplicaID:20 ShardID:4 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:20 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:25.501598Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:25.501902Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:25.502098Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:11 DestReplicaID:20 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:25.502347Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 11 chunk 4 len: 24576"

ts=2019-03-01T04:16:25.502344Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:25.502506Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info nodeuuid=dnode-2 msg="dnode-2 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:26.455155Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7403, TLS: false"

ts=2019-03-01T04:16:26.456166Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:141 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0063c6400 NodeMap:map[dnode-0:0xc006368cc0 dnode-1:0xc006368d20 dnode-2:0xc006368d80 dnode-4:0xc006368de0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:26.456391Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:136 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0063c6780 NodeMap:map[dnode-0:0xc006368f60 dnode-1:0xc006368fc0 dnode-2:0xc006369020 dnode-4:0xc006369080] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:26.457259Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="created query aggregator with db /tmp/citadel/qstore/3"

ts=2019-03-01T04:16:26.457712Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Datanode RPC server is listening on: 127.0.0.1:7403"

ts=2019-03-01T04:16:26.457765Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 2, action 1/Sleep"

ts=2019-03-01T04:16:26.457749Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:26.457894Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403} at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:16:26.458433Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:141 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0063e0ac0 NodeMap:map[dnode-4:0xc0063dcd20 dnode-0:0xc0063dcc00 dnode-1:0xc0063dcc60 dnode-2:0xc0063dccc0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:26.458516Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:26.458561Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:26.45871Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:136 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0044b0a00 NodeMap:map[dnode-0:0xc002792780 dnode-1:0xc0027927e0 dnode-2:0xc002792840 dnode-4:0xc0027928a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:26.460963Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:26.462204Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 2/21 from node dnode-0 to dnode-3"

ts=2019-03-01T04:16:26.463284Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 2/19 from node dnode-1 to dnode-3"

ts=2019-03-01T04:16:26.463347Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:26.465302Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:26.465722Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:26.466059Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:22 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:26.466842Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 22 on node dnode-3"

ts=2019-03-01T04:16:26.467123Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:22 ShardID:2 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:22 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:26.467211Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:26.467581Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:26.467631Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:26.467832Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:26.467881Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:22 ShardID:2 ChunkMeta:\"\\010\\000\\020\\006\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:26.468083Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:21 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:19 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:26.468747Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 7 on node dnode-0 to secondary 21 on node dnode-3"

ts=2019-03-01T04:16:26.468781Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:26.469014Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:21 ShardID:2 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:19 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.469074Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:26.469361Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:26.469548Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:21 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:26.469768Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 7 chunk 2 len: 24576"

ts=2019-03-01T04:16:26.469782Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:26.469952Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:26.493863Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:19 ShardID:2 "

ts=2019-03-01T04:16:26.493918Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:26.493849Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-0 msg="dnode-0 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:21 ShardID:2 "

ts=2019-03-01T04:16:26.49396Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:26.494298Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 1/20 from node dnode-4 to dnode-3"

ts=2019-03-01T04:16:26.49534Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:22 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.495485Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:22 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.495555Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:26.495572Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.495727Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.495773Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:26.496267Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 4/20 from node dnode-2 to dnode-3"

ts=2019-03-01T04:16:26.496303Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:22 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:22 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.496388Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:22 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:22 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.496503Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:21 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.49649Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:26.49659Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:21 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.496633Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:26.498781Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:23 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:20 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:26.499888Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 6 on node dnode-0 to secondary 23 on node dnode-3"

ts=2019-03-01T04:16:26.500282Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:23 ShardID:1 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:20 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:23 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.500419Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:26.500947Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:26.501335Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:23 ShardID:1 ChunkMeta:\"\\010\\000\\020\\004\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:26.502086Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:22 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:20 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:26.502251Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:26.50293Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 11 on node dnode-0 to secondary 22 on node dnode-3"

ts=2019-03-01T04:16:26.503237Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:11 DestReplicaID:22 ShardID:4 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:20 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:22 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.503328Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:26.503785Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:26.50415Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:11 DestReplicaID:22 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:26.504486Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:26.504536Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 11 chunk 4 len: 24576"

ts=2019-03-01T04:16:26.504857Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:26.527841Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:20 ShardID:1 "

ts=2019-03-01T04:16:26.527933Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:26.528351Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-2 msg="dnode-2 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:20 ShardID:4 "

ts=2019-03-01T04:16:26.528393Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:26.529288Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:23 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.529354Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:23 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.52938Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:26.529812Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:22 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.529894Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:22 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.529939Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:26.529934Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:23 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:23 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.530014Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:23 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:23 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.530055Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:26.530472Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:22 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:22 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.530544Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:22 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:22 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:26.530571Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:27.460775Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 2, action 2/VerifyConverged"

ts=2019-03-01T04:16:28.36653Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:28.366597Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 3, action 0/RestartSlowAnyNode"

ts=2019-03-01T04:16:28.366631Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-1"

ts=2019-03-01T04:16:28.36669Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-1 Stopping election loop"

ts=2019-03-01T04:16:28.366726Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-1 Leader election is stopped"

ts=2019-03-01T04:16:28.366762Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-1 at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:28.366886Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:28.366941Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:28.366958Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}."

ts=2019-03-01T04:16:28.367011Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:28.367091Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:154 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-2:0xc0002c1560 dnode-3:0xc0063dcf60 dnode-4:0xc000429860 dnode-0:0xc0000a89c0 dnode-1:0xc0000a9260] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:28.367151Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:28.367163Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:28.367256Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:28.370087Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 17 on node dnode-4 as primary for shard 4"

ts=2019-03-01T04:16:28.370464Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:17 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:28.370517Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:17 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:9 ShardID:4 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:28.370542Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:28.374493Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:149 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-1:0xc000454d80 dnode-2:0xc000423020 dnode-3:0xc00452af60 dnode-4:0xc0005014a0 dnode-0:0xc000454480] mclient:0xc000432000}"

ts=2019-03-01T04:16:28.374531Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:28.377758Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-1:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:28.877085Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="tstore/dnode-0 Node dnode-1 was unreachable for 509.866ms since 2019-02-28T20:16:28.367197-08:00. Removing it"

ts=2019-03-01T04:16:28.877085Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="kstore/dnode-0 Node dnode-1 was unreachable for 502.52ms since 2019-02-28T20:16:28.374543-08:00. Removing it"

ts=2019-03-01T04:16:28.900417Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 3 on node dnode-0"

ts=2019-03-01T04:16:28.900401Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 3 on node dnode-3"

ts=2019-03-01T04:16:28.904946Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"tstore\" ReplicaID:24 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:28.906118Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 8 on node dnode-2 to secondary 24 on node dnode-0"

ts=2019-03-01T04:16:28.906476Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:24 ShardID:3 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:24 ShardID:3 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:28.906677Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:28.907143Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:23 ShardID:3 Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:28.907311Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:28.907717Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:24 ShardID:3 ChunkMeta:\"\\010\\000\\020\\004\\030\\266\\362\\305\\322\\253\\364\\277\\266\\033*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:28.908263Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 3 on node dnode-2 to secondary 23 on node dnode-3"

ts=2019-03-01T04:16:28.908577Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:23 ShardID:3 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:23 ShardID:3 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:28.908697Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:28.90889Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:28.909294Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:28.909597Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:23 ShardID:3 Chunks:<ChunkID:3 Database:\"default\" > "

ts=2019-03-01T04:16:28.910107Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-2 msg="Syncing data from replica 3 chunk 3 len: 24576"

ts=2019-03-01T04:16:28.910098Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:28.910443Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 3 on shard 3"

ts=2019-03-01T04:16:28.912079Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 4 on node dnode-3"

ts=2019-03-01T04:16:28.914803Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 5 on node dnode-0"

ts=2019-03-01T04:16:28.916263Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:25 ShardID:4 Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:28.917004Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 17 on node dnode-4 to secondary 25 on node dnode-3"

ts=2019-03-01T04:16:28.91731Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:17 DestReplicaID:25 ShardID:4 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:25 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:28.917407Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:28.917781Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:28.917849Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"kstore\" ReplicaID:24 ShardID:5 Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:28.918084Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:17 DestReplicaID:25 ShardID:4 ChunkMeta:\"\\010\\000\\020\\006\\030\\324\\343\\221\\236\\230\\376\\327\\3340*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:28.918566Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 5 on node dnode-4 to secondary 24 on node dnode-0"

ts=2019-03-01T04:16:28.918793Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:24 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:24 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:28.918874Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:28.91888Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:28.919166Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:28.919457Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:24 ShardID:5 Chunks:<ChunkID:5 Database:\"default\" > "

ts=2019-03-01T04:16:28.91971Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:28.919743Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 5 chunk 5 len: 24576"

ts=2019-03-01T04:16:28.919883Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 5 on shard 5"

ts=2019-03-01T04:16:29.869789Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7401, TLS: false"

ts=2019-03-01T04:16:29.870694Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:166 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004d7c740 NodeMap:map[dnode-2:0xc0054490e0 dnode-3:0xc005449140 dnode-4:0xc0054491a0 dnode-0:0xc005449080] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:29.870917Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:161 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004d7cac0 NodeMap:map[dnode-4:0xc005449440 dnode-0:0xc005449320 dnode-2:0xc005449380 dnode-3:0xc0054493e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:29.870986Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:16:29.871537Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:16:29.871568Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:29.87161Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 3, action 1/Sleep"

ts=2019-03-01T04:16:29.871736Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:29.872535Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:166 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004d060c0 NodeMap:map[dnode-0:0xc0053a2a20 dnode-2:0xc0053a2a80 dnode-3:0xc0053a2ae0 dnode-4:0xc0053a2b40] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:29.872645Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:29.872691Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:29.872749Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:29.87283Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:161 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004d0c580 NodeMap:map[dnode-2:0xc0045c00c0 dnode-3:0xc0045c0120 dnode-4:0xc0045c0180 dnode-0:0xc0045c0060] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:29.875246Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:29.876002Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 3/24 from node dnode-0 to dnode-1"

ts=2019-03-01T04:16:29.877633Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 3/23 from node dnode-3 to dnode-1"

ts=2019-03-01T04:16:29.87952Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:29.879892Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:29.880226Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"tstore\" ReplicaID:26 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:24 ShardID:3 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:29.881068Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 8 on node dnode-2 to secondary 26 on node dnode-1"

ts=2019-03-01T04:16:29.88134Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:26 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:24 ShardID:3 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:29.881429Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:29.881651Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:29.881816Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:29.881977Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:29.882137Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:8 DestReplicaID:26 ShardID:3 ChunkMeta:\"\\010\\000\\020\\004\\030\\266\\362\\305\\322\\253\\364\\277\\266\\033*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:29.882268Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"kstore\" ReplicaID:25 ShardID:3 Replicas:<ClusterType:\"kstore\" ReplicaID:23 ShardID:3 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:29.882889Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 3 on node dnode-2 to secondary 25 on node dnode-1"

ts=2019-03-01T04:16:29.883074Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:29.883184Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:25 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:23 ShardID:3 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:29.883262Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:29.883587Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:29.883851Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:3 DestReplicaID:25 ShardID:3 Chunks:<ChunkID:3 Database:\"default\" > "

ts=2019-03-01T04:16:29.884078Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:29.884101Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-2 msg="Syncing data from replica 3 chunk 3 len: 24576"

ts=2019-03-01T04:16:29.884247Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 3 on shard 3"

ts=2019-03-01T04:16:29.905266Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:23 ShardID:3 "

ts=2019-03-01T04:16:29.905301Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:29.906176Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:29.90621Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:29.906224Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:29.906648Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:25 ShardID:3 Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:29.906696Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:25 ShardID:3 Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:29.90672Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:29.908894Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 5/24 from node dnode-0 to dnode-1"

ts=2019-03-01T04:16:29.909082Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-0 msg="dnode-0 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:24 ShardID:3 "

ts=2019-03-01T04:16:29.909107Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:29.909684Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 2/22 from node dnode-3 to dnode-1"

ts=2019-03-01T04:16:29.909795Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:29.909845Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:29.909867Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:29.91027Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:26 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:29.910316Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:26 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:29.910333Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:29.911301Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"kstore\" ReplicaID:26 ShardID:5 Replicas:<ClusterType:\"kstore\" ReplicaID:24 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:29.911831Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 5 on node dnode-4 to secondary 26 on node dnode-1"

ts=2019-03-01T04:16:29.912031Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:26 ShardID:5 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:24 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:29.912091Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:29.91245Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:29.912694Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:26 ShardID:5 Chunks:<ChunkID:5 Database:\"default\" > "

ts=2019-03-01T04:16:29.912977Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 5 chunk 5 len: 24576"

ts=2019-03-01T04:16:29.91298Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:29.913179Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 5 on shard 5"

ts=2019-03-01T04:16:29.913582Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"tstore\" ReplicaID:27 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:22 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:29.914249Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 27 on node dnode-1"

ts=2019-03-01T04:16:29.914458Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:27 ShardID:2 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:22 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:29.914538Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:29.914819Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:29.915043Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:27 ShardID:2 ChunkMeta:\"\\010\\000\\020\\006\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:29.915758Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:29.939313Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-0 msg="dnode-0 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:24 ShardID:5 "

ts=2019-03-01T04:16:29.939383Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:29.93931Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:22 ShardID:2 "

ts=2019-03-01T04:16:29.939474Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:29.940597Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:29.94065Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:29.940674Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:29.940779Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:29.940848Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:29.940878Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:29.941196Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:27 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:29.941266Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:27 ShardID:2 Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:29.941299Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:29.941425Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:26 ShardID:5 Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:29.941484Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:26 ShardID:5 Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:29.941517Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:30.873833Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 3, action 2/VerifyConverged"

ts=2019-03-01T04:16:31.780779Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:31.780833Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 4, action 0/RestartSlowAnyNode"

ts=2019-03-01T04:16:31.780853Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-2"

ts=2019-03-01T04:16:31.780894Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-2 Stopping election loop"

ts=2019-03-01T04:16:31.780912Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-2 Leader election is stopped"

ts=2019-03-01T04:16:31.780931Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-2 at Path /venice/citadel/nodes/dnode-2"

ts=2019-03-01T04:16:31.781006Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:31.781039Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:31.781052Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}."

ts=2019-03-01T04:16:31.781079Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:31.78117Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:174 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0003d05c0 NodeMap:map[dnode-4:0xc0005014a0 dnode-0:0xc000454480 dnode-1:0xc0044db140 dnode-2:0xc000423020 dnode-3:0xc00452af60] mclient:0xc000432000}"

ts=2019-03-01T04:16:31.781206Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-2 unreachable"

ts=2019-03-01T04:16:31.781217Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:31.78124Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 25 on node dnode-1 as primary for shard 3"

ts=2019-03-01T04:16:31.781289Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7402"

ts=2019-03-01T04:16:31.781779Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:25 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:31.781848Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:25 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:3 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:31.781879Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:31.784547Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 15 on node dnode-4 as primary for shard 1"

ts=2019-03-01T04:16:31.784841Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:31.784882Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:31.784899Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:31.788993Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:179 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000046900 NodeMap:map[dnode-0:0xc0000a89c0 dnode-1:0xc0053a2d80 dnode-2:0xc0002c1560 dnode-3:0xc0063dcf60 dnode-4:0xc000429860] mclient:0xc0001288c0}"

ts=2019-03-01T04:16:31.789026Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-2 unreachable"

ts=2019-03-01T04:16:31.789044Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 26 on node dnode-1 as primary for shard 3"

ts=2019-03-01T04:16:31.789256Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:26 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:31.789305Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:26 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:8 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:31.78933Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:31.790949Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-2:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:32.290365Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="kstore/dnode-0 Node dnode-2 was unreachable for 509.115ms since 2019-02-28T20:16:31.781226-08:00. Removing it"

ts=2019-03-01T04:16:32.290376Z module=Default pid=20890 caller=metamgr.go:551 level=info msg="tstore/dnode-0 Node dnode-2 was unreachable for 501.318ms since 2019-02-28T20:16:31.789036-08:00. Removing it"

ts=2019-03-01T04:16:32.309512Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 1 on node dnode-0"

ts=2019-03-01T04:16:32.311607Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 3 on node dnode-3"

ts=2019-03-01T04:16:32.312661Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info nodeuuid=dnode-0 msg="dnode-0 Received CreateShard req ClusterType:\"kstore\" ReplicaID:27 ShardID:1 Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:32.314253Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 15 on node dnode-4 to secondary 27 on node dnode-0"

ts=2019-03-01T04:16:32.314604Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:32.314677Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:32.314776Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"tstore\" ReplicaID:28 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:32.315227Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:32.315576Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:32.315845Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 26 on node dnode-1 to secondary 28 on node dnode-3"

ts=2019-03-01T04:16:32.315919Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 15 chunk 1 len: 24576"

ts=2019-03-01T04:16:32.316058Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:32.316192Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:16:32.316384Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:26 DestReplicaID:28 ShardID:3 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:32.316538Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:32.317107Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:32.31739Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:26 DestReplicaID:28 ShardID:3 ChunkMeta:\"\\010\\000\\020\\006\\030\\266\\362\\305\\322\\253\\364\\277\\266\\033*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:32.31826Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:32.32143Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="kstore/dnode-0 Creating replica for shard 3 on node dnode-3"

ts=2019-03-01T04:16:32.322879Z module=Default pid=20890 caller=metamgr.go:487 level=info msg="tstore/dnode-0 Creating replica for shard 5 on node dnode-1"

ts=2019-03-01T04:16:32.324708Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received CreateShard req ClusterType:\"kstore\" ReplicaID:28 ShardID:3 Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:32.325269Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 25 on node dnode-1 to secondary 28 on node dnode-3"

ts=2019-03-01T04:16:32.325504Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:25 DestReplicaID:28 ShardID:3 DestNodeUUID:\"dnode-3\" DestNodeURL:\"127.0.0.1:7403\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:28 ShardID:3 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:32.325568Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:32.325852Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:32.326086Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:25 DestReplicaID:28 ShardID:3 Chunks:<ChunkID:3 Database:\"default\" > "

ts=2019-03-01T04:16:32.326357Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncData req"

ts=2019-03-01T04:16:32.326489Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="Syncing data from replica 25 chunk 3 len: 24576"

ts=2019-03-01T04:16:32.326584Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received CreateShard req ClusterType:\"tstore\" ReplicaID:29 ShardID:5 Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:32.326655Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Restoring kstore Chunk 3 on shard 3"

ts=2019-03-01T04:16:32.327259Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 10 on node dnode-0 to secondary 29 on node dnode-1"

ts=2019-03-01T04:16:32.327475Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:29 ShardID:5 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:32.327566Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:32.327948Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:32.328159Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:29 ShardID:5 ChunkMeta:\"\\010\\000\\020\\004\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:32.328863Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:33.284321Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7402, TLS: false"

ts=2019-03-01T04:16:33.285265Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:191 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0041c9d80 NodeMap:map[dnode-1:0xc0057325a0 dnode-3:0xc005732600 dnode-4:0xc005732660 dnode-0:0xc005732540] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:33.285486Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:186 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006126100 NodeMap:map[dnode-0:0xc0057327e0 dnode-1:0xc005732840 dnode-3:0xc0057328a0 dnode-4:0xc005732900] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:33.286168Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="created query aggregator with db /tmp/citadel/qstore/2"

ts=2019-03-01T04:16:33.28662Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Datanode RPC server is listening on: 127.0.0.1:7402"

ts=2019-03-01T04:16:33.286674Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 4, action 1/Sleep"

ts=2019-03-01T04:16:33.286665Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7402"

ts=2019-03-01T04:16:33.286778Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402} at Path /venice/citadel/nodes/dnode-2"

ts=2019-03-01T04:16:33.287595Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:191 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00678d280 NodeMap:map[dnode-1:0xc0056dd2c0 dnode-3:0xc0056dd320 dnode-4:0xc0056dd380 dnode-0:0xc0056dd260] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:33.287718Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:33.287762Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:33.287854Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:186 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0056d2680 NodeMap:map[dnode-0:0xc0057880c0 dnode-1:0xc005788120 dnode-3:0xc005788180 dnode-4:0xc0057881e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:33.290652Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:33.290725Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-2 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:33.298537Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 2/7 from node dnode-0 to dnode-2"

ts=2019-03-01T04:16:33.300194Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 3/26 from node dnode-1 to dnode-2"

ts=2019-03-01T04:16:33.302369Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:33.30293Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:33.303362Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"kstore\" ReplicaID:29 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.304206Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 7 on node dnode-0 to secondary 29 on node dnode-2"

ts=2019-03-01T04:16:33.304535Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:29 ShardID:2 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:33.304618Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:33.305189Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:33.305508Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:7 DestReplicaID:29 ShardID:2 Chunks:<ChunkID:2 Database:\"default\" > "

ts=2019-03-01T04:16:33.305665Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:33.305904Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 7 chunk 2 len: 24576"

ts=2019-03-01T04:16:33.30591Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:33.306038Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:33.306132Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Restoring kstore Chunk 2 on shard 2"

ts=2019-03-01T04:16:33.30636Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"tstore\" ReplicaID:30 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:33.30737Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 26 on node dnode-1 to secondary 30 on node dnode-2"

ts=2019-03-01T04:16:33.30763Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:26 DestReplicaID:30 ShardID:3 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:33.30772Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:33.308105Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:33.308358Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:26 DestReplicaID:30 ShardID:3 ChunkMeta:\"\\010\\000\\020\\006\\030\\266\\362\\305\\322\\253\\364\\277\\266\\033*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:33.309202Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:33.3136Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 29 on node dnode-2 as primary for shard 2"

ts=2019-03-01T04:16:33.313853Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.313905Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.31396Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:33.314211Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="kstore Sending replica &{ReplicaID:7 ShardID:2 NodeUUID:dnode-0 IsPrimary:false State:Unreachable shard:0xc0003d5860} to node dnode-0"

ts=2019-03-01T04:16:33.314413Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:7 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.314443Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:7 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.314456Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.314575Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="kstore Sending replica &{ReplicaID:21 ShardID:2 NodeUUID:dnode-3 IsPrimary:false State:Ready shard:0xc0003d5860} to node dnode-3"

ts=2019-03-01T04:16:33.314812Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:21 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.314859Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:21 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.314879Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.315793Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 28 on node dnode-3 as primary for shard 3"

ts=2019-03-01T04:16:33.315996Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:33.31603Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:33.316044Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:33.316175Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="tstore Sending replica &{ReplicaID:26 ShardID:3 NodeUUID:dnode-1 IsPrimary:false State:Unreachable shard:0xc00003a660} to node dnode-1"

ts=2019-03-01T04:16:33.316396Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:26 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:33.316433Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:26 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:33.316454Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.316611Z module=Default pid=20890 caller=metamgr.go:155 level=info msg="tstore Sending replica &{ReplicaID:30 ShardID:3 NodeUUID:dnode-2 IsPrimary:false State:Ready shard:0xc00003a660} to node dnode-2"

ts=2019-03-01T04:16:33.316897Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:30 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:33.316926Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:30 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:26 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:33.316938Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.331074Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info nodeuuid=dnode-0 msg="dnode-0 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:7 ShardID:2 "

ts=2019-03-01T04:16:33.331115Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.332154Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:33.332198Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:33.332217Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:33.332627Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:21 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:33.332683Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:21 ShardID:2 Replicas:<ClusterType:\"kstore\" ReplicaID:29 ShardID:2 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:21 ShardID:2 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:33.332702Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.335159Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="kstore/dnode-0 Moving replica 4/22 from node dnode-3 to dnode-2"

ts=2019-03-01T04:16:33.336134Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:26 ShardID:3 "

ts=2019-03-01T04:16:33.336184Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.336924Z module=Default pid=20890 caller=metamgr.go:519 level=info msg="tstore/dnode-0 Moving replica 1/23 from node dnode-3 to dnode-2"

ts=2019-03-01T04:16:33.337223Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:33.337288Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:33.33732Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:33.337733Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:30 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:33.337775Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:30 ShardID:3 Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:33.337798Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.338733Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"kstore\" ReplicaID:30 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:22 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.339473Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 11 on node dnode-0 to secondary 30 on node dnode-2"

ts=2019-03-01T04:16:33.339753Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:11 DestReplicaID:30 ShardID:4 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:22 ShardID:4 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:33.339841Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:33.340365Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:33.340584Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:11 DestReplicaID:30 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:33.34089Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info nodeuuid=dnode-0 msg="Syncing data from replica 11 chunk 4 len: 24576"

ts=2019-03-01T04:16:33.340954Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:33.341084Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:33.34165Z module=citadel-integ-test pid=20890 caller=datanode.go:289 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received CreateShard req ClusterType:\"tstore\" ReplicaID:31 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:23 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:33.342395Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 6 on node dnode-0 to secondary 31 on node dnode-2"

ts=2019-03-01T04:16:33.34264Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:31 ShardID:1 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:23 ShardID:1 NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.342718Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:33.343107Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:33.343365Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:31 ShardID:1 ChunkMeta:\"\\010\\000\\020\\004\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:33.344045Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:33.366195Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received DeleteShard req ClusterType:\"kstore\" ReplicaID:22 ShardID:4 "

ts=2019-03-01T04:16:33.366245Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.367504Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:33.367584Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:33.367611Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:33.368264Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:30 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:33.368332Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:30 ShardID:4 Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:33.368359Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.368993Z module=citadel-integ-test pid=20890 caller=datanode.go:413 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received DeleteShard req ClusterType:\"tstore\" ReplicaID:23 ShardID:1 "

ts=2019-03-01T04:16:33.369023Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.369891Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:31 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.369944Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:31 ShardID:1 Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.369964Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:33.370403Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.370457Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:33.370486Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:34.287149Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 1/NodeRestatSlow, iter 4, action 2/VerifyConverged"

ts=2019-03-01T04:16:35.189596Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:35.189657Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartSlowTest/2 VerifyKvs"

ts=2019-03-01T04:16:35.189676Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 2/VerifyKvs, iter 0, action 0/VerifyConverged"

ts=2019-03-01T04:16:36.098634Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:36.098697Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 2/VerifyKvs, iter 0, action 1/VerifyKvPattern"

ts=2019-03-01T04:16:36.101285Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MC0x\",\"Value\":\"VmFsdWUwLTE=\"},{\"Key\":\"S2V5MC00\",\"Value\":\"VmFsdWUwLTQ=\"},{\"Key\":\"S2V5MC03\",\"Value\":\"VmFsdWUwLTc=\"},{\"Key\":\"S2V5MC04\",\"Value\":\"VmFsdWUwLTg=\"},{\"Key\":\"S2V5MC0w\",\"Value\":\"VmFsdWUwLTA=\"},{\"Key\":\"S2V5MC0z\",\"Value\":\"VmFsdWUwLTM=\"},{\"Key\":\"S2V5MC01\",\"Value\":\"VmFsdWUwLTU=\"},{\"Key\":\"S2V5MC05\",\"Value\":\"VmFsdWUwLTk=\"},{\"Key\":\"S2V5MC02\",\"Value\":\"VmFsdWUwLTY=\"},{\"Key\":\"S2V5MC0y\",\"Value\":\"VmFsdWUwLTI=\"}]"

ts=2019-03-01T04:16:36.103468Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MS0y\",\"Value\":\"VmFsdWUxLTI=\"},{\"Key\":\"S2V5MS0z\",\"Value\":\"VmFsdWUxLTM=\"},{\"Key\":\"S2V5MS04\",\"Value\":\"VmFsdWUxLTg=\"},{\"Key\":\"S2V5MS05\",\"Value\":\"VmFsdWUxLTk=\"},{\"Key\":\"S2V5MS0x\",\"Value\":\"VmFsdWUxLTE=\"},{\"Key\":\"S2V5MS00\",\"Value\":\"VmFsdWUxLTQ=\"},{\"Key\":\"S2V5MS02\",\"Value\":\"VmFsdWUxLTY=\"},{\"Key\":\"S2V5MS03\",\"Value\":\"VmFsdWUxLTc=\"},{\"Key\":\"S2V5MS0w\",\"Value\":\"VmFsdWUxLTA=\"},{\"Key\":\"S2V5MS01\",\"Value\":\"VmFsdWUxLTU=\"}]"

ts=2019-03-01T04:16:36.105111Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5Mi0y\",\"Value\":\"VmFsdWUyLTI=\"},{\"Key\":\"S2V5Mi03\",\"Value\":\"VmFsdWUyLTc=\"},{\"Key\":\"S2V5Mi0w\",\"Value\":\"VmFsdWUyLTA=\"},{\"Key\":\"S2V5Mi00\",\"Value\":\"VmFsdWUyLTQ=\"},{\"Key\":\"S2V5Mi01\",\"Value\":\"VmFsdWUyLTU=\"},{\"Key\":\"S2V5Mi0z\",\"Value\":\"VmFsdWUyLTM=\"},{\"Key\":\"S2V5Mi0x\",\"Value\":\"VmFsdWUyLTE=\"},{\"Key\":\"S2V5Mi04\",\"Value\":\"VmFsdWUyLTg=\"},{\"Key\":\"S2V5Mi05\",\"Value\":\"VmFsdWUyLTk=\"},{\"Key\":\"S2V5Mi02\",\"Value\":\"VmFsdWUyLTY=\"}]"

ts=2019-03-01T04:16:36.106761Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5My02\",\"Value\":\"VmFsdWUzLTY=\"},{\"Key\":\"S2V5My0w\",\"Value\":\"VmFsdWUzLTA=\"},{\"Key\":\"S2V5My01\",\"Value\":\"VmFsdWUzLTU=\"},{\"Key\":\"S2V5My03\",\"Value\":\"VmFsdWUzLTc=\"},{\"Key\":\"S2V5My04\",\"Value\":\"VmFsdWUzLTg=\"},{\"Key\":\"S2V5My0x\",\"Value\":\"VmFsdWUzLTE=\"},{\"Key\":\"S2V5My0y\",\"Value\":\"VmFsdWUzLTI=\"},{\"Key\":\"S2V5My00\",\"Value\":\"VmFsdWUzLTQ=\"},{\"Key\":\"S2V5My0z\",\"Value\":\"VmFsdWUzLTM=\"},{\"Key\":\"S2V5My05\",\"Value\":\"VmFsdWUzLTk=\"}]"

ts=2019-03-01T04:16:36.108031Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5NC0z\",\"Value\":\"VmFsdWU0LTM=\"},{\"Key\":\"S2V5NC05\",\"Value\":\"VmFsdWU0LTk=\"},{\"Key\":\"S2V5NC0w\",\"Value\":\"VmFsdWU0LTA=\"},{\"Key\":\"S2V5NC00\",\"Value\":\"VmFsdWU0LTQ=\"},{\"Key\":\"S2V5NC0x\",\"Value\":\"VmFsdWU0LTE=\"},{\"Key\":\"S2V5NC0y\",\"Value\":\"VmFsdWU0LTI=\"},{\"Key\":\"S2V5NC03\",\"Value\":\"VmFsdWU0LTc=\"},{\"Key\":\"S2V5NC01\",\"Value\":\"VmFsdWU0LTU=\"},{\"Key\":\"S2V5NC02\",\"Value\":\"VmFsdWU0LTY=\"},{\"Key\":\"S2V5NC04\",\"Value\":\"VmFsdWU0LTg=\"}]"

ts=2019-03-01T04:16:36.10824Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreNodeRestartSlow completed =========================="

ts=2019-03-01T04:16:36.108361Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreNodeSoftRestart starting =========================="

ts=2019-03-01T04:16:36.108471Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case NodeSoftRestartTest ###################"

ts=2019-03-01T04:16:37.015599Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:37.015657Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### NodeSoftRestartTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:16:37.015679Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeSoftRestartTest/0 WriteKvs"

ts=2019-03-01T04:16:37.0157Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 0/WriteKvs, iter 0, action 0/WriteKvPattern"

ts=2019-03-01T04:16:37.030987Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:37.031479Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:37.034718Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:37.035011Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:37.051087Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:37.051608Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:37.05545Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:37.055796Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:37.213198Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeSoftRestartTest/1 NodeSoftRestart"

ts=2019-03-01T04:16:37.213244Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 0, action 0/SoftRestartAnyNode"

ts=2019-03-01T04:16:37.213288Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:37.213326Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:37.213355Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:37.213431Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:37.213492Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7402"

ts=2019-03-01T04:16:37.21387Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:37.213975Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Datanode RPC server is listening on: 127.0.0.1:7402"

ts=2019-03-01T04:16:37.214054Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7402"

ts=2019-03-01T04:16:37.215018Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004a37780 NodeMap:map[dnode-0:0xc0068d91a0 dnode-1:0xc0068d9200 dnode-2:0xc0068d9260 dnode-3:0xc0068d92c0 dnode-4:0xc0068d9320] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:37.215076Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="created query aggregator with db /tmp/citadel/qstore/2"

ts=2019-03-01T04:16:37.215186Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004a37b00 NodeMap:map[dnode-0:0xc0068d9440 dnode-1:0xc0068d94a0 dnode-2:0xc0068d9500 dnode-3:0xc0068d9560 dnode-4:0xc0068d95c0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:37.215657Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Restored tstore replica 31 shard 1"

ts=2019-03-01T04:16:37.215841Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Restored tstore replica 30 shard 3"

ts=2019-03-01T04:16:37.216133Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Restored kstore replica 29 shard 2"

ts=2019-03-01T04:16:37.216256Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Restored kstore replica 30 shard 4"

ts=2019-03-01T04:16:37.216304Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 0, action 1/Sleep"

ts=2019-03-01T04:16:37.216883Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00638bc80 NodeMap:map[dnode-0:0xc006b7eba0 dnode-1:0xc006b7ec00 dnode-2:0xc006b7ec60 dnode-3:0xc006b7ecc0 dnode-4:0xc006b7ed20] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:37.217036Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0065a6000 NodeMap:map[dnode-0:0xc006b7ee40 dnode-1:0xc006b7eea0 dnode-2:0xc006b7ef00 dnode-3:0xc006b7ef60 dnode-4:0xc006b7efc0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:37.317292Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 0, action 2/VerifyConverged"

ts=2019-03-01T04:16:38.223094Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:38.223156Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 1, action 0/SoftRestartAnyNode"

ts=2019-03-01T04:16:38.223222Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:38.223271Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:38.223318Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:38.223453Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:38.223537Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:38.22422Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:38.224319Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Datanode RPC server is listening on: 127.0.0.1:7403"

ts=2019-03-01T04:16:38.224433Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:38.225751Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0065c4680 NodeMap:map[dnode-1:0xc0060297a0 dnode-2:0xc006029800 dnode-3:0xc006029860 dnode-4:0xc0060298c0 dnode-0:0xc006029740] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:38.22604Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0065c4a00 NodeMap:map[dnode-2:0xc006029aa0 dnode-3:0xc006029b00 dnode-4:0xc006029b60 dnode-0:0xc0060299e0 dnode-1:0xc006029a40] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:38.226485Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="created query aggregator with db /tmp/citadel/qstore/3"

ts=2019-03-01T04:16:38.227039Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Restored tstore replica 28 shard 3"

ts=2019-03-01T04:16:38.227269Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Restored tstore replica 25 shard 4"

ts=2019-03-01T04:16:38.227606Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Restored kstore replica 21 shard 2"

ts=2019-03-01T04:16:38.227748Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Restored kstore replica 28 shard 3"

ts=2019-03-01T04:16:38.227799Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 1, action 1/Sleep"

ts=2019-03-01T04:16:38.228521Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006033d00 NodeMap:map[dnode-4:0xc0060494a0 dnode-0:0xc006049320 dnode-1:0xc006049380 dnode-2:0xc0060493e0 dnode-3:0xc006049440] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:38.228702Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006d66080 NodeMap:map[dnode-0:0xc0060495c0 dnode-1:0xc006049620 dnode-2:0xc006049680 dnode-3:0xc0060496e0 dnode-4:0xc006049740] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:38.331136Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 1, action 2/VerifyConverged"

ts=2019-03-01T04:16:39.234075Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:39.234137Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 2, action 0/SoftRestartAnyNode"

ts=2019-03-01T04:16:39.234193Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:39.234226Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:39.234263Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:39.234443Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:39.234558Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:39.235187Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:39.235286Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Datanode RPC server is listening on: 127.0.0.1:7403"

ts=2019-03-01T04:16:39.2354Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7403"

ts=2019-03-01T04:16:39.236842Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0065c8dc0 NodeMap:map[dnode-0:0xc0065bb320 dnode-1:0xc0065bb380 dnode-2:0xc0065bb3e0 dnode-3:0xc0065bb440 dnode-4:0xc0065bb4a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:39.237093Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0065c9140 NodeMap:map[dnode-3:0xc0065bb6e0 dnode-4:0xc0065bb740 dnode-0:0xc0065bb5c0 dnode-1:0xc0065bb620 dnode-2:0xc0065bb680] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:39.237402Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="created query aggregator with db /tmp/citadel/qstore/3"

ts=2019-03-01T04:16:39.237965Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Restored tstore replica 28 shard 3"

ts=2019-03-01T04:16:39.238184Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Restored tstore replica 25 shard 4"

ts=2019-03-01T04:16:39.238508Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Restored kstore replica 21 shard 2"

ts=2019-03-01T04:16:39.238672Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Restored kstore replica 28 shard 3"

ts=2019-03-01T04:16:39.238728Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 2, action 1/Sleep"

ts=2019-03-01T04:16:39.239434Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006e0e440 NodeMap:map[dnode-3:0xc005603c80 dnode-4:0xc005603ce0 dnode-0:0xc005603b60 dnode-1:0xc005603bc0 dnode-2:0xc005603c20] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:39.239633Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006e0e7c0 NodeMap:map[dnode-2:0xc005603ec0 dnode-3:0xc005603f20 dnode-4:0xc005603f80 dnode-0:0xc005603e00 dnode-1:0xc005603e60] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:39.339365Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 2, action 2/VerifyConverged"

ts=2019-03-01T04:16:40.242514Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:40.242577Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 3, action 0/SoftRestartAnyNode"

ts=2019-03-01T04:16:40.242696Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:40.242778Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:40.242817Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:40.242947Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:40.243057Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7402"

ts=2019-03-01T04:16:40.243591Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:40.243697Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Datanode RPC server is listening on: 127.0.0.1:7402"

ts=2019-03-01T04:16:40.243773Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7402"

ts=2019-03-01T04:16:40.245007Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006e2c700 NodeMap:map[dnode-4:0xc006df55c0 dnode-0:0xc006df5440 dnode-1:0xc006df54a0 dnode-2:0xc006df5500 dnode-3:0xc006df5560] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:40.245076Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="created query aggregator with db /tmp/citadel/qstore/2"

ts=2019-03-01T04:16:40.245336Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006e2ca80 NodeMap:map[dnode-3:0xc006df5800 dnode-4:0xc006df5860 dnode-0:0xc006df56e0 dnode-1:0xc006df5740 dnode-2:0xc006df57a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:40.245963Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Restored tstore replica 31 shard 1"

ts=2019-03-01T04:16:40.246206Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Restored tstore replica 30 shard 3"

ts=2019-03-01T04:16:40.246572Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Restored kstore replica 29 shard 2"

ts=2019-03-01T04:16:40.246716Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Restored kstore replica 30 shard 4"

ts=2019-03-01T04:16:40.246765Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 3, action 1/Sleep"

ts=2019-03-01T04:16:40.247425Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0065ed780 NodeMap:map[dnode-1:0xc0069d6060 dnode-2:0xc0069d60c0 dnode-3:0xc0069d6120 dnode-4:0xc0069d6180 dnode-0:0xc0069d6000] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:40.2476Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0065edb00 NodeMap:map[dnode-2:0xc0069d6360 dnode-3:0xc0069d63c0 dnode-4:0xc0069d6420 dnode-0:0xc0069d62a0 dnode-1:0xc0069d6300] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:40.347861Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 3, action 2/VerifyConverged"

ts=2019-03-01T04:16:41.251748Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:41.25182Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 4, action 0/SoftRestartAnyNode"

ts=2019-03-01T04:16:41.25193Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:41.252052Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:41.252151Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:41.252308Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:41.252457Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:41.252927Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:41.253033Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info nodeuuid=dnode-0 msg="Datanode RPC server is listening on: 127.0.0.1:7400"

ts=2019-03-01T04:16:41.253097Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:41.254481Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006a14740 NodeMap:map[dnode-4:0xc006053980 dnode-0:0xc006053800 dnode-1:0xc006053860 dnode-2:0xc0060538c0 dnode-3:0xc006053920] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:41.25479Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006a14ac0 NodeMap:map[dnode-3:0xc006053bc0 dnode-4:0xc006053c20 dnode-0:0xc006053aa0 dnode-1:0xc006053b00 dnode-2:0xc006053b60] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:41.255274Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info nodeuuid=dnode-0 msg="created query aggregator with db /tmp/citadel/qstore/0"

ts=2019-03-01T04:16:41.255701Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info nodeuuid=dnode-0 msg="Restored tstore replica 6 shard 1"

ts=2019-03-01T04:16:41.255895Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info nodeuuid=dnode-0 msg="Restored tstore replica 10 shard 5"

ts=2019-03-01T04:16:41.256211Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info nodeuuid=dnode-0 msg="Restored kstore replica 27 shard 1"

ts=2019-03-01T04:16:41.256353Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info nodeuuid=dnode-0 msg="Restored kstore replica 11 shard 4"

ts=2019-03-01T04:16:41.256438Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 4, action 1/Sleep"

ts=2019-03-01T04:16:41.257249Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:204 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006a23580 NodeMap:map[dnode-4:0xc006929140 dnode-0:0xc006928fc0 dnode-1:0xc006929020 dnode-2:0xc006929080 dnode-3:0xc0069290e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:41.257428Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:199 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006a23900 NodeMap:map[dnode-4:0xc0069293e0 dnode-0:0xc006929260 dnode-1:0xc0069292c0 dnode-2:0xc006929320 dnode-3:0xc006929380] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:41.357314Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 1/NodeSoftRestart, iter 4, action 2/VerifyConverged"

ts=2019-03-01T04:16:42.263219Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:42.263277Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeSoftRestartTest/2 VerifyKvs"

ts=2019-03-01T04:16:42.263301Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 2/VerifyKvs, iter 0, action 0/VerifyConverged"

ts=2019-03-01T04:16:43.166947Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:43.167015Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 2/VerifyKvs, iter 0, action 1/VerifyKvPattern"

ts=2019-03-01T04:16:43.167217Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:43.167819Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:43.168542Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:43.16895Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:43.169691Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:43.170089Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:43.171536Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MC03\",\"Value\":\"VmFsdWUwLTc=\"},{\"Key\":\"S2V5MC0x\",\"Value\":\"VmFsdWUwLTE=\"},{\"Key\":\"S2V5MC02\",\"Value\":\"VmFsdWUwLTY=\"},{\"Key\":\"S2V5MC04\",\"Value\":\"VmFsdWUwLTg=\"},{\"Key\":\"S2V5MC0y\",\"Value\":\"VmFsdWUwLTI=\"},{\"Key\":\"S2V5MC0w\",\"Value\":\"VmFsdWUwLTA=\"},{\"Key\":\"S2V5MC0z\",\"Value\":\"VmFsdWUwLTM=\"},{\"Key\":\"S2V5MC00\",\"Value\":\"VmFsdWUwLTQ=\"},{\"Key\":\"S2V5MC01\",\"Value\":\"VmFsdWUwLTU=\"},{\"Key\":\"S2V5MC05\",\"Value\":\"VmFsdWUwLTk=\"}]"

ts=2019-03-01T04:16:43.173384Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MS0x\",\"Value\":\"VmFsdWUxLTE=\"},{\"Key\":\"S2V5MS0y\",\"Value\":\"VmFsdWUxLTI=\"},{\"Key\":\"S2V5MS0z\",\"Value\":\"VmFsdWUxLTM=\"},{\"Key\":\"S2V5MS00\",\"Value\":\"VmFsdWUxLTQ=\"},{\"Key\":\"S2V5MS02\",\"Value\":\"VmFsdWUxLTY=\"},{\"Key\":\"S2V5MS04\",\"Value\":\"VmFsdWUxLTg=\"},{\"Key\":\"S2V5MS01\",\"Value\":\"VmFsdWUxLTU=\"},{\"Key\":\"S2V5MS05\",\"Value\":\"VmFsdWUxLTk=\"},{\"Key\":\"S2V5MS0w\",\"Value\":\"VmFsdWUxLTA=\"},{\"Key\":\"S2V5MS03\",\"Value\":\"VmFsdWUxLTc=\"}]"

ts=2019-03-01T04:16:43.17366Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:43.1741Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:43.176071Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5Mi0y\",\"Value\":\"VmFsdWUyLTI=\"},{\"Key\":\"S2V5Mi00\",\"Value\":\"VmFsdWUyLTQ=\"},{\"Key\":\"S2V5Mi03\",\"Value\":\"VmFsdWUyLTc=\"},{\"Key\":\"S2V5Mi04\",\"Value\":\"VmFsdWUyLTg=\"},{\"Key\":\"S2V5Mi05\",\"Value\":\"VmFsdWUyLTk=\"},{\"Key\":\"S2V5Mi0x\",\"Value\":\"VmFsdWUyLTE=\"},{\"Key\":\"S2V5Mi0z\",\"Value\":\"VmFsdWUyLTM=\"},{\"Key\":\"S2V5Mi02\",\"Value\":\"VmFsdWUyLTY=\"},{\"Key\":\"S2V5Mi01\",\"Value\":\"VmFsdWUyLTU=\"},{\"Key\":\"S2V5Mi0w\",\"Value\":\"VmFsdWUyLTA=\"}]"

ts=2019-03-01T04:16:43.176838Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:43.177213Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:43.178262Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5My0w\",\"Value\":\"VmFsdWUzLTA=\"},{\"Key\":\"S2V5My01\",\"Value\":\"VmFsdWUzLTU=\"},{\"Key\":\"S2V5My02\",\"Value\":\"VmFsdWUzLTY=\"},{\"Key\":\"S2V5My00\",\"Value\":\"VmFsdWUzLTQ=\"},{\"Key\":\"S2V5My05\",\"Value\":\"VmFsdWUzLTk=\"},{\"Key\":\"S2V5My0x\",\"Value\":\"VmFsdWUzLTE=\"},{\"Key\":\"S2V5My0y\",\"Value\":\"VmFsdWUzLTI=\"},{\"Key\":\"S2V5My0z\",\"Value\":\"VmFsdWUzLTM=\"},{\"Key\":\"S2V5My03\",\"Value\":\"VmFsdWUzLTc=\"},{\"Key\":\"S2V5My04\",\"Value\":\"VmFsdWUzLTg=\"}]"

ts=2019-03-01T04:16:43.179495Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5NC02\",\"Value\":\"VmFsdWU0LTY=\"},{\"Key\":\"S2V5NC0x\",\"Value\":\"VmFsdWU0LTE=\"},{\"Key\":\"S2V5NC0y\",\"Value\":\"VmFsdWU0LTI=\"},{\"Key\":\"S2V5NC00\",\"Value\":\"VmFsdWU0LTQ=\"},{\"Key\":\"S2V5NC05\",\"Value\":\"VmFsdWU0LTk=\"},{\"Key\":\"S2V5NC0w\",\"Value\":\"VmFsdWU0LTA=\"},{\"Key\":\"S2V5NC0z\",\"Value\":\"VmFsdWU0LTM=\"},{\"Key\":\"S2V5NC01\",\"Value\":\"VmFsdWU0LTU=\"},{\"Key\":\"S2V5NC04\",\"Value\":\"VmFsdWU0LTg=\"},{\"Key\":\"S2V5NC03\",\"Value\":\"VmFsdWU0LTc=\"}]"

ts=2019-03-01T04:16:43.17966Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreNodeSoftRestart completed =========================="

ts=2019-03-01T04:16:43.179756Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreNodeSoftRestartLeader starting =========================="

ts=2019-03-01T04:16:43.179942Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreNodeSoftRestartLeader completed =========================="

ts=2019-03-01T04:16:43.18005Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreNodeStopStart starting =========================="

ts=2019-03-01T04:16:43.180259Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreNodeStopStart completed =========================="

ts=2019-03-01T04:16:43.180412Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreReadWrite starting =========================="

ts=2019-03-01T04:16:43.180515Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case ReadWriteTest ###################"

ts=2019-03-01T04:16:44.087805Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:44.087856Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### ReadWriteTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:16:44.087873Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step ReadWriteTest/0 WriteKvs"

ts=2019-03-01T04:16:44.087889Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action ReadWriteTest: step 0/WriteKvs, iter 0, action 0/WriteKvPattern"

ts=2019-03-01T04:16:44.100754Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:44.101314Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:44.103512Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:44.103961Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:44.286123Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step ReadWriteTest/1 VerifyKvs"

ts=2019-03-01T04:16:44.286169Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action ReadWriteTest: step 1/VerifyKvs, iter 0, action 0/VerifyKvPattern"

ts=2019-03-01T04:16:44.287694Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MC01\",\"Value\":\"VmFsdWUwLTU=\"},{\"Key\":\"S2V5MC03\",\"Value\":\"VmFsdWUwLTc=\"},{\"Key\":\"S2V5MC0z\",\"Value\":\"VmFsdWUwLTM=\"},{\"Key\":\"S2V5MC02\",\"Value\":\"VmFsdWUwLTY=\"},{\"Key\":\"S2V5MC05\",\"Value\":\"VmFsdWUwLTk=\"},{\"Key\":\"S2V5MC0y\",\"Value\":\"VmFsdWUwLTI=\"},{\"Key\":\"S2V5MC0w\",\"Value\":\"VmFsdWUwLTA=\"},{\"Key\":\"S2V5MC0x\",\"Value\":\"VmFsdWUwLTE=\"},{\"Key\":\"S2V5MC00\",\"Value\":\"VmFsdWUwLTQ=\"},{\"Key\":\"S2V5MC04\",\"Value\":\"VmFsdWUwLTg=\"}]"

ts=2019-03-01T04:16:44.288976Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MS02\",\"Value\":\"VmFsdWUxLTY=\"},{\"Key\":\"S2V5MS0w\",\"Value\":\"VmFsdWUxLTA=\"},{\"Key\":\"S2V5MS0z\",\"Value\":\"VmFsdWUxLTM=\"},{\"Key\":\"S2V5MS03\",\"Value\":\"VmFsdWUxLTc=\"},{\"Key\":\"S2V5MS04\",\"Value\":\"VmFsdWUxLTg=\"},{\"Key\":\"S2V5MS0x\",\"Value\":\"VmFsdWUxLTE=\"},{\"Key\":\"S2V5MS0y\",\"Value\":\"VmFsdWUxLTI=\"},{\"Key\":\"S2V5MS00\",\"Value\":\"VmFsdWUxLTQ=\"},{\"Key\":\"S2V5MS01\",\"Value\":\"VmFsdWUxLTU=\"},{\"Key\":\"S2V5MS05\",\"Value\":\"VmFsdWUxLTk=\"}]"

ts=2019-03-01T04:16:44.290308Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5Mi0x\",\"Value\":\"VmFsdWUyLTE=\"},{\"Key\":\"S2V5Mi01\",\"Value\":\"VmFsdWUyLTU=\"},{\"Key\":\"S2V5Mi05\",\"Value\":\"VmFsdWUyLTk=\"},{\"Key\":\"S2V5Mi0y\",\"Value\":\"VmFsdWUyLTI=\"},{\"Key\":\"S2V5Mi0z\",\"Value\":\"VmFsdWUyLTM=\"},{\"Key\":\"S2V5Mi00\",\"Value\":\"VmFsdWUyLTQ=\"},{\"Key\":\"S2V5Mi04\",\"Value\":\"VmFsdWUyLTg=\"},{\"Key\":\"S2V5Mi02\",\"Value\":\"VmFsdWUyLTY=\"},{\"Key\":\"S2V5Mi0w\",\"Value\":\"VmFsdWUyLTA=\"},{\"Key\":\"S2V5Mi03\",\"Value\":\"VmFsdWUyLTc=\"}]"

ts=2019-03-01T04:16:44.29139Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5My0z\",\"Value\":\"VmFsdWUzLTM=\"},{\"Key\":\"S2V5My05\",\"Value\":\"VmFsdWUzLTk=\"},{\"Key\":\"S2V5My0w\",\"Value\":\"VmFsdWUzLTA=\"},{\"Key\":\"S2V5My01\",\"Value\":\"VmFsdWUzLTU=\"},{\"Key\":\"S2V5My02\",\"Value\":\"VmFsdWUzLTY=\"},{\"Key\":\"S2V5My03\",\"Value\":\"VmFsdWUzLTc=\"},{\"Key\":\"S2V5My0x\",\"Value\":\"VmFsdWUzLTE=\"},{\"Key\":\"S2V5My00\",\"Value\":\"VmFsdWUzLTQ=\"},{\"Key\":\"S2V5My0y\",\"Value\":\"VmFsdWUzLTI=\"},{\"Key\":\"S2V5My04\",\"Value\":\"VmFsdWUzLTg=\"}]"

ts=2019-03-01T04:16:44.292476Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5NC0w\",\"Value\":\"VmFsdWU0LTA=\"},{\"Key\":\"S2V5NC0y\",\"Value\":\"VmFsdWU0LTI=\"},{\"Key\":\"S2V5NC0z\",\"Value\":\"VmFsdWU0LTM=\"},{\"Key\":\"S2V5NC0x\",\"Value\":\"VmFsdWU0LTE=\"},{\"Key\":\"S2V5NC00\",\"Value\":\"VmFsdWU0LTQ=\"},{\"Key\":\"S2V5NC01\",\"Value\":\"VmFsdWU0LTU=\"},{\"Key\":\"S2V5NC03\",\"Value\":\"VmFsdWU0LTc=\"},{\"Key\":\"S2V5NC02\",\"Value\":\"VmFsdWU0LTY=\"},{\"Key\":\"S2V5NC04\",\"Value\":\"VmFsdWU0LTg=\"},{\"Key\":\"S2V5NC05\",\"Value\":\"VmFsdWU0LTk=\"}]"

ts=2019-03-01T04:16:44.29263Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreReadWrite completed =========================="

ts=2019-03-01T04:16:44.292754Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestKstoreStoppedNodeRecovery starting =========================="

ts=2019-03-01T04:16:44.292857Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case StoppedNodeRecovery ###################"

ts=2019-03-01T04:16:45.19602Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:45.196097Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### StoppedNodeRecovery: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:16:45.196158Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step StoppedNodeRecovery/0 NodeStop1"

ts=2019-03-01T04:16:45.196229Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 0/NodeStop1, iter 0, action 0/StopAnyNode"

ts=2019-03-01T04:16:45.19635Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-0 Stopping election loop"

ts=2019-03-01T04:16:45.196401Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-0 Leader election is stopped"

ts=2019-03-01T04:16:45.196397Z module=Default pid=20890 caller=node.go:277 level=warn msg="dnode-0 Stopping leader loop"

ts=2019-03-01T04:16:45.198708Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-0 Stopping rebalance loop"

ts=2019-03-01T04:16:45.199959Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-0:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:45.210812Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-0 Stopping rebalance loop"

ts=2019-03-01T04:16:45.21083Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-2 Received leader election event: &{Type:Changed Leader:dnode-4}"

ts=2019-03-01T04:16:45.210819Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Elected Leader:dnode-4}"

ts=2019-03-01T04:16:45.210905Z module=Default pid=20890 caller=node.go:213 level=info msg="dnode-4 is becoming leader"

ts=2019-03-01T04:16:45.210912Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-0 at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:45.210951Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:45.211Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:45.211039Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:45.211151Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:45.21134Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:45.211648Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 0/NodeStop1, iter 0, action 1/Sleep"

ts=2019-03-01T04:16:45.21171Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="tstore New leader dnode-4 is resuming from cluster state: map[dnode-1:0xc0058488a0 dnode-2:0xc005848900 dnode-3:0xc005848960 dnode-4:0xc0058489c0 dnode-0:0xc005848840]"

ts=2019-03-01T04:16:45.21196Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="tstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc00630dc00 0xc00630dce0 0xc00630ddc0 0xc00630dea0]}"

ts=2019-03-01T04:16:45.211983Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-4}"

ts=2019-03-01T04:16:45.212002Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Changed Leader:dnode-4}"

ts=2019-03-01T04:16:45.212008Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:45.212055Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 31 on node dnode-2 as primary for shard 1"

ts=2019-03-01T04:16:45.212094Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-4 msg="Service metanode-dnode-4 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:45.212689Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-4 msg="Client metanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:45.213332Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:45.213401Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:45.213421Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:45.216203Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 29 on node dnode-1 as primary for shard 5"

ts=2019-03-01T04:16:45.216246Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-4 msg="Service metanode-dnode-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:45.216604Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-4 msg="Client metanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:45.216883Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:45.21692Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:45.216935Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:45.219098Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:45.221198Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:45.223044Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:45.224794Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:45.226514Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="kstore New leader dnode-4 is resuming from cluster state: map[dnode-0:0xc004ab1560 dnode-1:0xc004ab15c0 dnode-2:0xc004ab1620 dnode-3:0xc004ab1680 dnode-4:0xc004ab16e0]"

ts=2019-03-01T04:16:45.226598Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="kstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc00495b500 0xc00495b5e0 0xc00495b6c0 0xc00495b7a0]}"

ts=2019-03-01T04:16:45.226613Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:45.226654Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 30 on node dnode-2 as primary for shard 4"

ts=2019-03-01T04:16:45.226717Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-4 msg="Service metanode-dnode-4 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:45.227126Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-4 msg="Client metanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:45.227351Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:45.227386Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:45.227399Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:45.231265Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:45.233107Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:45.235115Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:45.23706Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:45.238975Z module=Default pid=20890 caller=node.go:272 level=info msg="dnode-4 leader started watching node events"

ts=2019-03-01T04:16:45.239017Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-4 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:45.23904Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:45.240934Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:45.242693Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-4 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:45.24272Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:45.24451Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:45.246383Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-4 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:45.246409Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:45.248094Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:45.249942Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-4 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:45.249971Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:45.252028Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:45.316079Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step StoppedNodeRecovery/1 WriteKvs"

ts=2019-03-01T04:16:45.316207Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 1/WriteKvs, iter 0, action 0/WriteKvPattern"

ts=2019-03-01T04:16:45.328088Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-1 msg="Service broker-broker-1 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:45.328657Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-1 msg="Client broker-broker-1 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:45.331735Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-1 msg="Service broker-broker-1 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:45.332112Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-1 msg="Client broker-broker-1 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:45.353117Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-1 msg="Service broker-broker-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:45.353496Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-1 msg="Client broker-broker-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:45.500854Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step StoppedNodeRecovery/2 StartAllNodes1"

ts=2019-03-01T04:16:45.500896Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 2/StartAllNodes1, iter 0, action 0/StartAllNodes"

ts=2019-03-01T04:16:45.502104Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7400, TLS: false"

ts=2019-03-01T04:16:45.503144Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:214 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0048d1240 NodeMap:map[dnode-2:0xc0043e9860 dnode-3:0xc0043e98c0 dnode-4:0xc0043e9920 dnode-0:0xc0043e97a0 dnode-1:0xc0043e9800] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:45.503254Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="created query aggregator with db /tmp/citadel/qstore/0"

ts=2019-03-01T04:16:45.50348Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:209 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0048d15c0 NodeMap:map[dnode-0:0xc0043e9a40 dnode-1:0xc0043e9aa0 dnode-2:0xc0043e9b00 dnode-3:0xc0043e9b60 dnode-4:0xc0043e9bc0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:45.503856Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Restored tstore replica 6 shard 1"

ts=2019-03-01T04:16:45.504035Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Restored tstore replica 10 shard 5"

ts=2019-03-01T04:16:45.504321Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Restored kstore replica 27 shard 1"

ts=2019-03-01T04:16:45.504461Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Restored kstore replica 11 shard 4"

ts=2019-03-01T04:16:45.504516Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Datanode RPC server is listening on: 127.0.0.1:7400"

ts=2019-03-01T04:16:45.504561Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 2/StartAllNodes1, iter 0, action 1/Sleep"

ts=2019-03-01T04:16:45.504568Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:45.50467Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:45.505083Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:214 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0043d1b00 NodeMap:map[dnode-1:0xc00275e480 dnode-2:0xc00275e4e0 dnode-3:0xc00275e540 dnode-4:0xc00275e5a0 dnode-0:0xc00275e420] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:45.505157Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-4 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:45.505183Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:45.505356Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:209 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0044e0300 NodeMap:map[dnode-3:0xc0046dbda0 dnode-4:0xc0046dbe00 dnode-0:0xc0046dbc80 dnode-1:0xc0046dbce0 dnode-2:0xc0046dbd40] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:45.507473Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 29 on node dnode-1 to secondary 10 on node dnode-0"

ts=2019-03-01T04:16:45.50749Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Changed Leader:dnode-4}"

ts=2019-03-01T04:16:45.507816Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:45.507898Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:45.50824Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:45.508466Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 ChunkMeta:\"\\010\\000\\020\\006\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:45.509166Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:45.510254Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 31 on node dnode-2 to secondary 6 on node dnode-0"

ts=2019-03-01T04:16:45.510608Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:45.510708Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:45.511088Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:45.511352Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 ChunkMeta:\"\\010\\000\\020\\006\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:45.512031Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:45.515031Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:45.517122Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 30 on node dnode-2 to secondary 11 on node dnode-0"

ts=2019-03-01T04:16:45.517379Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:45.517453Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:45.51778Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:45.518026Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:45.518284Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:45.518294Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Syncing data from replica 30 chunk 4 len: 24576"

ts=2019-03-01T04:16:45.518578Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:45.520544Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 15 on node dnode-4 to secondary 27 on node dnode-0"

ts=2019-03-01T04:16:45.520568Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-4 msg="Service metanode-dnode-4 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:45.520828Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-4 msg="Client metanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:45.521043Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:45.521104Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:45.521417Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:45.521661Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:45.521911Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:45.521932Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 15 chunk 1 len: 24576"

ts=2019-03-01T04:16:45.522078Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:16:45.607152Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 2/StartAllNodes1, iter 0, action 2/VerifyConverged"

ts=2019-03-01T04:16:46.51157Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:46.511622Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step StoppedNodeRecovery/3 NodeStop2"

ts=2019-03-01T04:16:46.511644Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 3/NodeStop2, iter 0, action 0/StopAnyNode"

ts=2019-03-01T04:16:46.511698Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-0 Stopping election loop"

ts=2019-03-01T04:16:46.511722Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-0 Leader election is stopped"

ts=2019-03-01T04:16:46.511744Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-0 at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:46.51187Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:46.511924Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-4 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}."

ts=2019-03-01T04:16:46.51194Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:46.512038Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:218 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0055c08c0 NodeMap:map[dnode-2:0xc005848900 dnode-3:0xc005848960 dnode-4:0xc0058489c0 dnode-0:0xc005848840 dnode-1:0xc0058488a0] mclient:0xc0004321c0}"

ts=2019-03-01T04:16:46.512082Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:46.512084Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:46.512408Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:46.512579Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:46.512793Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 3/NodeStop2, iter 0, action 1/Sleep"

ts=2019-03-01T04:16:46.519082Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:213 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0047b8080 NodeMap:map[dnode-3:0xc004ab1680 dnode-4:0xc004ab16e0 dnode-0:0xc004ab1560 dnode-1:0xc004ab15c0 dnode-2:0xc004ab1620] mclient:0xc000128000}"

ts=2019-03-01T04:16:46.519109Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:46.52358Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-0:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:46.615069Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step StoppedNodeRecovery/4 StartAllNodes2"

ts=2019-03-01T04:16:46.615189Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 4/StartAllNodes2, iter 0, action 0/StartAllNodes"

ts=2019-03-01T04:16:46.6168Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7400, TLS: false"

ts=2019-03-01T04:16:46.618218Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="created query aggregator with db /tmp/citadel/qstore/0"

ts=2019-03-01T04:16:46.61836Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:221 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0066f4bc0 NodeMap:map[dnode-2:0xc0065ba3c0 dnode-3:0xc0065ba420 dnode-4:0xc0065ba480 dnode-0:0xc0065ba300 dnode-1:0xc0065ba360] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:46.619113Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:216 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0066f4f40 NodeMap:map[dnode-0:0xc0065ba5a0 dnode-1:0xc0065ba600 dnode-2:0xc0065ba720 dnode-3:0xc0065ba780 dnode-4:0xc0065ba7e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:46.6192Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Restored tstore replica 6 shard 1"

ts=2019-03-01T04:16:46.619521Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Restored tstore replica 10 shard 5"

ts=2019-03-01T04:16:46.619988Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Restored kstore replica 27 shard 1"

ts=2019-03-01T04:16:46.620229Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Restored kstore replica 11 shard 4"

ts=2019-03-01T04:16:46.620289Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Datanode RPC server is listening on: 127.0.0.1:7400"

ts=2019-03-01T04:16:46.620329Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 4/StartAllNodes2, iter 0, action 1/Sleep"

ts=2019-03-01T04:16:46.62033Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:46.620449Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:46.621219Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:221 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005d5c340 NodeMap:map[dnode-3:0xc0069b6ba0 dnode-4:0xc0069b6c00 dnode-0:0xc0069b6a80 dnode-1:0xc0069b6ae0 dnode-2:0xc0069b6b40] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:46.621365Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-4 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:46.621426Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:46.621615Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:216 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0066f5a80 NodeMap:map[dnode-2:0xc006d52180 dnode-3:0xc006d521e0 dnode-4:0xc006d52240 dnode-0:0xc006d520c0 dnode-1:0xc006d52120] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:46.624829Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 29 on node dnode-1 to secondary 10 on node dnode-0"

ts=2019-03-01T04:16:46.624918Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Changed Leader:dnode-4}"

ts=2019-03-01T04:16:46.625201Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:46.625331Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:46.625738Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:46.626036Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 ChunkMeta:\"\\010\\000\\020\\006\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:46.627132Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:46.628492Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 31 on node dnode-2 to secondary 6 on node dnode-0"

ts=2019-03-01T04:16:46.628737Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:46.628806Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:46.629122Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:46.629375Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 ChunkMeta:\"\\010\\000\\020\\006\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:46.630119Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:46.633988Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:46.636755Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 30 on node dnode-2 to secondary 11 on node dnode-0"

ts=2019-03-01T04:16:46.637023Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:46.637109Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:46.637446Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:46.637684Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:46.638024Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:46.638077Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Syncing data from replica 30 chunk 4 len: 24576"

ts=2019-03-01T04:16:46.63831Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:46.640699Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 15 on node dnode-4 to secondary 27 on node dnode-0"

ts=2019-03-01T04:16:46.640939Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:46.640999Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:46.641366Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:46.641633Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:46.641958Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:46.641985Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="Syncing data from replica 15 chunk 1 len: 24576"

ts=2019-03-01T04:16:46.642179Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:16:46.720661Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 4/StartAllNodes2, iter 0, action 2/VerifyConverged"

ts=2019-03-01T04:16:47.626725Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:47.626784Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step StoppedNodeRecovery/5 VerifyKvs"

ts=2019-03-01T04:16:47.626808Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action StoppedNodeRecovery: step 5/VerifyKvs, iter 0, action 0/VerifyKvPattern"

ts=2019-03-01T04:16:47.626959Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:47.627466Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:47.628411Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:47.62887Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:47.629501Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:47.629827Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:47.630351Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:47.630687Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:47.631645Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MC0y\",\"Value\":\"VmFsdWUwLTI=\"},{\"Key\":\"S2V5MC00\",\"Value\":\"VmFsdWUwLTQ=\"},{\"Key\":\"S2V5MC02\",\"Value\":\"VmFsdWUwLTY=\"},{\"Key\":\"S2V5MC03\",\"Value\":\"VmFsdWUwLTc=\"},{\"Key\":\"S2V5MC0x\",\"Value\":\"VmFsdWUwLTE=\"},{\"Key\":\"S2V5MC0w\",\"Value\":\"VmFsdWUwLTA=\"},{\"Key\":\"S2V5MC0z\",\"Value\":\"VmFsdWUwLTM=\"},{\"Key\":\"S2V5MC05\",\"Value\":\"VmFsdWUwLTk=\"},{\"Key\":\"S2V5MC01\",\"Value\":\"VmFsdWUwLTU=\"},{\"Key\":\"S2V5MC04\",\"Value\":\"VmFsdWUwLTg=\"}]"

ts=2019-03-01T04:16:47.633305Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:47.633686Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:47.634371Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5MS0z\",\"Value\":\"VmFsdWUxLTM=\"},{\"Key\":\"S2V5MS04\",\"Value\":\"VmFsdWUxLTg=\"},{\"Key\":\"S2V5MS00\",\"Value\":\"VmFsdWUxLTQ=\"},{\"Key\":\"S2V5MS01\",\"Value\":\"VmFsdWUxLTU=\"},{\"Key\":\"S2V5MS0x\",\"Value\":\"VmFsdWUxLTE=\"},{\"Key\":\"S2V5MS0y\",\"Value\":\"VmFsdWUxLTI=\"},{\"Key\":\"S2V5MS03\",\"Value\":\"VmFsdWUxLTc=\"},{\"Key\":\"S2V5MS05\",\"Value\":\"VmFsdWUxLTk=\"},{\"Key\":\"S2V5MS0w\",\"Value\":\"VmFsdWUxLTA=\"},{\"Key\":\"S2V5MS02\",\"Value\":\"VmFsdWUxLTY=\"}]"

ts=2019-03-01T04:16:47.635983Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5Mi0y\",\"Value\":\"VmFsdWUyLTI=\"},{\"Key\":\"S2V5Mi0w\",\"Value\":\"VmFsdWUyLTA=\"},{\"Key\":\"S2V5Mi02\",\"Value\":\"VmFsdWUyLTY=\"},{\"Key\":\"S2V5Mi04\",\"Value\":\"VmFsdWUyLTg=\"},{\"Key\":\"S2V5Mi05\",\"Value\":\"VmFsdWUyLTk=\"},{\"Key\":\"S2V5Mi0x\",\"Value\":\"VmFsdWUyLTE=\"},{\"Key\":\"S2V5Mi0z\",\"Value\":\"VmFsdWUyLTM=\"},{\"Key\":\"S2V5Mi03\",\"Value\":\"VmFsdWUyLTc=\"},{\"Key\":\"S2V5Mi00\",\"Value\":\"VmFsdWUyLTQ=\"},{\"Key\":\"S2V5Mi01\",\"Value\":\"VmFsdWUyLTU=\"}]"

ts=2019-03-01T04:16:47.637201Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5My04\",\"Value\":\"VmFsdWUzLTg=\"},{\"Key\":\"S2V5My00\",\"Value\":\"VmFsdWUzLTQ=\"},{\"Key\":\"S2V5My03\",\"Value\":\"VmFsdWUzLTc=\"},{\"Key\":\"S2V5My05\",\"Value\":\"VmFsdWUzLTk=\"},{\"Key\":\"S2V5My0w\",\"Value\":\"VmFsdWUzLTA=\"},{\"Key\":\"S2V5My0y\",\"Value\":\"VmFsdWUzLTI=\"},{\"Key\":\"S2V5My02\",\"Value\":\"VmFsdWUzLTY=\"},{\"Key\":\"S2V5My0x\",\"Value\":\"VmFsdWUzLTE=\"},{\"Key\":\"S2V5My0z\",\"Value\":\"VmFsdWUzLTM=\"},{\"Key\":\"S2V5My01\",\"Value\":\"VmFsdWUzLTU=\"}]"

ts=2019-03-01T04:16:47.638481Z module=Default pid=20890 caller=actions_test.go:593 level=info msg="Got list results: [{\"Key\":\"S2V5NC0x\",\"Value\":\"VmFsdWU0LTE=\"},{\"Key\":\"S2V5NC0w\",\"Value\":\"VmFsdWU0LTA=\"},{\"Key\":\"S2V5NC00\",\"Value\":\"VmFsdWU0LTQ=\"},{\"Key\":\"S2V5NC01\",\"Value\":\"VmFsdWU0LTU=\"},{\"Key\":\"S2V5NC02\",\"Value\":\"VmFsdWU0LTY=\"},{\"Key\":\"S2V5NC03\",\"Value\":\"VmFsdWU0LTc=\"},{\"Key\":\"S2V5NC0y\",\"Value\":\"VmFsdWU0LTI=\"},{\"Key\":\"S2V5NC0z\",\"Value\":\"VmFsdWU0LTM=\"},{\"Key\":\"S2V5NC04\",\"Value\":\"VmFsdWU0LTg=\"},{\"Key\":\"S2V5NC05\",\"Value\":\"VmFsdWU0LTk=\"}]"

ts=2019-03-01T04:16:47.638668Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestKstoreStoppedNodeRecovery completed =========================="

ts=2019-03-01T04:16:47.638774Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreNodeRestartLeaderQuick starting =========================="

ts=2019-03-01T04:16:47.638892Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case NodeRestartLeaderQuickTest ###################"

ts=2019-03-01T04:16:48.543916Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:48.543975Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### NodeRestartLeaderQuickTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:16:48.543999Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartLeaderQuickTest/0 WritePoints"

ts=2019-03-01T04:16:48.54402Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 0/WritePoints, iter 0, action 0/WritePointPatternAsync"

ts=2019-03-01T04:16:48.544062Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartLeaderQuickTest/1 NodeRestartQuickLeader"

ts=2019-03-01T04:16:48.544091Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 0, action 0/RestartQuickLeaderNode"

ts=2019-03-01T04:16:48.544121Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-4"

ts=2019-03-01T04:16:48.544183Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-4 Stopping election loop"

ts=2019-03-01T04:16:48.544222Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-4 Leader election is stopped"

ts=2019-03-01T04:16:48.544207Z module=Default pid=20890 caller=node.go:277 level=warn msg="dnode-4 Stopping leader loop"

ts=2019-03-01T04:16:48.555369Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-4:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:48.555394Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-4 Stopping rebalance loop"

ts=2019-03-01T04:16:48.566513Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Elected Leader:dnode-1}"

ts=2019-03-01T04:16:48.566567Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:48.566596Z module=Default pid=20890 caller=node.go:213 level=info msg="dnode-1 is becoming leader"

ts=2019-03-01T04:16:48.566524Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-4 Stopping rebalance loop"

ts=2019-03-01T04:16:48.566744Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-4 at Path /venice/citadel/nodes/dnode-4"

ts=2019-03-01T04:16:48.566622Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-2 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:48.567473Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="tstore New leader dnode-1 is resuming from cluster state: map[dnode-4:0xc00596f6e0 dnode-0:0xc00596f560 dnode-1:0xc00596f5c0 dnode-2:0xc00596f620 dnode-3:0xc00596f680]"

ts=2019-03-01T04:16:48.567629Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:48.567691Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:48.567715Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:48.567749Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:48.567888Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:48.568004Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7404"

ts=2019-03-01T04:16:48.568016Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="tstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc00611cd20 0xc00611ce00 0xc00611cee0 0xc00611cfc0]}"

ts=2019-03-01T04:16:48.568121Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-4 unreachable"

ts=2019-03-01T04:16:48.568167Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 25 on node dnode-3 as primary for shard 4"

ts=2019-03-01T04:16:48.568219Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:48.568855Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:48.569432Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:25 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:25 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:48.569499Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:25 ShardID:4 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:25 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:48.569533Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:48.570162Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7404, TLS: false"

ts=2019-03-01T04:16:48.571261Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="created query aggregator with db /tmp/citadel/qstore/4"

ts=2019-03-01T04:16:48.572635Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 27 on node dnode-1 as primary for shard 2"

ts=2019-03-01T04:16:48.572676Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:48.573145Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:48.573469Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:226 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0059380c0 NodeMap:map[dnode-2:0xc00449bb00 dnode-3:0xc00449bb60 dnode-4:0xc00449bbc0 dnode-0:0xc00449ba40 dnode-1:0xc00449baa0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:48.573547Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:48.573588Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:48.573613Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:48.573909Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="Restored tstore replica 7 shard 2"

ts=2019-03-01T04:16:48.573922Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:220 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00772a5c0 NodeMap:map[dnode-0:0xc005bf6660 dnode-1:0xc005bf66c0 dnode-2:0xc005bf6720 dnode-3:0xc005bf6780 dnode-4:0xc005bf67e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:48.574192Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="Restored tstore replica 17 shard 4"

ts=2019-03-01T04:16:48.576326Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:48.576656Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="Restored kstore replica 15 shard 1"

ts=2019-03-01T04:16:48.576776Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="Restored kstore replica 5 shard 5"

ts=2019-03-01T04:16:48.576818Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="Datanode RPC server is listening on: 127.0.0.1:7404"

ts=2019-03-01T04:16:48.576859Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 0, action 1/Sleep"

ts=2019-03-01T04:16:48.576853Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7404"

ts=2019-03-01T04:16:48.576954Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} at Path /venice/citadel/nodes/dnode-4"

ts=2019-03-01T04:16:48.57888Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:48.579352Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:228 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0046adb80 NodeMap:map[dnode-0:0xc006794660 dnode-1:0xc0067946c0 dnode-2:0xc006794720 dnode-3:0xc006794780 dnode-4:0xc0067947e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:48.581503Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:48.581687Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:220 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004a3d000 NodeMap:map[dnode-3:0xc00417e4e0 dnode-4:0xc00417e540 dnode-0:0xc00417e3c0 dnode-1:0xc00417e420 dnode-2:0xc00417e480] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:48.583753Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:48.583821Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:48.585869Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="kstore New leader dnode-1 is resuming from cluster state: map[dnode-1:0xc001a7cd80 dnode-2:0xc001a7cde0 dnode-3:0xc001a7ce40 dnode-4:0xc001a7cea0 dnode-0:0xc001a7cd20]"

ts=2019-03-01T04:16:48.585962Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="kstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc004cb9a40 0xc004cb9b20 0xc004cb9c00 0xc004cb9ce0 0xc004cb9dc0]}"

ts=2019-03-01T04:16:48.585985Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:48.588193Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:48.590375Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:48.592517Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:48.594687Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:48.596814Z module=Default pid=20890 caller=node.go:272 level=info msg="dnode-1 leader started watching node events"

ts=2019-03-01T04:16:48.596852Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:48.59687Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:48.598828Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:48.600901Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:48.600924Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:48.602883Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:48.605025Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:48.605049Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:48.606901Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:48.608953Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:48.608973Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:48.610879Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:48.612973Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:48.612995Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:48.614985Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 25 on node dnode-3 to secondary 17 on node dnode-4"

ts=2019-03-01T04:16:48.615365Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:25 DestReplicaID:17 ShardID:4 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:25 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:48.61547Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:48.615929Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:48.616175Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:25 DestReplicaID:17 ShardID:4 ChunkMeta:\"\\010\\000\\020\\010\\030\\324\\343\\221\\236\\230\\376\\327\\3340*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:48.617828Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 27 on node dnode-1 to secondary 7 on node dnode-4"

ts=2019-03-01T04:16:48.617812Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:48.618065Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:27 DestReplicaID:7 ShardID:2 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:48.61817Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:48.618506Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:48.618738Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:27 DestReplicaID:7 ShardID:2 ChunkMeta:\"\\010\\000\\020\\010\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:48.61955Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:48.622239Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:48.624323Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-1 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}."

ts=2019-03-01T04:16:48.624358Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:239 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc007656000 NodeMap:map[dnode-0:0xc00596f560 dnode-1:0xc00596f5c0 dnode-2:0xc00596f620 dnode-3:0xc00596f680 dnode-4:0xc00596f6e0] mclient:0xc000128540}"

ts=2019-03-01T04:16:48.62437Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-4 unreachable"

ts=2019-03-01T04:16:48.63Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:230 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0044c9e40 NodeMap:map[dnode-0:0xc001a7cd20 dnode-1:0xc001a7cd80 dnode-2:0xc001a7cde0 dnode-3:0xc001a7ce40 dnode-4:0xc001a7cea0] mclient:0xc000432380}"

ts=2019-03-01T04:16:48.630017Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-4 unreachable"

ts=2019-03-01T04:16:48.630029Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 27 on node dnode-0 as primary for shard 1"

ts=2019-03-01T04:16:48.63005Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:48.630353Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:48.630627Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:48.630667Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:48.630683Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:48.633003Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 26 on node dnode-1 as primary for shard 5"

ts=2019-03-01T04:16:48.633027Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:48.633277Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:48.63351Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:48.633544Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:48.633557Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:48.637933Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:48.637961Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:48.639886Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 25 on node dnode-3 to secondary 17 on node dnode-4"

ts=2019-03-01T04:16:48.640138Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:25 DestReplicaID:17 ShardID:4 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:25 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:48.64023Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:48.640603Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:48.640856Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:25 DestReplicaID:17 ShardID:4 ChunkMeta:\"\\010\\000\\020\\010\\030\\324\\343\\221\\236\\230\\376\\327\\3340*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:48.641737Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:48.642626Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 27 on node dnode-1 to secondary 7 on node dnode-4"

ts=2019-03-01T04:16:48.642823Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:27 DestReplicaID:7 ShardID:2 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:48.642923Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:48.643254Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:48.643521Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:27 DestReplicaID:7 ShardID:2 ChunkMeta:\"\\010\\000\\020\\010\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:48.644268Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:48.646956Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:48.649183Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 27 on node dnode-0 to secondary 15 on node dnode-4"

ts=2019-03-01T04:16:48.64944Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:27 DestReplicaID:15 ShardID:1 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:48.649514Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:48.649852Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:48.650113Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:27 DestReplicaID:15 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:48.650362Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:48.650445Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="Syncing data from replica 27 chunk 1 len: 24576"

ts=2019-03-01T04:16:48.650701Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:16:48.652452Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 26 on node dnode-1 to secondary 5 on node dnode-4"

ts=2019-03-01T04:16:48.652675Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:26 DestReplicaID:5 ShardID:5 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:48.652731Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:48.653043Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:48.653403Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:26 DestReplicaID:5 ShardID:5 Chunks:<ChunkID:5 Database:\"default\" > "

ts=2019-03-01T04:16:48.653655Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="Syncing data from replica 26 chunk 5 len: 24576"

ts=2019-03-01T04:16:48.653648Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:16:48.653809Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Restoring kstore Chunk 5 on shard 5"

ts=2019-03-01T04:16:48.682083Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 0, action 2/VerifyConverged"

ts=2019-03-01T04:16:49.046137Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:16:49.046923Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestKstoreStoppedNodeRecovery brokeruuid=broker-0 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:16:49.046958Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-0, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:16:49.148259Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:16:49.148687Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow brokeruuid=broker-1 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3, Node: dnode-1"

ts=2019-03-01T04:16:49.148739Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-1, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:16:49.252119Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-2 msg="Service broker-broker-2 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:49.252678Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-2 msg="Client broker-broker-2 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:49.253247Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:16:49.253658Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestKstoreNodeSoftRestart brokeruuid=broker-2 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:16:49.253705Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-2, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:16:49.356507Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-3 msg="Service broker-broker-3 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:49.356981Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-3 msg="Client broker-broker-3 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:49.357445Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:16:49.357816Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestKstoreNodeSoftRestart brokeruuid=broker-3 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-1"

ts=2019-03-01T04:16:49.357848Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-3, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:16:49.462387Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-4 msg="Service broker-broker-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:49.462962Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-4 msg="Client broker-broker-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:49.463542Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:16:49.463985Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-4 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3, Node: dnode-1"

ts=2019-03-01T04:16:49.464031Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-4, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:16:49.588804Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:49.588866Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 1, action 0/RestartQuickLeaderNode"

ts=2019-03-01T04:16:49.588904Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-1"

ts=2019-03-01T04:16:49.588977Z module=Default pid=20890 caller=node.go:277 level=warn msg="dnode-1 Stopping leader loop"

ts=2019-03-01T04:16:49.588998Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-1 Stopping election loop"

ts=2019-03-01T04:16:49.589054Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-1 Leader election is stopped"

ts=2019-03-01T04:16:49.595241Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-1:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:49.59525Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-1 Stopping rebalance loop"

ts=2019-03-01T04:16:49.607888Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-2 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:49.607888Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Elected Leader:dnode-0}"

ts=2019-03-01T04:16:49.607986Z module=Default pid=20890 caller=node.go:213 level=info msg="dnode-0 is becoming leader"

ts=2019-03-01T04:16:49.607888Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:49.607905Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:49.6079Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-1 Stopping rebalance loop"

ts=2019-03-01T04:16:49.608118Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-1 at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:49.608538Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="tstore New leader dnode-0 is resuming from cluster state: map[dnode-0:0xc0073ef7a0 dnode-1:0xc0073ef800 dnode-2:0xc0073ef860 dnode-3:0xc0073ef8c0 dnode-4:0xc0073ef920]"

ts=2019-03-01T04:16:49.60867Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:49.608743Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:49.608787Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:49.608904Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:49.608907Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="tstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc0073b4000 0xc0073b40e0 0xc0073b41c0 0xc0073b42a0]}"

ts=2019-03-01T04:16:49.608947Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:49.608981Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 7 on node dnode-4 as primary for shard 2"

ts=2019-03-01T04:16:49.608981Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:49.609013Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:49.609641Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:49.61011Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:49.610171Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:49.610204Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:49.610914Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7401, TLS: false"

ts=2019-03-01T04:16:49.612105Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:16:49.614372Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 10 on node dnode-0 as primary for shard 5"

ts=2019-03-01T04:16:49.614436Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:49.614857Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:49.615231Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:49.615233Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:247 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00748b080 NodeMap:map[dnode-0:0xc004a7b920 dnode-1:0xc004a7b980 dnode-2:0xc004a7b9e0 dnode-3:0xc004a7ba40 dnode-4:0xc004a7baa0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:49.615285Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:49.615303Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:49.615771Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 27 shard 2"

ts=2019-03-01T04:16:49.615765Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:237 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0025f2000 NodeMap:map[dnode-0:0xc00154a000 dnode-1:0xc00154a060 dnode-2:0xc00154a0c0 dnode-3:0xc00154a120 dnode-4:0xc00154a180] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:49.616138Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 29 shard 5"

ts=2019-03-01T04:16:49.618045Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:49.618304Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 25 shard 3"

ts=2019-03-01T04:16:49.618414Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 26 shard 5"

ts=2019-03-01T04:16:49.618451Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:16:49.618477Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 1, action 1/Sleep"

ts=2019-03-01T04:16:49.618474Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:49.618555Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:49.620429Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:49.620999Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:249 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc007656640 NodeMap:map[dnode-3:0xc0069f4600 dnode-4:0xc0069f4660 dnode-0:0xc0069f44e0 dnode-1:0xc0069f4540 dnode-2:0xc0069f45a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:49.623286Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:49.623411Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:237 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00695dd00 NodeMap:map[dnode-1:0xc00682afc0 dnode-2:0xc00682b020 dnode-3:0xc00682b080 dnode-4:0xc00682b0e0 dnode-0:0xc00682af60] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:49.625525Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:49.62775Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="kstore New leader dnode-0 is resuming from cluster state: map[dnode-1:0xc004862960 dnode-2:0xc0048629c0 dnode-3:0xc004862b40 dnode-4:0xc004862ba0 dnode-0:0xc004862900]"

ts=2019-03-01T04:16:49.627775Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:49.627855Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="kstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc006633340 0xc006633420 0xc006633500 0xc0066335e0 0xc0066336c0]}"

ts=2019-03-01T04:16:49.627879Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:49.630047Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:49.632148Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:49.634313Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:49.636515Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:49.63859Z module=Default pid=20890 caller=node.go:272 level=info msg="dnode-0 leader started watching node events"

ts=2019-03-01T04:16:49.638627Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:49.638647Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:49.640641Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:49.642724Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:49.642747Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:49.644625Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:49.646773Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:49.646797Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:49.648767Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:49.650839Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:49.65086Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:49.652718Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 27 on node dnode-1"

ts=2019-03-01T04:16:49.653025Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:27 ShardID:2 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:49.653112Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:49.653465Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:49.653691Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:27 ShardID:2 ChunkMeta:\"\\010\\000\\020\\n\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:49.654486Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:49.655392Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 10 on node dnode-0 to secondary 29 on node dnode-1"

ts=2019-03-01T04:16:49.655604Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:29 ShardID:5 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:49.655693Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:49.655989Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:49.656227Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:29 ShardID:5 ChunkMeta:\"\\010\\000\\020\\010\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:49.65707Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:49.659876Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:49.661977Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:49.662Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:49.663826Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:49.666113Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-0 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}."

ts=2019-03-01T04:16:49.66616Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:260 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00748a0c0 NodeMap:map[dnode-1:0xc0073ef800 dnode-2:0xc0073ef860 dnode-3:0xc0073ef8c0 dnode-4:0xc0073ef920 dnode-0:0xc0073ef7a0] mclient:0xc000432540}"

ts=2019-03-01T04:16:49.666186Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:49.672161Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:247 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0057abcc0 NodeMap:map[dnode-0:0xc004862900 dnode-1:0xc004862960 dnode-2:0xc0048629c0 dnode-3:0xc004862b40 dnode-4:0xc004862ba0] mclient:0xc000432000}"

ts=2019-03-01T04:16:49.672189Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:49.672213Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 28 on node dnode-3 as primary for shard 3"

ts=2019-03-01T04:16:49.672228Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:49.672532Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:49.672807Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:28 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:49.672846Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:28 ShardID:3 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:49.672862Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:49.675218Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 5 on node dnode-4 as primary for shard 5"

ts=2019-03-01T04:16:49.675241Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:49.675493Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:49.675707Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:49.675736Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:49.67575Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:49.680254Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:49.68029Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:49.682507Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 10 on node dnode-0 to secondary 29 on node dnode-1"

ts=2019-03-01T04:16:49.682847Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:29 ShardID:5 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:49.682942Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:49.683338Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:49.683613Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:29 ShardID:5 ChunkMeta:\"\\010\\000\\020\\010\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:49.684438Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:49.685401Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 27 on node dnode-1"

ts=2019-03-01T04:16:49.68562Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:27 ShardID:2 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:49.685706Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:49.68601Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:49.686202Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:27 ShardID:2 ChunkMeta:\"\\010\\000\\020\\n\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:49.686917Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:49.68997Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:49.692049Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 28 on node dnode-3 to secondary 25 on node dnode-1"

ts=2019-03-01T04:16:49.692259Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:28 DestReplicaID:25 ShardID:3 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:25 ShardID:3 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:16:49.692319Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:49.692668Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:49.692942Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:28 DestReplicaID:25 ShardID:3 Chunks:<ChunkID:3 Database:\"default\" > "

ts=2019-03-01T04:16:49.693209Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:49.693256Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Syncing data from replica 28 chunk 3 len: 24576"

ts=2019-03-01T04:16:49.693446Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 3 on shard 3"

ts=2019-03-01T04:16:49.695119Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 5 on node dnode-4 to secondary 26 on node dnode-1"

ts=2019-03-01T04:16:49.695307Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:26 ShardID:5 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:49.695376Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:49.695636Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:49.695818Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:5 DestReplicaID:26 ShardID:5 Chunks:<ChunkID:5 Database:\"default\" > "

ts=2019-03-01T04:16:49.696078Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="Syncing data from replica 5 chunk 5 len: 24576"

ts=2019-03-01T04:16:49.696126Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:49.696264Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Restoring kstore Chunk 5 on shard 5"

ts=2019-03-01T04:16:49.720972Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 1, action 2/VerifyConverged"

ts=2019-03-01T04:16:50.625614Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:50.625684Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 2, action 0/RestartQuickLeaderNode"

ts=2019-03-01T04:16:50.625712Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-0"

ts=2019-03-01T04:16:50.62579Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-0 Stopping election loop"

ts=2019-03-01T04:16:50.62583Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-0 Leader election is stopped"

ts=2019-03-01T04:16:50.625822Z module=Default pid=20890 caller=node.go:277 level=warn msg="dnode-0 Stopping leader loop"

ts=2019-03-01T04:16:50.636025Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-0:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:50.63608Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-0 Stopping rebalance loop"

ts=2019-03-01T04:16:50.64843Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:50.648455Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-2 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:50.648425Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Elected Leader:dnode-1}"

ts=2019-03-01T04:16:50.648432Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:50.648523Z module=Default pid=20890 caller=node.go:213 level=info msg="dnode-1 is becoming leader"

ts=2019-03-01T04:16:50.648569Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-0 Stopping rebalance loop"

ts=2019-03-01T04:16:50.648683Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-0 at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:50.649162Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="tstore New leader dnode-1 is resuming from cluster state: map[dnode-0:0xc006122000 dnode-1:0xc006122060 dnode-2:0xc0061220c0 dnode-3:0xc006122120 dnode-4:0xc006122180]"

ts=2019-03-01T04:16:50.649342Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:50.649413Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:50.649466Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:50.649606Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreStoppedNodeRecovery nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:50.649724Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:50.649748Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="tstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc0004d9ce0 0xc0004d9dc0 0xc0004d9ea0 0xc0040f6000]}"

ts=2019-03-01T04:16:50.649799Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:50.649841Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 29 on node dnode-1 as primary for shard 5"

ts=2019-03-01T04:16:50.64989Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:50.650592Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:50.651299Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:50.651377Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:50.651429Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:50.652065Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7400, TLS: false"

ts=2019-03-01T04:16:50.654038Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="created query aggregator with db /tmp/citadel/qstore/0"

ts=2019-03-01T04:16:50.6556Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:268 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004a0ac00 NodeMap:map[dnode-4:0xc001266060 dnode-0:0xc00631bec0 dnode-1:0xc00631bf20 dnode-2:0xc00631bf80 dnode-3:0xc001266000] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:50.655979Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="Restored tstore replica 6 shard 1"

ts=2019-03-01T04:16:50.656162Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="Restored tstore replica 10 shard 5"

ts=2019-03-01T04:16:50.658135Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:50.658322Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:254 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004af1600 NodeMap:map[dnode-3:0xc0058405a0 dnode-4:0xc005840600 dnode-0:0xc0058403c0 dnode-1:0xc005840480 dnode-2:0xc005840540] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:50.658672Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="Restored kstore replica 27 shard 1"

ts=2019-03-01T04:16:50.658825Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="Restored kstore replica 11 shard 4"

ts=2019-03-01T04:16:50.658868Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="Datanode RPC server is listening on: 127.0.0.1:7400"

ts=2019-03-01T04:16:50.658899Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:50.658916Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 2, action 1/Sleep"

ts=2019-03-01T04:16:50.658966Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:50.661002Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:50.661553Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:270 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005534180 NodeMap:map[dnode-0:0xc006ea1200 dnode-1:0xc006ea1260 dnode-2:0xc006ea12c0 dnode-3:0xc006ea1320 dnode-4:0xc006ea1380] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:50.663648Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:50.663785Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:254 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004470580 NodeMap:map[dnode-4:0xc0073ee8a0 dnode-0:0xc0073ee720 dnode-1:0xc0073ee780 dnode-2:0xc0073ee7e0 dnode-3:0xc0073ee840] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:50.665951Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:50.665992Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:50.668091Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="kstore New leader dnode-1 is resuming from cluster state: map[dnode-1:0xc0044948a0 dnode-2:0xc004494900 dnode-3:0xc004494960 dnode-4:0xc0044949c0 dnode-0:0xc004494840]"

ts=2019-03-01T04:16:50.668192Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="kstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc006bad7a0 0xc006bad880 0xc006bad960 0xc006bada40 0xc006badb20]}"

ts=2019-03-01T04:16:50.668216Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:50.67043Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:50.672536Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:50.674642Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:50.676791Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:50.678976Z module=Default pid=20890 caller=node.go:272 level=info msg="dnode-1 leader started watching node events"

ts=2019-03-01T04:16:50.679021Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:50.679041Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:50.681109Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 29 on node dnode-1 to secondary 10 on node dnode-0"

ts=2019-03-01T04:16:50.681388Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:50.681474Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:50.681882Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:50.682091Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 ChunkMeta:\"\\010\\000\\020\\n\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:50.68285Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:50.684046Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 31 on node dnode-2 to secondary 6 on node dnode-0"

ts=2019-03-01T04:16:50.684093Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:50.684456Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:50.684704Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:50.684781Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:50.685094Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:50.685332Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 ChunkMeta:\"\\010\\000\\020\\006\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:50.686067Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:50.688967Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:50.691062Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:50.691084Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:50.69315Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:50.695298Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:50.695324Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:50.697217Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:50.699307Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:50.699329Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:50.70139Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:50.703584Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:50.703614Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:50.705749Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:50.707617Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-1 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}."

ts=2019-03-01T04:16:50.707651Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:281 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0048c0080 NodeMap:map[dnode-4:0xc006122180 dnode-0:0xc006122000 dnode-1:0xc006122060 dnode-2:0xc0061220c0 dnode-3:0xc006122120] mclient:0xc000128000}"

ts=2019-03-01T04:16:50.707667Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:50.713539Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:264 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0058c4a00 NodeMap:map[dnode-0:0xc004494840 dnode-1:0xc0044948a0 dnode-2:0xc004494900 dnode-3:0xc004494960 dnode-4:0xc0044949c0] mclient:0xc006afe000}"

ts=2019-03-01T04:16:50.713561Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:50.715712Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 15 on node dnode-4 as primary for shard 1"

ts=2019-03-01T04:16:50.715733Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:50.716156Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:50.716428Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:50.716462Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:50.716476Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:50.721789Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:50.721832Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:50.723687Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 29 on node dnode-1 to secondary 10 on node dnode-0"

ts=2019-03-01T04:16:50.7239Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:50.723971Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:50.72432Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:50.724554Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 ChunkMeta:\"\\010\\000\\020\\n\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:50.725323Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:50.726427Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 31 on node dnode-2 to secondary 6 on node dnode-0"

ts=2019-03-01T04:16:50.726624Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:50.726701Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:50.72701Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:50.727247Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 ChunkMeta:\"\\010\\000\\020\\006\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:50.727976Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:50.730781Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:50.732876Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 30 on node dnode-2 to secondary 11 on node dnode-0"

ts=2019-03-01T04:16:50.732897Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:50.733162Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:50.733428Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:50.73348Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:50.733799Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:50.734043Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:50.734265Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:50.734287Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="Syncing data from replica 30 chunk 4 len: 24576"

ts=2019-03-01T04:16:50.734428Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:50.73619Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 15 on node dnode-4 to secondary 27 on node dnode-0"

ts=2019-03-01T04:16:50.736403Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:50.736455Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:50.736858Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:50.737079Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:50.737379Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="Syncing data from replica 15 chunk 1 len: 24576"

ts=2019-03-01T04:16:50.737374Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:50.737534Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:16:50.76099Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 2, action 2/VerifyConverged"

ts=2019-03-01T04:16:51.665762Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:51.665831Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 3, action 0/RestartQuickLeaderNode"

ts=2019-03-01T04:16:51.665863Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-1"

ts=2019-03-01T04:16:51.665967Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-1 Stopping election loop"

ts=2019-03-01T04:16:51.66601Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-1 Leader election is stopped"

ts=2019-03-01T04:16:51.665985Z module=Default pid=20890 caller=node.go:277 level=warn msg="dnode-1 Stopping leader loop"

ts=2019-03-01T04:16:51.672617Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-1 Stopping rebalance loop"

ts=2019-03-01T04:16:51.672623Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-1:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:51.683516Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-1 Stopping rebalance loop"

ts=2019-03-01T04:16:51.683514Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-2}"

ts=2019-03-01T04:16:51.683522Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Changed Leader:dnode-2}"

ts=2019-03-01T04:16:51.683625Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-1 at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:51.683546Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-2 Received leader election event: &{Type:Elected Leader:dnode-2}"

ts=2019-03-01T04:16:51.683601Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Changed Leader:dnode-2}"

ts=2019-03-01T04:16:51.683712Z module=Default pid=20890 caller=node.go:213 level=info msg="dnode-2 is becoming leader"

ts=2019-03-01T04:16:51.683762Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:51.683824Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:51.683871Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:51.684164Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:51.684358Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:51.684401Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="tstore New leader dnode-2 is resuming from cluster state: map[dnode-2:0xc00725d020 dnode-3:0xc00725d080 dnode-4:0xc00725d0e0 dnode-0:0xc00725cf60 dnode-1:0xc00725cfc0]"

ts=2019-03-01T04:16:51.684663Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="tstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc007254700 0xc0072547e0 0xc0072548c0 0xc0072549a0]}"

ts=2019-03-01T04:16:51.684714Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-1 unreachable"

ts=2019-03-01T04:16:51.68683Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7401, TLS: false"

ts=2019-03-01T04:16:51.688045Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:16:51.688768Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 10 on node dnode-0 as primary for shard 5"

ts=2019-03-01T04:16:51.688805Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-2 msg="Service metanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:51.689223Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-2 msg="Client metanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:51.689664Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:289 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006a7b480 NodeMap:map[dnode-0:0xc006a7f320 dnode-1:0xc006a7f380 dnode-2:0xc006a7f3e0 dnode-3:0xc006a7f440 dnode-4:0xc006a7f4a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:51.689775Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:51.689842Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:51.689878Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:51.690145Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:271 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006a7b800 NodeMap:map[dnode-0:0xc006a7f5c0 dnode-1:0xc006a7f620 dnode-2:0xc006a7f680 dnode-3:0xc006a7f6e0 dnode-4:0xc006a7f740] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:51.690161Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 27 shard 2"

ts=2019-03-01T04:16:51.6905Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 29 shard 5"

ts=2019-03-01T04:16:51.692889Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:51.693207Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 25 shard 3"

ts=2019-03-01T04:16:51.693341Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 26 shard 5"

ts=2019-03-01T04:16:51.693387Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:16:51.693434Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 3, action 1/Sleep"

ts=2019-03-01T04:16:51.693418Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:16:51.693519Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401} at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:16:51.695401Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:51.695951Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:291 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006cf97c0 NodeMap:map[dnode-0:0xc00466acc0 dnode-1:0xc00466ad20 dnode-2:0xc00466ad80 dnode-3:0xc00466ade0 dnode-4:0xc00466ae40] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:51.69797Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:51.698131Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:271 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004639f00 NodeMap:map[dnode-4:0xc006257740 dnode-0:0xc0062575c0 dnode-1:0xc006257620 dnode-2:0xc006257680 dnode-3:0xc0062576e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:51.700248Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:51.702507Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="kstore New leader dnode-2 is resuming from cluster state: map[dnode-0:0xc004cdc5a0 dnode-1:0xc004cdc600 dnode-2:0xc004cdc660 dnode-3:0xc004cdc6c0 dnode-4:0xc004cdc720]"

ts=2019-03-01T04:16:51.702539Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Changed Leader:dnode-2}"

ts=2019-03-01T04:16:51.702618Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="kstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc004cd6380 0xc004cd6460 0xc004cd6540 0xc004cd6620 0xc004cd6700]}"

ts=2019-03-01T04:16:51.70264Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:51.704975Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:51.707278Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:51.709624Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:51.711788Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:51.714063Z module=Default pid=20890 caller=node.go:272 level=info msg="dnode-2 leader started watching node events"

ts=2019-03-01T04:16:51.714106Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-2 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:51.714125Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:51.716075Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:51.718207Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-2 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:51.71823Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:51.720332Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:51.722431Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-2 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:51.722453Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:51.724362Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:51.72658Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-2 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:51.726608Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:51.728526Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:51.730794Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-2 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:51.730817Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:51.732691Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 10 on node dnode-0 to secondary 29 on node dnode-1"

ts=2019-03-01T04:16:51.733115Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:29 ShardID:5 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:51.733219Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:51.733665Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:51.733888Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:10 DestReplicaID:29 ShardID:5 ChunkMeta:\"\\010\\000\\020\\014\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:51.73542Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:51.735471Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 7 on node dnode-4 to secondary 27 on node dnode-1"

ts=2019-03-01T04:16:51.735496Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-2 msg="Service metanode-dnode-2 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:51.735766Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-2 msg="Client metanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:51.736043Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:27 ShardID:2 DestNodeUUID:\"dnode-1\" DestNodeURL:\"127.0.0.1:7401\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:16:51.736175Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:51.736473Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:51.736693Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:7 DestReplicaID:27 ShardID:2 ChunkMeta:\"\\010\\000\\020\\n\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:51.737445Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncData req"

ts=2019-03-01T04:16:51.740337Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:51.794209Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 3, action 2/VerifyConverged"

ts=2019-03-01T04:16:52.696343Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:52.696398Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 4, action 0/RestartQuickLeaderNode"

ts=2019-03-01T04:16:52.696423Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-2"

ts=2019-03-01T04:16:52.69649Z module=Default pid=20890 caller=node.go:277 level=warn msg="dnode-2 Stopping leader loop"

ts=2019-03-01T04:16:52.696519Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-2 Stopping election loop"

ts=2019-03-01T04:16:52.696584Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-2 Leader election is stopped"

ts=2019-03-01T04:16:52.707575Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-2 Stopping rebalance loop"

ts=2019-03-01T04:16:52.707579Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-2:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:52.708837Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-2 Stopping rebalance loop"

ts=2019-03-01T04:16:52.7089Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-2 at Path /venice/citadel/nodes/dnode-2"

ts=2019-03-01T04:16:52.709042Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:52.709121Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:52.709188Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:52.709331Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:52.70948Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7402"

ts=2019-03-01T04:16:52.711321Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Elected Leader:dnode-0}"

ts=2019-03-01T04:16:52.711387Z module=Default pid=20890 caller=node.go:213 level=info msg="dnode-0 is becoming leader"

ts=2019-03-01T04:16:52.711494Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7402, TLS: false"

ts=2019-03-01T04:16:52.711767Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="tstore New leader dnode-0 is resuming from cluster state: map[dnode-4:0xc00243b5c0 dnode-0:0xc00243b440 dnode-1:0xc00243b4a0 dnode-2:0xc00243b500 dnode-3:0xc00243b560]"

ts=2019-03-01T04:16:52.712536Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:302 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005498740 NodeMap:map[dnode-0:0xc0059f13e0 dnode-1:0xc0059f1440 dnode-2:0xc0059f14a0 dnode-3:0xc0059f1500 dnode-4:0xc0059f1560] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:52.712671Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="tstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc006a615e0 0xc006a616c0 0xc006a617a0 0xc006a61880]}"

ts=2019-03-01T04:16:52.712713Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-2 unreachable"

ts=2019-03-01T04:16:52.712734Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 6 on node dnode-0 as primary for shard 1"

ts=2019-03-01T04:16:52.712757Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:52.712889Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:281 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005498ac0 NodeMap:map[dnode-3:0xc0059f17a0 dnode-4:0xc0059f1800 dnode-0:0xc0059f1680 dnode-1:0xc0059f16e0 dnode-2:0xc0059f1740] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:52.713353Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="created query aggregator with db /tmp/citadel/qstore/2"

ts=2019-03-01T04:16:52.713375Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:52.7138Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:52.713863Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:52.713896Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:52.713918Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Restored tstore replica 31 shard 1"

ts=2019-03-01T04:16:52.71418Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Restored tstore replica 30 shard 3"

ts=2019-03-01T04:16:52.714549Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Restored kstore replica 29 shard 2"

ts=2019-03-01T04:16:52.714741Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Restored kstore replica 30 shard 4"

ts=2019-03-01T04:16:52.714793Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Datanode RPC server is listening on: 127.0.0.1:7402"

ts=2019-03-01T04:16:52.714846Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 4, action 1/Sleep"

ts=2019-03-01T04:16:52.714862Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7402"

ts=2019-03-01T04:16:52.714951Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402} at Path /venice/citadel/nodes/dnode-2"

ts=2019-03-01T04:16:52.718367Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:303 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0047a5dc0 NodeMap:map[dnode-0:0xc006a83320 dnode-1:0xc006a83380 dnode-2:0xc006a833e0 dnode-3:0xc006a83440 dnode-4:0xc006a834a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:52.718502Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:52.718498Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:52.718498Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:52.720904Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:52.721065Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:281 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00704a840 NodeMap:map[dnode-4:0xc007060600 dnode-0:0xc007060480 dnode-1:0xc0070604e0 dnode-2:0xc007060540 dnode-3:0xc0070605a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:52.723193Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:52.725681Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:52.725719Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-2 Received leader election event: &{Type:Changed Leader:dnode-0}"

ts=2019-03-01T04:16:52.727884Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:52.729969Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="kstore New leader dnode-0 is resuming from cluster state: map[dnode-4:0xc007582cc0 dnode-0:0xc007582b40 dnode-1:0xc007582ba0 dnode-2:0xc007582c00 dnode-3:0xc007582c60]"

ts=2019-03-01T04:16:52.730074Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="kstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc007de2000 0xc007de20e0 0xc007de21c0 0xc007de22a0 0xc007de2380]}"

ts=2019-03-01T04:16:52.730101Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:52.732656Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:52.735303Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:52.737684Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:52.739963Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:52.742724Z module=Default pid=20890 caller=node.go:272 level=info msg="dnode-0 leader started watching node events"

ts=2019-03-01T04:16:52.742772Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:52.742796Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:52.744872Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:52.748369Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:52.748424Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:52.751212Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:52.753309Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:52.753333Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:52.755249Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:52.75765Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:52.757689Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:52.759727Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:52.761924Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-0 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:52.761953Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:52.763809Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 28 on node dnode-3 to secondary 30 on node dnode-2"

ts=2019-03-01T04:16:52.763832Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-0 msg="Service metanode-dnode-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:52.764237Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-0 msg="Client metanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:52.764605Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:28 DestReplicaID:30 ShardID:3 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:28 ShardID:3 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > Replicas:<ClusterType:\"tstore\" ReplicaID:30 ShardID:3 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:52.764689Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:52.765183Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:52.765582Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:28 DestReplicaID:30 ShardID:3 ChunkMeta:\"\\010\\000\\020\\010\\030\\266\\362\\305\\322\\253\\364\\277\\266\\033*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:52.766537Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:52.767735Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 6 on node dnode-0 to secondary 31 on node dnode-2"

ts=2019-03-01T04:16:52.768093Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:31 ShardID:1 DestNodeUUID:\"dnode-2\" DestNodeURL:\"127.0.0.1:7402\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:52.768232Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:52.768558Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:52.768789Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:6 DestReplicaID:31 ShardID:1 ChunkMeta:\"\\010\\000\\020\\010\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:52.769629Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncData req"

ts=2019-03-01T04:16:52.773264Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:52.816838Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 1/NodeRestartQuickLeader, iter 4, action 2/VerifyConverged"

ts=2019-03-01T04:16:53.720435Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:53.720505Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartLeaderQuickTest/2 VerifyPoints"

ts=2019-03-01T04:16:53.720536Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 2/VerifyPoints, iter 0, action 0/VerifyConverged"

ts=2019-03-01T04:16:54.627208Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:54.627265Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 2/VerifyPoints, iter 0, action 1/WaitForTasks"

ts=2019-03-01T04:16:54.627293Z module=Default pid=20890 caller=actions_test.go:390 level=info msg="Waiting 40s for all tasks to complete"

ts=2019-03-01T04:16:54.627313Z module=Default pid=20890 caller=actions_test.go:394 level=info msg="All waitgroups finished"

ts=2019-03-01T04:16:54.627327Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartLeaderQuickTest: step 2/VerifyPoints, iter 0, action 2/VerifyPointPattern"

ts=2019-03-01T04:16:54.627573Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:54.628063Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:54.629479Z module=Default pid=20890 caller=actions_test.go:485 level=info msg="Got query results: [{\"statement_id\":0}]"

ts=2019-03-01T04:16:54.631026Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreNodeRestartLeaderQuick completed =========================="



----------------------------------------------------------------------

FAIL: tstore_test.go:443: integTestSuite.TestTstoreNodeRestartLeaderQuick



/Users/ranjith/gopath/src/github.com/pensando/sw/venice/utils/testutils/testutils.go:55:

    tb.Fatalf("\033[31m%s:%d: %s. unexpected error: %s\033[39m\n\n", filepath.Base(file), line, msg, err.Error())

... Error: [31mactions_test.go:446: NodeRestartLeaderQuickTest: step 0/WritePoints, iter 0, action 0/WritePointPatternAsync: Error writing points. unexpected error: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3[39m







tstore_test.go:503:

    it.runTestCase(c, &nodeRestartLeaderQuickCase)

/Users/ranjith/gopath/src/github.com/pensando/sw/venice/utils/testutils/testutils.go:46:

    tb.Fatalf("\033[31m%s:%d: "+msg+"\033[39m\n\n", append([]interface{}{filepath.Base(file), line}, v...)...)

... Error: [31mactions_test.go:487: NodeRestartLeaderQuickTest: step 2/VerifyPoints, iter 0, action 2/VerifyPointPattern: Invalid query result[39m



%!(EXTRA []*query.Result=[0xc004aa22d0])



ts=2019-03-01T04:16:54.631153Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreNodeRestartLeaderSlow starting =========================="

ts=2019-03-01T04:16:54.631429Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreNodeRestartLeaderSlow completed =========================="

ts=2019-03-01T04:16:54.631555Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreNodeRestartQuick starting =========================="

ts=2019-03-01T04:16:54.631739Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreNodeRestartQuick completed =========================="

ts=2019-03-01T04:16:54.631841Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreNodeRestartQuickWriteLoss starting =========================="

ts=2019-03-01T04:16:54.631956Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case NodeRestartQuickWriteLossTest ###################"

ts=2019-03-01T04:16:55.535442Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:55.535499Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### NodeRestartQuickWriteLossTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:16:55.535526Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartQuickWriteLossTest/0 WritePoints"

ts=2019-03-01T04:16:55.535551Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 0/WritePoints, iter 0, action 0/WritePointPatternAsync"

ts=2019-03-01T04:16:55.535578Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartQuickWriteLossTest/1 NodeRestartQuick"

ts=2019-03-01T04:16:55.535593Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 0, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:16:55.535616Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-0"

ts=2019-03-01T04:16:55.535689Z module=Default pid=20890 caller=node.go:277 level=warn msg="dnode-0 Stopping leader loop"

ts=2019-03-01T04:16:55.535724Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-0 Stopping election loop"

ts=2019-03-01T04:16:55.535775Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-0 Leader election is stopped"

ts=2019-03-01T04:16:55.539281Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-0:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:55.539743Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-0 Stopping rebalance loop"

ts=2019-03-01T04:16:55.550473Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:55.550482Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-0 Stopping rebalance loop"

ts=2019-03-01T04:16:55.550486Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-3 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:55.550478Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-1 Received leader election event: &{Type:Elected Leader:dnode-1}"

ts=2019-03-01T04:16:55.550551Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-0 at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:55.55056Z module=Default pid=20890 caller=node.go:213 level=info msg="dnode-1 is becoming leader"

ts=2019-03-01T04:16:55.550488Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-2 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:55.550685Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:55.550729Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:55.550764Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:55.550844Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:55.550906Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:55.551113Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="tstore New leader dnode-1 is resuming from cluster state: map[dnode-4:0xc00625da40 dnode-0:0xc00625d8c0 dnode-1:0xc00625d920 dnode-2:0xc00625d980 dnode-3:0xc00625d9e0]"

ts=2019-03-01T04:16:55.551327Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="tstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc0060687e0 0xc0060689a0 0xc006068a80 0xc006068b60]}"

ts=2019-03-01T04:16:55.551367Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:55.551542Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 29 on node dnode-1 as primary for shard 5"

ts=2019-03-01T04:16:55.551612Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:16:55.552051Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:16:55.552502Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:55.55255Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:55.552574Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:55.552676Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7400, TLS: false"

ts=2019-03-01T04:16:55.554272Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="created query aggregator with db /tmp/citadel/qstore/0"

ts=2019-03-01T04:16:55.554638Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 31 on node dnode-2 as primary for shard 1"

ts=2019-03-01T04:16:55.554665Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:55.554978Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:55.555265Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:55.555274Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:317 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0042c73c0 NodeMap:map[dnode-0:0xc0063dd860 dnode-1:0xc0063dd8c0 dnode-2:0xc0063dd920 dnode-3:0xc0063dd980 dnode-4:0xc0063dd9e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:55.555308Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:55.555327Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:16:55.555772Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored tstore replica 6 shard 1"

ts=2019-03-01T04:16:55.555977Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored tstore replica 10 shard 5"

ts=2019-03-01T04:16:55.55841Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:55.558578Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:291 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000371240 NodeMap:map[dnode-2:0xc004774600 dnode-3:0xc004774660 dnode-4:0xc0047746c0 dnode-0:0xc004774540 dnode-1:0xc0047745a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:55.558965Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored kstore replica 27 shard 1"

ts=2019-03-01T04:16:55.559117Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored kstore replica 11 shard 4"

ts=2019-03-01T04:16:55.559166Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Datanode RPC server is listening on: 127.0.0.1:7400"

ts=2019-03-01T04:16:55.559204Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 0, action 1/Sleep"

ts=2019-03-01T04:16:55.559227Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:55.559304Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:55.561602Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:55.562172Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:319 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0005c67c0 NodeMap:map[dnode-3:0xc0042ee5a0 dnode-4:0xc0042ee600 dnode-0:0xc0042ee480 dnode-1:0xc0042ee4e0 dnode-2:0xc0042ee540] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:55.562299Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:291 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0005c6c00 NodeMap:map[dnode-2:0xc0042ee7e0 dnode-3:0xc0042ee840 dnode-4:0xc0042ee8a0 dnode-0:0xc0042ee720 dnode-1:0xc0042ee780] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:55.564366Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:55.566368Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:55.568937Z module=Default pid=20890 caller=metamgr.go:268 level=info msg="kstore New leader dnode-1 is resuming from cluster state: map[dnode-0:0xc0002fee40 dnode-1:0xc0002feea0 dnode-2:0xc0002fef00 dnode-3:0xc0002fef60 dnode-4:0xc0002fefc0]"

ts=2019-03-01T04:16:55.568949Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:55.569037Z module=Default pid=20890 caller=metamgr.go:286 level=info msg="kstore Leader got node list: &{ListMeta:{ResourceVersion:} TypeMeta:{Kind: APIVersion:} ObjectMeta:{Name: Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} Items:[0xc004737dc0 0xc004737ea0 0xc000382000 0xc0003820e0 0xc0003821c0]}"

ts=2019-03-01T04:16:55.569059Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:55.571222Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:55.573299Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:55.575515Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:55.577864Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:55.580096Z module=Default pid=20890 caller=node.go:272 level=info msg="dnode-1 leader started watching node events"

ts=2019-03-01T04:16:55.580135Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:55.580155Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:55.582048Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-2 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-2 NodeURL:127.0.0.1:7402}"

ts=2019-03-01T04:16:55.584446Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:55.584474Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:55.586334Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-3 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-3 NodeURL:127.0.0.1:7403}"

ts=2019-03-01T04:16:55.588443Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:55.588466Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:55.590473Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:16:55.593037Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:55.593071Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:55.595022Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-1 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-1 NodeURL:127.0.0.1:7401}"

ts=2019-03-01T04:16:55.597094Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:55.597118Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:55.598965Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 29 on node dnode-1 to secondary 10 on node dnode-0"

ts=2019-03-01T04:16:55.59929Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:55.599383Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:55.599705Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:55.599973Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 ChunkMeta:\"\\010\\000\\020\\016\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:55.600851Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:55.601742Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 31 on node dnode-2 to secondary 6 on node dnode-0"

ts=2019-03-01T04:16:55.60193Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:55.602004Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:55.602389Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:55.602616Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 ChunkMeta:\"\\010\\000\\020\\n\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:55.603374Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:55.606292Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:56.037214Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:56.037806Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:56.038261Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:16:56.038531Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss brokeruuid=broker-0 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2, Node: dnode-3"

ts=2019-03-01T04:16:56.038569Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-0, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:16:56.139022Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-1 msg="Service broker-broker-1 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:56.139627Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-1 msg="Client broker-broker-1 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:56.140116Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:16:56.140375Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-1 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2, Node: dnode-3"

ts=2019-03-01T04:16:56.140428Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-1, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:16:56.242678Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-2 msg="Service broker-broker-2 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:56.243283Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-2 msg="Client broker-broker-2 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:56.243941Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:16:56.244209Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-2 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2, Node: dnode-3"

ts=2019-03-01T04:16:56.244255Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-2, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:16:56.345418Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-3 msg="Service broker-broker-3 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:16:56.346206Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-3 msg="Client broker-broker-3 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:16:56.346692Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:16:56.346942Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestKstoreNodeSoftRestart brokeruuid=broker-3 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2, Node: dnode-3"

ts=2019-03-01T04:16:56.346994Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-3, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:16:56.450337Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-4 msg="Service broker-broker-4 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:56.450936Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-4 msg="Client broker-broker-4 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:56.451504Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:16:56.451759Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-4 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3, Node: dnode-2"

ts=2019-03-01T04:16:56.4518Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-4, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:16:56.559477Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 0, action 2/VerifyConverged"

ts=2019-03-01T04:16:57.466808Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:57.466864Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 1, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:16:57.466901Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-0"

ts=2019-03-01T04:16:57.466946Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-0 Stopping election loop"

ts=2019-03-01T04:16:57.466967Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-0 Leader election is stopped"

ts=2019-03-01T04:16:57.466983Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-0 at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:57.467058Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:57.46709Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:57.467086Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-1 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}."

ts=2019-03-01T04:16:57.467131Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:57.467156Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:301 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000406d00 NodeMap:map[dnode-0:0xc0002fee40 dnode-1:0xc0002feea0 dnode-2:0xc0002fef00 dnode-3:0xc0002fef60 dnode-4:0xc0002fefc0] mclient:0xc000128000}"

ts=2019-03-01T04:16:57.467186Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:57.467273Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:57.467343Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:57.469138Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7400, TLS: false"

ts=2019-03-01T04:16:57.47029Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="created query aggregator with db /tmp/citadel/qstore/0"

ts=2019-03-01T04:16:57.471104Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:330 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006520c00 NodeMap:map[dnode-2:0xc006775740 dnode-3:0xc0067757a0 dnode-4:0xc006775800 dnode-0:0xc006775680 dnode-1:0xc0067756e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:57.471621Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored tstore replica 6 shard 1"

ts=2019-03-01T04:16:57.471883Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored tstore replica 10 shard 5"

ts=2019-03-01T04:16:57.47434Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:303 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006cc7340 NodeMap:map[dnode-0:0xc00620a1e0 dnode-1:0xc00620a240 dnode-2:0xc00620a2a0 dnode-3:0xc00620a300 dnode-4:0xc00620a360] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:57.474668Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored kstore replica 27 shard 1"

ts=2019-03-01T04:16:57.474816Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored kstore replica 11 shard 4"

ts=2019-03-01T04:16:57.474866Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Datanode RPC server is listening on: 127.0.0.1:7400"

ts=2019-03-01T04:16:57.47491Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 1, action 1/Sleep"

ts=2019-03-01T04:16:57.474911Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:57.474993Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:57.476742Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-0:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:57.477008Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:330 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0048c16c0 NodeMap:map[dnode-2:0xc00625d980 dnode-3:0xc00625d9e0 dnode-4:0xc00625da40 dnode-0:0xc00625d8c0 dnode-1:0xc00625d920] mclient:0xc006afe000}"

ts=2019-03-01T04:16:57.477034Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:57.477588Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:330 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006032c40 NodeMap:map[dnode-0:0xc0059e90e0 dnode-1:0xc0059e9140 dnode-2:0xc0059e91a0 dnode-3:0xc0059e9200 dnode-4:0xc0059e9260] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:57.48008Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:304 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006d777c0 NodeMap:map[dnode-2:0xc006b73200 dnode-3:0xc006b73260 dnode-4:0xc006b73620 dnode-0:0xc006b73140 dnode-1:0xc006b731a0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:57.482223Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:57.4842Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:57.484229Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:57.486178Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 29 on node dnode-1 to secondary 10 on node dnode-0"

ts=2019-03-01T04:16:57.486446Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:57.486527Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:57.486897Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:57.487137Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 ChunkMeta:\"\\010\\000\\020\\016\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:57.488177Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:57.489364Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 31 on node dnode-2 to secondary 6 on node dnode-0"

ts=2019-03-01T04:16:57.489604Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:57.489685Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:57.489983Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:57.490183Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 ChunkMeta:\"\\010\\000\\020\\n\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:57.490941Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:57.493942Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:57.496684Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 30 on node dnode-2 to secondary 11 on node dnode-0"

ts=2019-03-01T04:16:57.49671Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:16:57.497033Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:16:57.497293Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:57.497348Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:57.497659Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:57.497932Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:57.498211Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:57.498251Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Syncing data from replica 30 chunk 4 len: 24576"

ts=2019-03-01T04:16:57.498438Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:57.500144Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 15 on node dnode-4 to secondary 27 on node dnode-0"

ts=2019-03-01T04:16:57.500168Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:16:57.500448Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:16:57.500728Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:57.500787Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:57.501101Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:57.501341Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:57.501632Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:57.501672Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="Syncing data from replica 15 chunk 1 len: 24576"

ts=2019-03-01T04:16:57.501838Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:16:58.476059Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 1, action 2/VerifyConverged"

ts=2019-03-01T04:16:59.383527Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:16:59.383585Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 2, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:16:59.383604Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-0"

ts=2019-03-01T04:16:59.383644Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-0 Stopping election loop"

ts=2019-03-01T04:16:59.383671Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-0 Leader election is stopped"

ts=2019-03-01T04:16:59.383691Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-0 at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:59.38384Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:59.383886Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:59.383889Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-1 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}."

ts=2019-03-01T04:16:59.383925Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:59.383987Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:337 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0048c16c0 NodeMap:map[dnode-0:0xc00625d8c0 dnode-1:0xc00625d920 dnode-2:0xc00625d980 dnode-3:0xc00625d9e0 dnode-4:0xc00625da40] mclient:0xc006afe000}"

ts=2019-03-01T04:16:59.384018Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:59.384173Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:16:59.384332Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:59.386053Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-0:citadel-meta-leader): canceled"

ts=2019-03-01T04:16:59.386538Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7400, TLS: false"

ts=2019-03-01T04:16:59.387861Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="created query aggregator with db /tmp/citadel/qstore/0"

ts=2019-03-01T04:16:59.391219Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored tstore replica 6 shard 1"

ts=2019-03-01T04:16:59.391545Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored tstore replica 10 shard 5"

ts=2019-03-01T04:16:59.393564Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:308 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000406d00 NodeMap:map[dnode-0:0xc0002fee40 dnode-1:0xc0002feea0 dnode-2:0xc0002fef00 dnode-3:0xc0002fef60 dnode-4:0xc0002fefc0] mclient:0xc000128000}"

ts=2019-03-01T04:16:59.393601Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-0 unreachable"

ts=2019-03-01T04:16:59.393725Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:340 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00436ef80 NodeMap:map[dnode-3:0xc006becf60 dnode-4:0xc006becfc0 dnode-0:0xc006bece40 dnode-1:0xc006becea0 dnode-2:0xc006becf00] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:59.394173Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored kstore replica 27 shard 1"

ts=2019-03-01T04:16:59.394439Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored kstore replica 11 shard 4"

ts=2019-03-01T04:16:59.394527Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Datanode RPC server is listening on: 127.0.0.1:7400"

ts=2019-03-01T04:16:59.394599Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 2, action 1/Sleep"

ts=2019-03-01T04:16:59.394609Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7400"

ts=2019-03-01T04:16:59.394702Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:16:59.399372Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:310 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0055ad5c0 NodeMap:map[dnode-3:0xc0014a9980 dnode-4:0xc0014a99e0 dnode-0:0xc0014a9860 dnode-1:0xc0014a98c0 dnode-2:0xc0014a9920] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:59.401954Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:59.402001Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:59.402124Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:340 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004215480 NodeMap:map[dnode-0:0xc005781380 dnode-1:0xc0057813e0 dnode-2:0xc005781440 dnode-3:0xc0057814a0 dnode-4:0xc005781500] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:59.404738Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 29 on node dnode-1 to secondary 10 on node dnode-0"

ts=2019-03-01T04:16:59.405065Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:311 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00572b0c0 NodeMap:map[dnode-4:0xc00714baa0 dnode-0:0xc00714b920 dnode-1:0xc00714b980 dnode-2:0xc00714b9e0 dnode-3:0xc00714ba40] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:16:59.405079Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:16:59.405596Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:16:59.405795Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:59.406358Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:59.406661Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 ChunkMeta:\"\\010\\000\\020\\016\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:59.407749Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:59.408399Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 31 on node dnode-2 to secondary 6 on node dnode-0"

ts=2019-03-01T04:16:59.408626Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > "

ts=2019-03-01T04:16:59.408689Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:59.409053Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:59.409344Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 ChunkMeta:\"\\010\\000\\020\\n\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:16:59.410264Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:59.413827Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:16:59.415961Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 30 on node dnode-2 to secondary 11 on node dnode-0"

ts=2019-03-01T04:16:59.416267Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:59.416333Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:59.416647Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:59.416923Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:16:59.417211Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:59.417244Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Syncing data from replica 30 chunk 4 len: 24576"

ts=2019-03-01T04:16:59.417475Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:16:59.419156Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 15 on node dnode-4 to secondary 27 on node dnode-0"

ts=2019-03-01T04:16:59.419457Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:16:59.419541Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:16:59.419905Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:16:59.420171Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:16:59.42054Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="Syncing data from replica 15 chunk 1 len: 24576"

ts=2019-03-01T04:16:59.420505Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:16:59.420839Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:17:00.395903Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 2, action 2/VerifyConverged"

ts=2019-03-01T04:17:01.303113Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:01.303175Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 3, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:17:01.303199Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-4"

ts=2019-03-01T04:17:01.303243Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-4 Stopping election loop"

ts=2019-03-01T04:17:01.303266Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-4 Leader election is stopped"

ts=2019-03-01T04:17:01.303291Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-4 at Path /venice/citadel/nodes/dnode-4"

ts=2019-03-01T04:17:01.303406Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:01.303441Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:01.303478Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:01.303537Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-1 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}."

ts=2019-03-01T04:17:01.303624Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:01.303659Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:315 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000406d00 NodeMap:map[dnode-0:0xc0002fee40 dnode-1:0xc0002feea0 dnode-2:0xc0002fef00 dnode-3:0xc0002fef60 dnode-4:0xc0002fefc0] mclient:0xc000128000}"

ts=2019-03-01T04:17:01.303704Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-4 unreachable"

ts=2019-03-01T04:17:01.303739Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 27 on node dnode-0 as primary for shard 1"

ts=2019-03-01T04:17:01.30375Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7404"

ts=2019-03-01T04:17:01.303785Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:17:01.304551Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:17:01.305044Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:17:01.305123Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:17:01.305158Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:17:01.305899Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7404, TLS: false"

ts=2019-03-01T04:17:01.307151Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="created query aggregator with db /tmp/citadel/qstore/4"

ts=2019-03-01T04:17:01.30928Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 26 on node dnode-1 as primary for shard 5"

ts=2019-03-01T04:17:01.309332Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:01.309816Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:17:01.310266Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:17:01.310341Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:17:01.310361Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:344 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005a5f400 NodeMap:map[dnode-0:0xc0069e6780 dnode-1:0xc0069e67e0 dnode-2:0xc0069e6840 dnode-3:0xc0069e68a0 dnode-4:0xc0069e6900] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:01.310375Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:17:01.310878Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="Restored tstore replica 7 shard 2"

ts=2019-03-01T04:17:01.310915Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:316 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0042e37c0 NodeMap:map[dnode-2:0xc004a21680 dnode-3:0xc004a216e0 dnode-4:0xc004a21740 dnode-0:0xc004a215c0 dnode-1:0xc004a21620] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:01.31111Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="Restored tstore replica 17 shard 4"

ts=2019-03-01T04:17:01.314383Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-4:citadel-meta-leader): canceled"

ts=2019-03-01T04:17:01.316148Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:344 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0048c16c0 NodeMap:map[dnode-4:0xc00625da40 dnode-0:0xc00625d8c0 dnode-1:0xc00625d920 dnode-2:0xc00625d980 dnode-3:0xc00625d9e0] mclient:0xc006afe000}"

ts=2019-03-01T04:17:01.316174Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-4 unreachable"

ts=2019-03-01T04:17:01.316214Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="tstore Setting replica 27 on node dnode-1 as primary for shard 2"

ts=2019-03-01T04:17:01.316493Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received UpdateShard req ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:17:01.316509Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="Restored kstore replica 15 shard 1"

ts=2019-03-01T04:17:01.316539Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received update request: ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:17:01.316566Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:17:01.316651Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="Restored kstore replica 5 shard 5"

ts=2019-03-01T04:17:01.316694Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="Datanode RPC server is listening on: 127.0.0.1:7404"

ts=2019-03-01T04:17:01.31674Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 3, action 1/Sleep"

ts=2019-03-01T04:17:01.316732Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7404"

ts=2019-03-01T04:17:01.316809Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404} at Path /venice/citadel/nodes/dnode-4"

ts=2019-03-01T04:17:01.322858Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:17:01.322886Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:17:01.322992Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:347 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc007722a00 NodeMap:map[dnode-1:0xc00547ca80 dnode-2:0xc00547cae0 dnode-3:0xc00547cb40 dnode-4:0xc00547cba0 dnode-0:0xc00547ca20] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:01.325056Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 25 on node dnode-3 to secondary 17 on node dnode-4"

ts=2019-03-01T04:17:01.325081Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:17:01.325199Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:318 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00722d780 NodeMap:map[dnode-4:0xc00652c840 dnode-0:0xc00652c6c0 dnode-1:0xc00652c720 dnode-2:0xc00652c780 dnode-3:0xc00652c7e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:01.32544Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:17:01.325712Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:25 DestReplicaID:17 ShardID:4 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:17 ShardID:4 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"tstore\" ReplicaID:25 ShardID:4 IsPrimary:true NodeUUID:\"dnode-3\" NodeURL:\"127.0.0.1:7403\" > "

ts=2019-03-01T04:17:01.325789Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-3 msg="Service datanode-dnode-3 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:17:01.326142Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-3 msg="Client datanode-dnode-3 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:17:01.326415Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:25 DestReplicaID:17 ShardID:4 ChunkMeta:\"\\010\\000\\020\\010\\030\\324\\343\\221\\236\\230\\376\\327\\3340*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:17:01.32721Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:17:01.328359Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 27 on node dnode-1 to secondary 7 on node dnode-4"

ts=2019-03-01T04:17:01.328437Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-4 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:17:01.328544Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:27 DestReplicaID:7 ShardID:2 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:27 ShardID:2 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"tstore\" ReplicaID:7 ShardID:2 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:17:01.328612Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:17:01.328888Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:17:01.329143Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:27 DestReplicaID:7 ShardID:2 ChunkMeta:\"\\010\\000\\020\\014\\030\\247\\214\\245\\257\\371\\325\\326\\222h*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:17:01.329839Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:17:01.332877Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-4 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-4 NodeURL:127.0.0.1:7404}"

ts=2019-03-01T04:17:01.334976Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 27 on node dnode-0 to secondary 15 on node dnode-4"

ts=2019-03-01T04:17:01.335163Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:27 DestReplicaID:15 ShardID:1 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 IsPrimary:true NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:17:01.335211Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-0 msg="Service datanode-dnode-0 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:17:01.335514Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-0 msg="Client datanode-dnode-0 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:17:01.335708Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:27 DestReplicaID:15 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:17:01.335991Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:17:01.336139Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Syncing data from replica 27 chunk 1 len: 24576"

ts=2019-03-01T04:17:01.336313Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:17:01.337773Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 26 on node dnode-1 to secondary 5 on node dnode-4"

ts=2019-03-01T04:17:01.337975Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:26 DestReplicaID:5 ShardID:5 DestNodeUUID:\"dnode-4\" DestNodeURL:\"127.0.0.1:7404\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:26 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > Replicas:<ClusterType:\"kstore\" ReplicaID:5 ShardID:5 NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > "

ts=2019-03-01T04:17:01.338052Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:17:01.338422Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:17:01.338693Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:26 DestReplicaID:5 ShardID:5 Chunks:<ChunkID:5 Database:\"default\" > "

ts=2019-03-01T04:17:01.338959Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Syncing data from replica 26 chunk 5 len: 24576"

ts=2019-03-01T04:17:01.338951Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received SyncData req"

ts=2019-03-01T04:17:01.339137Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Restoring kstore Chunk 5 on shard 5"

ts=2019-03-01T04:17:02.32012Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 3, action 2/VerifyConverged"

ts=2019-03-01T04:17:03.227545Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:03.227599Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 4, action 0/RestartQuickAnyNode"

ts=2019-03-01T04:17:03.227617Z module=Default pid=20890 caller=actions_test.go:257 level=info msg="###### Restarting node dnode-0"

ts=2019-03-01T04:17:03.227657Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-0 Stopping election loop"

ts=2019-03-01T04:17:03.227676Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-0 Leader election is stopped"

ts=2019-03-01T04:17:03.227702Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-0 at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:17:03.227792Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:03.227837Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:03.227836Z module=Default pid=20890 caller=node.go:315 level=info msg="dnode-1 Got Deleted event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}."

ts=2019-03-01T04:17:03.227902Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:03.227921Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="tstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:351 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0048c16c0 NodeMap:map[dnode-4:0xc00625da40 dnode-0:0xc00625d8c0 dnode-1:0xc00625d920 dnode-2:0xc00625d980 dnode-3:0xc00625d9e0] mclient:0xc006afe000}"

ts=2019-03-01T04:17:03.227957Z module=Default pid=20890 caller=meta.go:241 level=info msg="tstore Marking dnode-0 unreachable"

ts=2019-03-01T04:17:03.228016Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:03.228317Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7400"

ts=2019-03-01T04:17:03.230051Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: localhost:7400, TLS: false"

ts=2019-03-01T04:17:03.230383Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-0:citadel-meta-leader): canceled"

ts=2019-03-01T04:17:03.231279Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="created query aggregator with db /tmp/citadel/qstore/0"

ts=2019-03-01T04:17:03.233011Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:352 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc002690e00 NodeMap:map[dnode-4:0xc00269e840 dnode-0:0xc00269e6c0 dnode-1:0xc00269e720 dnode-2:0xc00269e780 dnode-3:0xc00269e7e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:03.236953Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:322 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006176540 NodeMap:map[dnode-3:0xc00617b380 dnode-4:0xc00617b3e0 dnode-0:0xc00617b260 dnode-1:0xc00617b2c0 dnode-2:0xc00617b320] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:03.239971Z module=Default pid=20890 caller=metamgr.go:341 level=info msg="kstore node &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} is unreachable. Cluster: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:322 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc000406d00 NodeMap:map[dnode-0:0xc0002fee40 dnode-1:0xc0002feea0 dnode-2:0xc0002fef00 dnode-3:0xc0002fef60 dnode-4:0xc0002fefc0] mclient:0xc000128000}"

ts=2019-03-01T04:17:03.240001Z module=Default pid=20890 caller=meta.go:241 level=info msg="kstore Marking dnode-0 unreachable"

ts=2019-03-01T04:17:03.242306Z module=Default pid=20890 caller=metamgr.go:101 level=info msg="kstore Setting replica 15 on node dnode-4 as primary for shard 1"

ts=2019-03-01T04:17:03.242334Z module=Default pid=20890 caller=rpckit.go:414 level=info client=metanode-dnode-1 msg="Service metanode-dnode-1 connecting to remoteURL: 127.0.0.1:7404, TLS: false"

ts=2019-03-01T04:17:03.242644Z module=Default pid=20890 caller=rpckit.go:429 level=info client=metanode-dnode-1 msg="Client metanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7404"

ts=2019-03-01T04:17:03.242994Z module=citadel-integ-test pid=20890 caller=datanode.go:363 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received UpdateShard req ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:17:03.243045Z module=citadel-integ-test pid=20890 caller=datanode.go:1036 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 sync buffer received update request: ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:17:03.243073Z module=citadel-integ-test pid=20890 caller=datanode.go:1059 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="delete replica ids from sync buffer []"

ts=2019-03-01T04:17:03.25064Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored tstore replica 6 shard 1"

ts=2019-03-01T04:17:03.250875Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored tstore replica 10 shard 5"

ts=2019-03-01T04:17:03.251168Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored kstore replica 27 shard 1"

ts=2019-03-01T04:17:03.251292Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Restored kstore replica 11 shard 4"

ts=2019-03-01T04:17:03.251347Z module=citadel-integ-test pid=20890 caller=datanode.go:148 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="Datanode RPC server is listening on: 127.0.0.1:7400"

ts=2019-03-01T04:17:03.251389Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 4, action 1/Sleep"

ts=2019-03-01T04:17:03.2514Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7400"

ts=2019-03-01T04:17:03.251472Z module=Default pid=20890 caller=node.go:135 level=info msg="Registering node: {TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion: UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400} at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:17:03.251977Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:354 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0071acf40 NodeMap:map[dnode-2:0xc0071afa40 dnode-3:0xc0071afaa0 dnode-4:0xc0071afb00 dnode-0:0xc0071af980 dnode-1:0xc0071af9e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:03.252051Z module=Default pid=20890 caller=node.go:163 level=info msg="dnode-0 Received leader election event: &{Type:Changed Leader:dnode-1}"

ts=2019-03-01T04:17:03.252052Z module=Default pid=20890 caller=node.go:306 level=info msg="dnode-1 Got Created event for node: &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:17:03.25211Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="tstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:17:03.252259Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:325 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004be2500 NodeMap:map[dnode-0:0xc004be83c0 dnode-1:0xc004be8420 dnode-2:0xc004be8480 dnode-3:0xc004be84e0 dnode-4:0xc004be8540] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:03.254373Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 29 on node dnode-1 to secondary 10 on node dnode-0"

ts=2019-03-01T04:17:03.254632Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:10 ShardID:5 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > Replicas:<ClusterType:\"tstore\" ReplicaID:29 ShardID:5 IsPrimary:true NodeUUID:\"dnode-1\" NodeURL:\"127.0.0.1:7401\" > "

ts=2019-03-01T04:17:03.254748Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-1 msg="Service datanode-dnode-1 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:17:03.25518Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-1 msg="Client datanode-dnode-1 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:17:03.255518Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:29 DestReplicaID:10 ShardID:5 ChunkMeta:\"\\010\\000\\020\\016\\030\\213\\332\\316\\345\\207\\253\\210\\333(*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:17:03.256397Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:17:03.257543Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="tstore Copying data from primary shard 31 on node dnode-2 to secondary 6 on node dnode-0"

ts=2019-03-01T04:17:03.257774Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"tstore\" ReplicaID:31 ShardID:1 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"tstore\" ReplicaID:6 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:17:03.257832Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:17:03.258176Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:17:03.258436Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"tstore\" SrcReplicaID:31 DestReplicaID:6 ShardID:1 ChunkMeta:\"\\010\\000\\020\\n\\030\\204\\272\\235\\234\\357\\230\\237\\371A*0\\n\\007default\\022\\007default\\032\\034\\n\\007default\\020\\200\\200\\244\\311\\377\\301\\211\\001\\030\\200\\200\\274\\212\\311\\322\\023 \\0018\\000@\\000H\\000\" "

ts=2019-03-01T04:17:03.259118Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:17:03.262314Z module=Default pid=20890 caller=metamgr.go:320 level=info msg="kstore Adding node to nodemap &{TypeMeta:{Kind:TscaleNodeInfo APIVersion:} ObjectMeta:{Name:dnode-0 Tenant: Namespace: GenerationID: ResourceVersion:1 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} NodeUUID:dnode-0 NodeURL:127.0.0.1:7400}"

ts=2019-03-01T04:17:03.264893Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 30 on node dnode-2 to secondary 11 on node dnode-0"

ts=2019-03-01T04:17:03.265176Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:30 ShardID:4 IsPrimary:true NodeUUID:\"dnode-2\" NodeURL:\"127.0.0.1:7402\" > Replicas:<ClusterType:\"kstore\" ReplicaID:11 ShardID:4 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:17:03.26524Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-2 msg="Service datanode-dnode-2 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:17:03.265574Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-2 msg="Client datanode-dnode-2 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:17:03.265839Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:30 DestReplicaID:11 ShardID:4 Chunks:<ChunkID:4 Database:\"default\" > "

ts=2019-03-01T04:17:03.266122Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:17:03.266157Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Syncing data from replica 30 chunk 4 len: 24576"

ts=2019-03-01T04:17:03.266319Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 4 on shard 4"

ts=2019-03-01T04:17:03.268129Z module=Default pid=20890 caller=metamgr.go:190 level=info msg="kstore Copying data from primary shard 15 on node dnode-4 to secondary 27 on node dnode-0"

ts=2019-03-01T04:17:03.268372Z module=citadel-integ-test pid=20890 caller=datanode.go:483 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 Received SyncShardReq req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 DestNodeUUID:\"dnode-0\" DestNodeURL:\"127.0.0.1:7400\" SrcIsPrimary:true Replicas:<ClusterType:\"kstore\" ReplicaID:15 ShardID:1 IsPrimary:true NodeUUID:\"dnode-4\" NodeURL:\"127.0.0.1:7404\" > Replicas:<ClusterType:\"kstore\" ReplicaID:27 ShardID:1 NodeUUID:\"dnode-0\" NodeURL:\"127.0.0.1:7400\" > "

ts=2019-03-01T04:17:03.268436Z module=Default pid=20890 caller=rpckit.go:414 level=info client=datanode-dnode-4 msg="Service datanode-dnode-4 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:17:03.268845Z module=Default pid=20890 caller=rpckit.go:429 level=info client=datanode-dnode-4 msg="Client datanode-dnode-4 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:17:03.269056Z module=citadel-integ-test pid=20890 caller=datanode.go:629 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncShardInfo req ClusterType:\"kstore\" SrcReplicaID:15 DestReplicaID:27 ShardID:1 Chunks:<ChunkID:1 Database:\"default\" > "

ts=2019-03-01T04:17:03.269306Z module=citadel-integ-test pid=20890 caller=datanode.go:678 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Received SyncData req"

ts=2019-03-01T04:17:03.269415Z module=citadel-integ-test pid=20890 caller=datanode.go:606 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="Syncing data from replica 15 chunk 1 len: 24576"

ts=2019-03-01T04:17:03.269639Z module=citadel-integ-test pid=20890 caller=datanode.go:693 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 Restoring kstore Chunk 1 on shard 1"

ts=2019-03-01T04:17:04.251916Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 1/NodeRestartQuick, iter 4, action 2/VerifyConverged"

ts=2019-03-01T04:17:05.157923Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:05.157981Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartQuickWriteLossTest/2 VerifyPoints"

ts=2019-03-01T04:17:05.158008Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 2/VerifyPoints, iter 0, action 0/VerifyConverged"

ts=2019-03-01T04:17:06.071282Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:06.071347Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 2/VerifyPoints, iter 0, action 1/WaitForTasks"

ts=2019-03-01T04:17:06.071383Z module=Default pid=20890 caller=actions_test.go:390 level=info msg="Waiting 40s for all tasks to complete"

ts=2019-03-01T04:17:06.071442Z module=Default pid=20890 caller=actions_test.go:394 level=info msg="All waitgroups finished"

ts=2019-03-01T04:17:06.071494Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartQuickWriteLossTest: step 2/VerifyPoints, iter 0, action 2/VerifyPointPattern"

ts=2019-03-01T04:17:06.071857Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:17:06.072408Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:17:06.073299Z module=Default pid=20890 caller=actions_test.go:485 level=info msg="Got query results: [{\"statement_id\":0}]"

ts=2019-03-01T04:17:06.07514Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreNodeRestartQuickWriteLoss completed =========================="



----------------------------------------------------------------------

FAIL: tstore_test.go:165: integTestSuite.TestTstoreNodeRestartQuickWriteLoss



/Users/ranjith/gopath/src/github.com/pensando/sw/venice/utils/testutils/testutils.go:55:

    tb.Fatalf("\033[31m%s:%d: %s. unexpected error: %s\033[39m\n\n", filepath.Base(file), line, msg, err.Error())

... Error: [31mactions_test.go:446: NodeRestartQuickWriteLossTest: step 0/WritePoints, iter 0, action 0/WritePointPatternAsync: Error writing points. unexpected error: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3[39m







tstore_test.go:225:

    it.runTestCase(c, &nodeRestartQuickWriteLossCase)

/Users/ranjith/gopath/src/github.com/pensando/sw/venice/utils/testutils/testutils.go:46:

    tb.Fatalf("\033[31m%s:%d: "+msg+"\033[39m\n\n", append([]interface{}{filepath.Base(file), line}, v...)...)

... Error: [31mactions_test.go:487: NodeRestartQuickWriteLossTest: step 2/VerifyPoints, iter 0, action 2/VerifyPointPattern: Invalid query result[39m



%!(EXTRA []*query.Result=[0xc005b42460])



ts=2019-03-01T04:17:06.075315Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreNodeRestartSlow starting =========================="

ts=2019-03-01T04:17:06.075453Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case NodeRestartSlowTest ###################"

ts=2019-03-01T04:17:06.980692Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:06.980742Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### NodeRestartSlowTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:17:06.98076Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeRestartSlowTest/0 WritePoints"

ts=2019-03-01T04:17:06.980777Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeRestartSlowTest: step 0/WritePoints, iter 0, action 0/WritePointPattern"

ts=2019-03-01T04:17:06.992486Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:06.993053Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:17:06.993497Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:17:06.993728Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss brokeruuid=broker-0 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3, Node: dnode-1"

ts=2019-03-01T04:17:06.993773Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-0, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:17:07.095271Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-1 msg="Service broker-broker-1 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:07.095953Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-1 msg="Client broker-broker-1 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:17:07.096521Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:17:07.096795Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-1 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3, Node: dnode-1"

ts=2019-03-01T04:17:07.096839Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-1, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:17:07.201804Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-2 msg="Service broker-broker-2 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:07.202212Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-2 msg="Client broker-broker-2 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:17:07.202586Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:17:07.202735Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-2 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3, Node: dnode-1"

ts=2019-03-01T04:17:07.202758Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-2, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=3"

ts=2019-03-01T04:17:07.304634Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:07.304873Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestKstoreNodeSoftRestart brokeruuid=broker-3 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:07.304921Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-3, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:07.410363Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-4 msg="Service broker-broker-4 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:17:07.41096Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-4 msg="Client broker-broker-4 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:17:07.411563Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:07.411835Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss brokeruuid=broker-4 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:07.41188Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-4, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:07.516687Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreNodeRestartSlow completed =========================="



----------------------------------------------------------------------

FAIL: tstore_test.go:228: integTestSuite.TestTstoreNodeRestartSlow



tstore_test.go:282:

    it.runTestCase(c, &nodeRestartSlowCase)

/Users/ranjith/gopath/src/github.com/pensando/sw/venice/utils/testutils/testutils.go:55:

    tb.Fatalf("\033[31m%s:%d: %s. unexpected error: %s\033[39m\n\n", filepath.Base(file), line, msg, err.Error())

... Error: [31mactions_test.go:446: NodeRestartSlowTest: step 0/WritePoints, iter 0, action 0/WritePointPattern: Error writing points. unexpected error: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1[39m







ts=2019-03-01T04:17:07.516922Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreNodeSoftRestart starting =========================="

ts=2019-03-01T04:17:07.517142Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case NodeSoftRestartTest ###################"

ts=2019-03-01T04:17:08.424019Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:08.424079Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### NodeSoftRestartTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:17:08.424101Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeSoftRestartTest/0 WritePoints"

ts=2019-03-01T04:17:08.424122Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartTest: step 0/WritePoints, iter 0, action 0/WritePointPattern"

ts=2019-03-01T04:17:08.437219Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.43747Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss brokeruuid=broker-0 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:08.437517Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-0, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.538348Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.538586Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-1 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:08.538634Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-1, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.641396Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.641631Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-2 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:08.641676Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-2, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.744572Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.744826Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestKstoreNodeSoftRestart brokeruuid=broker-3 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:08.744882Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-3, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.85026Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.850448Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss brokeruuid=broker-4 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:08.850481Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-4, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:08.955171Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreNodeSoftRestart completed =========================="



----------------------------------------------------------------------

FAIL: tstore_test.go:386: integTestSuite.TestTstoreNodeSoftRestart



tstore_test.go:440:

    it.runTestCase(c, &nodeSoftRestartCase)

/Users/ranjith/gopath/src/github.com/pensando/sw/venice/utils/testutils/testutils.go:55:

    tb.Fatalf("\033[31m%s:%d: %s. unexpected error: %s\033[39m\n\n", filepath.Base(file), line, msg, err.Error())

... Error: [31mactions_test.go:446: NodeSoftRestartTest: step 0/WritePoints, iter 0, action 0/WritePointPattern: Error writing points. unexpected error: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1[39m







ts=2019-03-01T04:17:08.955444Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreNodeSoftRestartLeader starting =========================="

ts=2019-03-01T04:17:08.955643Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case NodeSoftRestartLeaderTest ###################"

ts=2019-03-01T04:17:09.86009Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:09.860146Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### NodeSoftRestartLeaderTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:17:09.860171Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeSoftRestartLeaderTest/0 WritePoints"

ts=2019-03-01T04:17:09.860193Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 0/WritePoints, iter 0, action 0/WritePointPatternAsync"

ts=2019-03-01T04:17:09.860224Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeSoftRestartLeaderTest/1 NodeSoftRestartLeader"

ts=2019-03-01T04:17:09.860255Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 0, action 0/SoftRestartLeaderNode"

ts=2019-03-01T04:17:09.860326Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:09.860389Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:09.860447Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:09.860563Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:09.860666Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:09.861381Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:09.861488Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:17:09.86207Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:09.864154Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:17:09.864478Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc007edd480 NodeMap:map[dnode-0:0xc004745e00 dnode-1:0xc004745e60 dnode-2:0xc004745ec0 dnode-3:0xc004745f20 dnode-4:0xc004745f80] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:09.86562Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 27 shard 2"

ts=2019-03-01T04:17:09.86565Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc004746000 NodeMap:map[dnode-1:0xc0073c8060 dnode-2:0xc0073c80c0 dnode-3:0xc0073c8120 dnode-4:0xc0073c8180 dnode-0:0xc0073c8000] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:09.86604Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 29 shard 5"

ts=2019-03-01T04:17:09.866597Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 25 shard 3"

ts=2019-03-01T04:17:09.866816Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 26 shard 5"

ts=2019-03-01T04:17:09.866894Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 0, action 1/Sleep"

ts=2019-03-01T04:17:09.867687Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006db0d40 NodeMap:map[dnode-0:0xc007f2f800 dnode-1:0xc007f2f860 dnode-2:0xc007f2f8c0 dnode-3:0xc007f2f920 dnode-4:0xc007f2f980] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:09.867978Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006db10c0 NodeMap:map[dnode-3:0xc007f2fbc0 dnode-4:0xc007f2fc20 dnode-0:0xc007f2faa0 dnode-1:0xc007f2fb00 dnode-2:0xc007f2fb60] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:09.972208Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 0, action 2/VerifyConverged"

ts=2019-03-01T04:17:10.363018Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:10.363274Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss brokeruuid=broker-0 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:10.363314Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-0, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:10.463751Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-1 msg="Service broker-broker-1 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:10.464229Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-1 msg="Client broker-broker-1 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:17:10.464644Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:17:10.464871Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeSoftRestartLeader brokeruuid=broker-1 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2, Node: dnode-1"

ts=2019-03-01T04:17:10.464906Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-1, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:17:10.567525Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-2 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unavailable desc = grpc: the connection is unavailable, Node: dnode-1"

ts=2019-03-01T04:17:10.567586Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-2, rpc error: code = Unavailable desc = grpc: the connection is unavailable"

ts=2019-03-01T04:17:10.670223Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:10.670476Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestKstoreNodeSoftRestart brokeruuid=broker-3 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:10.670525Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-3, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:10.772313Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-4 msg="Service broker-broker-4 connecting to remoteURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:10.773075Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-4 msg="Client broker-broker-4 Connected to pen-citadel at 127.0.0.1:7401"

ts=2019-03-01T04:17:10.773545Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:10.773794Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss brokeruuid=broker-4 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-1"

ts=2019-03-01T04:17:10.773836Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-4, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:10.877157Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:10.877214Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 1, action 0/SoftRestartLeaderNode"

ts=2019-03-01T04:17:10.877268Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:10.877302Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:10.877349Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:10.8775Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:10.877591Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:10.878249Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:10.878334Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:17:10.878402Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:10.879406Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0080c4c00 NodeMap:map[dnode-0:0xc007fda900 dnode-1:0xc007fda960 dnode-2:0xc007fda9c0 dnode-3:0xc007fdaa20 dnode-4:0xc007fdaa80] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:10.879649Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0080c4fc0 NodeMap:map[dnode-0:0xc007fdaba0 dnode-1:0xc007fdac00 dnode-2:0xc007fdac60 dnode-3:0xc007fdacc0 dnode-4:0xc007fdad20] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:10.880354Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:17:10.880879Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 27 shard 2"

ts=2019-03-01T04:17:10.881123Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 29 shard 5"

ts=2019-03-01T04:17:10.881642Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 25 shard 3"

ts=2019-03-01T04:17:10.88179Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 26 shard 5"

ts=2019-03-01T04:17:10.881874Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 1, action 1/Sleep"

ts=2019-03-01T04:17:10.882535Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005498bc0 NodeMap:map[dnode-2:0xc0072f65a0 dnode-3:0xc0072f6600 dnode-4:0xc0072f6660 dnode-0:0xc0072f6420 dnode-1:0xc0072f64e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:10.882692Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc005498f40 NodeMap:map[dnode-1:0xc0072f67e0 dnode-2:0xc0072f6840 dnode-3:0xc0072f68a0 dnode-4:0xc0072f6900 dnode-0:0xc0072f6780] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:10.982844Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 1, action 2/VerifyConverged"

ts=2019-03-01T04:17:11.890322Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:11.890384Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 2, action 0/SoftRestartLeaderNode"

ts=2019-03-01T04:17:11.890446Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:11.890501Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:11.89055Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:11.890682Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:11.89078Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:11.891324Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:11.891416Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:17:11.891626Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:11.89309Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00680b840 NodeMap:map[dnode-0:0xc0070e8900 dnode-1:0xc0070e8960 dnode-2:0xc0070e89c0 dnode-3:0xc0070e8a20 dnode-4:0xc0070e8a80] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:11.893479Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00680bbc0 NodeMap:map[dnode-2:0xc0070e8c60 dnode-3:0xc0070e8cc0 dnode-4:0xc0070e8d20 dnode-0:0xc0070e8ba0 dnode-1:0xc0070e8c00] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:11.893944Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:17:11.89459Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 27 shard 2"

ts=2019-03-01T04:17:11.894832Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 29 shard 5"

ts=2019-03-01T04:17:11.895273Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 25 shard 3"

ts=2019-03-01T04:17:11.895434Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 26 shard 5"

ts=2019-03-01T04:17:11.895524Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 2, action 1/Sleep"

ts=2019-03-01T04:17:11.896225Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00690e6c0 NodeMap:map[dnode-0:0xc00738fe00 dnode-1:0xc00738fe60 dnode-2:0xc00738fec0 dnode-3:0xc00738ff20 dnode-4:0xc00738ff80] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:11.896408Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00690ea40 NodeMap:map[dnode-0:0xc006ff00c0 dnode-1:0xc006ff0120 dnode-2:0xc006ff0180 dnode-3:0xc006ff01e0 dnode-4:0xc006ff0240] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:11.996167Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 2, action 2/VerifyConverged"

ts=2019-03-01T04:17:12.902065Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:12.902126Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 3, action 0/SoftRestartLeaderNode"

ts=2019-03-01T04:17:12.902181Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:12.902218Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:12.902263Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:12.902402Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:12.902497Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:12.903137Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:12.903247Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:17:12.903358Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:12.904775Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc007f17e40 NodeMap:map[dnode-0:0xc005c6d7a0 dnode-1:0xc005c6d800 dnode-2:0xc005c6d860 dnode-3:0xc005c6d8c0 dnode-4:0xc005c6d920] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:12.905091Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0049d21c0 NodeMap:map[dnode-3:0xc005c6db60 dnode-4:0xc005c6dbc0 dnode-0:0xc005c6da40 dnode-1:0xc005c6daa0 dnode-2:0xc005c6db00] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:12.905308Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:17:12.905959Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 27 shard 2"

ts=2019-03-01T04:17:12.906194Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 29 shard 5"

ts=2019-03-01T04:17:12.906586Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 25 shard 3"

ts=2019-03-01T04:17:12.906735Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 26 shard 5"

ts=2019-03-01T04:17:12.906787Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 3, action 1/Sleep"

ts=2019-03-01T04:17:12.907481Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006a7aac0 NodeMap:map[dnode-0:0xc006c274a0 dnode-1:0xc006c27500 dnode-2:0xc006c27560 dnode-3:0xc006c275c0 dnode-4:0xc006c27620] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:12.907714Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc006a7af00 NodeMap:map[dnode-3:0xc006c27860 dnode-4:0xc006c278c0 dnode-0:0xc006c27740 dnode-1:0xc006c277a0 dnode-2:0xc006c27800] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:13.008143Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 3, action 2/VerifyConverged"

ts=2019-03-01T04:17:13.913813Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:13.913876Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 4, action 0/SoftRestartLeaderNode"

ts=2019-03-01T04:17:13.913938Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:13.913983Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:13.91404Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:13.914174Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:13.914266Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:13.914779Z module=Default pid=20890 caller=rpckit.go:259 level=info server=pen-citadel msg="Creating new server, name: pen-citadel listenURL: 127.0.0.1:7401, TLS: false"

ts=2019-03-01T04:17:13.914861Z module=citadel-integ-test pid=20890 caller=datanode.go:838 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Datanode RPC server is listening on: 127.0.0.1:7401"

ts=2019-03-01T04:17:13.914965Z module=Default pid=20890 caller=rpckit.go:318 level=info server=pen-citadel msg="gRpc server pen-citadel Listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:13.916176Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00242f9c0 NodeMap:map[dnode-0:0xc006a65440 dnode-1:0xc006a65500 dnode-2:0xc006a655c0 dnode-3:0xc006a65680 dnode-4:0xc006a65740] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:13.91644Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc00242fd40 NodeMap:map[dnode-0:0xc006a65860 dnode-1:0xc006a658c0 dnode-2:0xc006a65920 dnode-3:0xc006a65980 dnode-4:0xc006a659e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:13.916797Z module=citadel-integ-test pid=20890 caller=ts_data.go:405 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="created query aggregator with db /tmp/citadel/qstore/1"

ts=2019-03-01T04:17:13.917299Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 27 shard 2"

ts=2019-03-01T04:17:13.917532Z module=citadel-integ-test pid=20890 caller=datanode.go:195 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored tstore replica 29 shard 5"

ts=2019-03-01T04:17:13.917972Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 25 shard 3"

ts=2019-03-01T04:17:13.918146Z module=citadel-integ-test pid=20890 caller=datanode.go:248 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Restored kstore replica 26 shard 5"

ts=2019-03-01T04:17:13.9182Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 4, action 1/Sleep"

ts=2019-03-01T04:17:13.918863Z module=Default pid=20890 caller=watcher.go:132 level=info msg="tstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:tstore Tenant: Namespace: GenerationID: ResourceVersion:358 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0024a4d80 NodeMap:map[dnode-0:0xc0049cd560 dnode-1:0xc0049cd5c0 dnode-2:0xc0049cd620 dnode-3:0xc0049cd680 dnode-4:0xc0049cd6e0] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:13.919022Z module=Default pid=20890 caller=watcher.go:145 level=info msg="kstore Got cluster state: &{Mutex:{state:0 sema:0} TypeMeta:{Kind:TscaleCluster APIVersion:} ObjectMeta:{Name:kstore Tenant: Namespace: GenerationID: ResourceVersion:329 UUID: Labels:map[] CreationTime:{Timestamp:{Seconds:0 Nanos:0}} ModTime:{Timestamp:{Seconds:0 Nanos:0}} SelfLink:} ShardMap:0xc0024a5100 NodeMap:map[dnode-0:0xc0049cd800 dnode-1:0xc0049cd860 dnode-2:0xc0049cd8c0 dnode-3:0xc0049cd920 dnode-4:0xc0049cd980] mclient:<nil>}. Starting watch"

ts=2019-03-01T04:17:14.018471Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 1/NodeSoftRestartLeader, iter 4, action 2/VerifyConverged"

ts=2019-03-01T04:17:14.926197Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:14.926232Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step NodeSoftRestartLeaderTest/2 VerifyPoints"

ts=2019-03-01T04:17:14.926247Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 2/VerifyPoints, iter 0, action 0/VerifyConverged"

ts=2019-03-01T04:17:15.837722Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:15.837788Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 2/VerifyPoints, iter 0, action 1/WaitForTasks"

ts=2019-03-01T04:17:15.83782Z module=Default pid=20890 caller=actions_test.go:390 level=info msg="Waiting 40s for all tasks to complete"

ts=2019-03-01T04:17:15.837857Z module=Default pid=20890 caller=actions_test.go:394 level=info msg="All waitgroups finished"

ts=2019-03-01T04:17:15.837899Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action NodeSoftRestartLeaderTest: step 2/VerifyPoints, iter 0, action 2/VerifyPointPattern"

ts=2019-03-01T04:17:15.838129Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-0 msg="Service broker-broker-0 connecting to remoteURL: 127.0.0.1:7400, TLS: false"

ts=2019-03-01T04:17:15.838724Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-0 msg="Client broker-broker-0 Connected to pen-citadel at 127.0.0.1:7400"

ts=2019-03-01T04:17:15.839718Z module=Default pid=20890 caller=actions_test.go:485 level=info msg="Got query results: [{\"statement_id\":0}]"

ts=2019-03-01T04:17:15.841837Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreNodeSoftRestartLeader completed =========================="



----------------------------------------------------------------------

FAIL: tstore_test.go:506: integTestSuite.TestTstoreNodeSoftRestartLeader



/Users/ranjith/gopath/src/github.com/pensando/sw/venice/utils/testutils/testutils.go:55:

    tb.Fatalf("\033[31m%s:%d: %s. unexpected error: %s\033[39m\n\n", filepath.Base(file), line, msg, err.Error())

... Error: [31mactions_test.go:446: NodeSoftRestartLeaderTest: step 0/WritePoints, iter 0, action 0/WritePointPatternAsync: Error writing points. unexpected error: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1[39m







tstore_test.go:565:

    it.runTestCase(c, &nodeSoftRestartLeaderCase)

/Users/ranjith/gopath/src/github.com/pensando/sw/venice/utils/testutils/testutils.go:46:

    tb.Fatalf("\033[31m%s:%d: "+msg+"\033[39m\n\n", append([]interface{}{filepath.Base(file), line}, v...)...)

... Error: [31mactions_test.go:487: NodeSoftRestartLeaderTest: step 2/VerifyPoints, iter 0, action 2/VerifyPointPattern: Invalid query result[39m



%!(EXTRA []*query.Result=[0xc0075ee0a0])



ts=2019-03-01T04:17:15.841988Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreNodeStopStart starting =========================="

ts=2019-03-01T04:17:15.84225Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreNodeStopStart completed =========================="

ts=2019-03-01T04:17:15.842438Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreReadWrite starting =========================="

ts=2019-03-01T04:17:15.842592Z module=Default pid=20890 caller=actions_test.go:129 level=info msg="################## Starting test case ReadWriteTest ###################"

ts=2019-03-01T04:17:16.744512Z module=Default pid=20890 caller=actions_test.go:215 level=info msg="###### All nodes are in steady state"

ts=2019-03-01T04:17:16.744582Z module=Default pid=20890 caller=actions_test.go:135 level=info msg="###### ReadWriteTest: Nodes are in steady state. starting test steps"

ts=2019-03-01T04:17:16.744605Z module=Default pid=20890 caller=actions_test.go:139 level=info msg="###### Executing step ReadWriteTest/0 WritePoints"

ts=2019-03-01T04:17:16.744626Z module=Default pid=20890 caller=actions_test.go:151 level=info msg="###### Executing Action ReadWriteTest: step 0/WritePoints, iter 0, action 0/WritePointPattern"

ts=2019-03-01T04:17:16.75693Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:16.757166Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss brokeruuid=broker-0 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-1"

ts=2019-03-01T04:17:16.757207Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-0, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:16.859564Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-1 msg="Service broker-broker-1 connecting to remoteURL: 127.0.0.1:7403, TLS: false"

ts=2019-03-01T04:17:16.860235Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-1 msg="Client broker-broker-1 Connected to pen-citadel at 127.0.0.1:7403"

ts=2019-03-01T04:17:16.860826Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:16.861167Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeSoftRestartLeader brokeruuid=broker-1 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:16.861221Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-1, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:16.96421Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:16.964554Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick brokeruuid=broker-2 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:16.964614Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-2, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:17.06711Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:17.067315Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestKstoreNodeSoftRestart brokeruuid=broker-3 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1, Node: dnode-3"

ts=2019-03-01T04:17:17.067357Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-3, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=1"

ts=2019-03-01T04:17:17.172578Z module=Default pid=20890 caller=rpckit.go:414 level=info client=broker-broker-4 msg="Service broker-broker-4 connecting to remoteURL: 127.0.0.1:7402, TLS: false"

ts=2019-03-01T04:17:17.173157Z module=Default pid=20890 caller=rpckit.go:429 level=info client=broker-broker-4 msg="Client broker-broker-4 Connected to pen-citadel at 127.0.0.1:7402"

ts=2019-03-01T04:17:17.173649Z module=citadel-integ-test pid=20890 caller=ts_data.go:145 level=error t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="Error writing the points to db. Err: partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:17:17.174054Z module=citadel-integ-test pid=20890 caller=broker_ts.go:277 level=error t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss brokeruuid=broker-4 msg="Error making PointsWrite rpc call. Err: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2, Node: dnode-2"

ts=2019-03-01T04:17:17.174124Z module=Default pid=20890 caller=actions_test.go:411 level=warn msg="write failed on broker-4, rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2"

ts=2019-03-01T04:17:17.280864Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreReadWrite completed =========================="



----------------------------------------------------------------------

FAIL: tstore_test.go:9: integTestSuite.TestTstoreReadWrite



tstore_test.go:37:

    it.runTestCase(c, &readWriteCase)

/Users/ranjith/gopath/src/github.com/pensando/sw/venice/utils/testutils/testutils.go:55:

    tb.Fatalf("\033[31m%s:%d: %s. unexpected error: %s\033[39m\n\n", filepath.Base(file), line, msg, err.Error())

... Error: [31mactions_test.go:446: ReadWriteTest: step 0/WritePoints, iter 0, action 0/WritePointPattern: Error writing points. unexpected error: rpc error: code = Unknown desc = partial write: points beyond retention policy dropped=2[39m







ts=2019-03-01T04:17:17.281143Z module=Default pid=20890 caller=integ_test.go:99 level=info msg="============================= integTestSuite.TestTstoreStoppedNodeRecovery starting =========================="

ts=2019-03-01T04:17:17.281569Z module=Default pid=20890 caller=integ_test.go:104 level=info msg="============================= integTestSuite.TestTstoreStoppedNodeRecovery completed =========================="

ts=2019-03-01T04:17:17.281836Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-4 Stopping election loop"

ts=2019-03-01T04:17:17.281883Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-4 Leader election is stopped"

ts=2019-03-01T04:17:17.281875Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-0 Stopping election loop"

ts=2019-03-01T04:17:17.281881Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-2 Stopping election loop"

ts=2019-03-01T04:17:17.281928Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-0 Leader election is stopped"

ts=2019-03-01T04:17:17.281867Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-1 Stopping election loop"

ts=2019-03-01T04:17:17.281948Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-2 Leader election is stopped"

ts=2019-03-01T04:17:17.281943Z module=Default pid=20890 caller=node.go:277 level=warn msg="dnode-1 Stopping leader loop"

ts=2019-03-01T04:17:17.281973Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-1 Leader election is stopped"

ts=2019-03-01T04:17:17.281983Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-0 at Path /venice/citadel/nodes/dnode-0"

ts=2019-03-01T04:17:17.282003Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-2 at Path /venice/citadel/nodes/dnode-2"

ts=2019-03-01T04:17:17.281937Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-4 at Path /venice/citadel/nodes/dnode-4"

ts=2019-03-01T04:17:17.281925Z module=Default pid=20890 caller=node.go:155 level=info msg="dnode-3 Stopping election loop"

ts=2019-03-01T04:17:17.282085Z module=Default pid=20890 caller=node.go:199 level=info msg="dnode-3 Leader election is stopped"

ts=2019-03-01T04:17:17.282137Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282156Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-3 at Path /venice/citadel/nodes/dnode-3"

ts=2019-03-01T04:17:17.282191Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282249Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282255Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282344Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282387Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-0 msg="dnode-0 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282455Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282443Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-3:citadel-meta-leader): canceled"

ts=2019-03-01T04:17:17.282477Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7400"

ts=2019-03-01T04:17:17.282504Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282595Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282603Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-2 msg="dnode-2 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282613Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282644Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282659Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282675Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7402"

ts=2019-03-01T04:17:17.282683Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282794Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartQuickWriteLoss nodeuuid=dnode-4 msg="dnode-4 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282844Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestKstoreNodeRestartSlow nodeuuid=dnode-3 msg="dnode-3 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.282887Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7404"

ts=2019-03-01T04:17:17.28293Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7403"

ts=2019-03-01T04:17:17.286236Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-1 Stopping rebalance loop"

ts=2019-03-01T04:17:17.287783Z module=Default pid=20890 caller=metamgr.go:436 level=warn msg="dnode-1 Stopping rebalance loop"

ts=2019-03-01T04:17:17.287854Z module=Default pid=20890 caller=node.go:108 level=info msg="Unregistering node: dnode-1 at Path /venice/citadel/nodes/dnode-1"

ts=2019-03-01T04:17:17.287855Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-4:citadel-meta-leader): canceled"

ts=2019-03-01T04:17:17.287813Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-2:citadel-meta-leader): canceled"

ts=2019-03-01T04:17:17.288012Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.288098Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.288143Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.288258Z module=citadel-integ-test pid=20890 caller=datanode.go:1099 level=info t_name=integTestSuite.TestTstoreNodeRestartLeaderQuick nodeuuid=dnode-1 msg="dnode-1 sync buffer received delete all request, replica-ids: []"

ts=2019-03-01T04:17:17.288379Z module=Default pid=20890 caller=rpckit.go:295 level=info server=pen-citadel msg="Stopping grpc server pen-citadel listening on 127.0.0.1:7401"

ts=2019-03-01T04:17:17.288998Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-1:citadel-meta-leader): canceled"

ts=2019-03-01T04:17:17.290304Z module=Default pid=20890 caller=election.go:91 level=info msg="Election(dnode-0:citadel-meta-leader): canceled"

OOPS: 5 passed, 9 skipped, 6 FAILED

--- FAIL: TestCitadelInteg (73.93s)
