<div fxFlex fxLayout="row" fxLayoutAlign="center start" class="newdestination-container">
  <!-- Limiting the size of the creation form - If it is inline, we have more room to fit in the save/cancel buttons -->
  <div fxFlex fxLayout="row" [style.max-width]="isInline ? '1300px' : '1200px'" fxLayoutAlign="start start" class="newdestination-content"
    [formGroup]="newDestination.$formGroup">

    <div fxFlex fxLayout="column">
      <div fxFlex fxLayout="row" formGroupName="meta" class="newdestination-row">
        <!-- First row-->
        <input fxFlex="300px" formControlName="name" class="newdestination-name" spellcheck="false" type="text" pInputText placeholder="Unique Destination Name...">
        <!-- Commented out as it still isn't decided whether there will be a description -->
        <!-- <input fxFlex class="newdestination-description" spellcheck="false" type="text"  pInputText  placeholder="Brief Description (optional)..."> -->

      </div>
      <div fxFlex="10px"></div> <!-- Buffer, creating as a div so there are no hiccups in the animation-->

      <ng-container *ngTemplateOutlet="syslog"></ng-container>
      <ng-container *ngIf="enableSnmpTrap">
        <ng-container *ngTemplateOutlet="snmp"></ng-container>
      </ng-container>
    </div>
    <div *ngIf="isInline" class="newdestination-buttoncontainer" fxFlex="nogrow" fxLayout="row" fxLayoutAlign="start start">
      <div fxFlex="nogrow">
        <span (click)="saveDestination()" class="global-button-primary newdestination-save">SAVE</span>
      </div>
      <div fxFlex="nogrow">
        <span (click)="cancelDestination()" class="global-button-neutral newdestination-cancel">CANCEL</span>
      </div>
    </div>
  </div>
</div>


<ng-template #syslog>
  <!-- SYSLOG Listing -->
  <ng-container [formGroup]="newDestination.$formGroup">
    <ng-container formArrayName="spec">
      <ng-container formArrayName="syslog-servers">
        <div fxFlex="nogrow" fxLayout="row">
          <div fxFlex fxLayout="column">
            <div fxFlex="nogrow" class="newdestination-syslog" fxLayout="column" [@slideInOut] *ngFor="let syslog of newDestination.$formGroup.get(['spec','syslog-servers']).controls; let index = index; let first = first"
              [formGroupName]="index">
              <div fxFlex="20px"></div> <!-- Buffer, creating as a div so there are no hiccups in the animation-->
              <div fxFlex fxLayout="row">
                <div fxFlex="nogrow" fxLayout="row wrap" fxLayoutGap="10px">
                  <div fxFlex="nogrow" fxLayout="column" class="newdestination-group">

                    <div fxFlex="30px" class="newdestination-fieldtitle">SYSLOG EXPORT CONFIGURATION</div>
                    <div fxFlex fxLayout="column">
                      <div fxFlex="nogrow" fxLayout="row">
                        <!-- Field Title -->
                        <div fxFlex="nogrow" fxLayout="column">
                          <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                            <span>Destination:</span>
                          </div>
                          <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                            <span>Protocol/Port:</span>
                          </div>
                        </div>
                        <!-- Field Values -->
                        <div fxFlex fxLayout="column">
                          <ng-container formGroupName="target">
                            <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                              <input fxFlex="nogrow" formControlName="destination" class="newdestination-host" spellcheck="false" type="text" pInputText
                                placeholder="IP address/URL...">
                            </div>
                            <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                              <input fxFlex="nogrow" formControlName="transport" class="newdestination-port" spellcheck="false" type="text" pInputText
                                placeholder="protocol/port...">
                            </div>
                          </ng-container>
                        </div>

                        <!-- Field Title -->
                        <div fxFlex="nogrow" fxLayout="column">
                          <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                            <span>Facility Override:</span>
                          </div>
                          <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                            <span>Prefix:</span>
                          </div>
                        </div>
                        <!-- Field Values -->
                        <div fxFlex="nogrow" fxLayout="column" formGroupName="config">
                          <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                            <input fxFlex="nogrow" formControlName="facility-override" class="newdestination-usertype" spellcheck="false" type="text"
                              pInputText placeholder="facility override...">
                          </div>
                          <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                            <input fxFlex="nogrow" formControlName="prefix" class="newdestination-usertype" spellcheck="false" type="text" pInputText
                              placeholder="prefix...">
                          </div>
                        </div>
                      </div>
                      <div fxFlex="30px" fxLayout="row">
                        <div class="newdestination-fieldtitle" fxFlex="none" fxLayout="row" fxLayoutAlign="start center">
                          <span>Format:</span>
                        </div>
                        <mat-radio-group fxFlex="none" fxLayout="row" fxLayoutAlgin="start center" fxLayoutGap="10px" class="newdestination-format"
                          formControlName="format">
                          <mat-radio-button fxFlex="none" color="primary" [disableRipple]="true" class="" *ngFor="let option of syslogFormatOptions"
                            [value]="option.value">
                            {{option.label}}
                          </mat-radio-button>
                        </mat-radio-group>
                      </div>
                    </div>

                  </div>

                  <div fxFlex="nogrow" fxLayout="column" class="newdestination-group" formGroupName="target">
                    <!-- Credentials -->
                    <div fxFlex="30px" class="newdestination-fieldtitle">Credentials</div>
                    <div fxFlex fxLayout="row" formGroupName="credentials">
                      
                      <mat-radio-group fxFlex="nogrow" fxLayout="column" fxLayoutGap="5px" class="newdestination-fieldtitle newdestination-credential-radio" formControlName="auth-type">
                        <mat-radio-button fxFlex="none" color="primary" [disableRipple]="true" class="" *ngFor="let option of syslogCredentialOptions"
                          [value]="option.value" >
                          {{option.label}}
                        </mat-radio-button>
                      </mat-radio-group>

                      <!-- we use getSelectedCredentialMethod(syslog) to control switch on displaying auth-type UI -->
                      <div fxFlex fxLayout="row" [ngSwitch]="getSelectedCredentialMethod(syslog)">
                        <ng-container *ngSwitchCase="'AUTHTYPE_USERNAMEPASSWORD'">
                          <!-- Field Title -->
                          <div fxFlex="nogrow" fxLayout="column">

                            <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                              <span>Username:</span>
                            </div>

                            <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                              <span>Password:</span>
                            </div>
                          </div>
                          <!-- Field Values -->
                          <div fxFlex="nogrow" fxLayout="column">
                            <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                              <input fxFlex="nogrow" formControlName="username" class="newdestination-authpassword" spellcheck="false" type="text" pInputText
                                placeholder="">
                            </div>
                            <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                              <input fxFlex="nogrow" formControlName="password" class="newdestination-authpassword" spellcheck="false" type="text" pInputText
                                placeholder="">
                            </div>
                          </div>
                        </ng-container>
                        <ng-container *ngSwitchCase="'AUTHTYPE_TOKEN'">
                          <!-- Field Title -->
                          <div fxFlex="nogrow" fxLayout="column">

                            <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                              <span>Token:</span>
                            </div>

                          </div>
                          <!-- Field Values -->
                          <div fxFlex="nogrow" fxLayout="column">
                            <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                              <input fxFlex="nogrow" formControlName="bearer-token" class="newdestination-authpassword" spellcheck="false" type="text" pInputText
                                placeholder="">
                            </div>
                          </div>
                        </ng-container>
                        <ng-container *ngSwitchCase="'AUTHTYPE_CERTS'">
                          <!-- Field Title -->
                          <div fxFlex="nogrow" fxLayout="column">

                            <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                              <span>Client Cert:</span>
                            </div>

                          </div>
                          <!-- Field Values -->
                          <div fxFlex="nogrow" fxLayout="column">
                            <div fxFlex="120px" fxLayout="row" class="newdestination-value">
                              <textarea fxFlex="nogrow" formControlName="cert-data" class="newdestination-authpassword" spellcheck="false" type="text"
                                pInputTextarea placeholder=""></textarea>
                            </div>
                          </div>

                          <!-- Field Title -->
                          <div fxFlex="nogrow" fxLayout="column">

                            <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                              <span>Key Data:</span>
                            </div>

                          </div>
                          <!-- Field Values -->
                          <div fxFlex="nogrow" fxLayout="column">
                            <div fxFlex="120px" fxLayout="row" class="newdestination-value">
                              <textarea fxFlex="nogrow" formControlName="key-data" class="newdestination-authpassword" spellcheck="false" type="text" pInputTextarea
                                placeholder=""></textarea>
                            </div>
                          </div>

                          <!-- Field Title -->
                          <div fxFlex="nogrow" fxLayout="column">

                            <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                              <span>Server Cert:</span>
                            </div>

                          </div>
                          <!-- Field Values -->
                          <div fxFlex="nogrow" fxLayout="column">
                            <div fxFlex="120px" fxLayout="row" class="newdestination-value">
                              <textarea fxFlex="nogrow" formControlName="ca-data" class="newdestination-authpassword" spellcheck="false" type="text" pInputTextarea
                                placeholder=""></textarea>
                            </div>
                          </div>
                        </ng-container>
                      </div>

                    </div>

                  </div>

                </div>
                <div fxFlex="nogrow" fxLayout="row" fxLayoutAlign="start start">
                  <div fxFlex="20"></div>
                  <div fxFlex="nogrow" fxLayout="column" fxLayoutAlign="start end" class="newdestination-fieldtitle newdestination-and">
                    <span fxFlex="nogrow" *ngIf="first" (click)="addSyslogConfig()">+ AND</span>
                    <mat-icon fxFlex="nogrow" [style.color]="'#767676'" *ngIf="newDestination.$formGroup.get(['spec','syslog-servers']).length > 1"
                      (click)="removeSyslogConfig(index)">delete</mat-icon>
                  </div>
                </div>
              </div>
              <div fxFlex="40px"></div> <!-- Buffer, creating as a div so there are no hiccups in the animation-->
            </div>
          </div>
        </div>
      </ng-container>
    </ng-container>
  </ng-container>
</ng-template>

<ng-template #snmp>
  <!-- SNMP TRAP LISTINGS -->
  <ng-container [formGroup]="newDestination.$formGroup">
    <ng-container formArrayName="spec">
      <ng-container formArrayName="snmp-trap-servers">
        <div fxFlex="nogrow" fxLayout="row">
          <div fxFlex="nogrow" fxLayout="column">
            <div fxFlex="nogrow" class="newdestination-snmp" fxLayout="column" [@slideInOut] *ngFor="let snmp of newDestination.$formGroup.get(['spec','snmp-trap-servers']).controls; let index = index; let first = first"
              [formGroupName]="index">
              <div fxFlex="20px"></div> <!-- Buffer, creating as a div so there are no hiccups in the animation-->
              <div fxFlex fxLayout="row">
                <div fxFlex="nogrow" fxLayout="row wrap" fxLayoutGap="10px">
                  <div fxFlex="nogrow" fxLayout="column" class="newdestination-group">

                    <div fxFlex="30px" class="newdestination-fieldtitle">SNMP TRAP CONFIGURATION</div>
                    <div fxFlex fxLayout="row">
                      <!-- Field Title -->
                      <div fxFlex="nogrow" fxLayout="column">
                        <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                          <span>Host:</span>
                        </div>
                        <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                          <span>Port:</span>
                        </div>
                      </div>
                      <!-- Field Values -->
                      <div fxFlex fxLayout="column">
                        <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                          <input fxFlex="nogrow" formControlName="host" class="newdestination-host" spellcheck="false" type="text" pInputText placeholder="">
                        </div>
                        <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                          <input fxFlex="nogrow" formControlName="port" class="newdestination-port" spellcheck="false" type="text" pInputText placeholder="">
                        </div>
                      </div>

                      <!-- Field Title -->
                      <div fxFlex="nogrow" fxLayout="column">
                        <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                          <span>Version:</span>
                        </div>

                        <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                          <span>User Type:</span>
                        </div>
                      </div>
                      <!-- Field Values -->
                      <div fxFlex="nogrow" fxLayout="column">
                        <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                          <p-dropdown fxFlex="nogrow" class="newdestination-version" formControlName="version" styleClass="newdestination-font" [options]="versionOptions"></p-dropdown>
                        </div>
                        <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                          <input fxFlex="nogrow" formControlName="community-or-user" class="newdestination-usertype" spellcheck="false" type="text"
                            pInputText placeholder="">
                        </div>
                      </div>
                    </div>
                  </div>

                  <div fxFlex="nogrow" fxLayout="column" class="newdestination-group" formGroupName="auth-config">
                    <!-- Authentification -->
                    <div fxFlex="30px" class="newdestination-fieldtitle">AUTHENTIFICATION</div>
                    <div fxFlex fxLayout="row">
                      <!-- Field Title -->
                      <div fxFlex="nogrow" fxLayout="column">

                        <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                          <span>Algorithm:</span>
                        </div>

                        <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                          <span>Password:</span>
                        </div>
                      </div>
                      <!-- Field Values -->
                      <div fxFlex="nogrow" fxLayout="column">
                        <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                          <p-dropdown fxFlex="nogrow" class="newdestination-authalgo" formControlName="algo" styleClass="newdestination-font" [options]="authAlgoOptions"></p-dropdown>
                        </div>
                        <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                          <input fxFlex="nogrow" formControlName="password" class="newdestination-authpassword" spellcheck="false" type="text" pInputText
                            placeholder="">
                        </div>
                      </div>
                    </div>
                  </div>

                  <div fxFlex="nogrow" fxLayout="column" class="newdestination-group" formGroupName="privacy-config">
                    <!-- Encryption -->
                    <div fxFlex="30px" class="newdestination-fieldtitle">ENCRYPTION</div>
                    <div fxFlex fxLayout="row">
                      <!-- Field Title -->
                      <div fxFlex="nogrow" fxLayout="column">
                        <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                          <span>Algorithm:</span>
                        </div>

                        <div class="newdestination-fieldtitle" fxFlex="30px" fxLayout="row" fxLayoutAlign="start center">
                          <span>Password:</span>
                        </div>
                      </div>
                      <!-- Field Values -->
                      <div fxFlex="nogrow" fxLayout="column">
                        <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                          <p-dropdown fxFlex="nogrow" class="newdestination-encryptalgo" formControlName="algo" styleClass="newdestination-font" [options]="encryptAlgoOptions"></p-dropdown>
                        </div>
                        <div fxFlex="30px" fxLayout="row" class="newdestination-value">
                          <input fxFlex="nogrow" formControlName="password" class="newdestination-encryptpassword" spellcheck="false" type="text" pInputText
                            placeholder="">
                        </div>
                        <div fxFlex="30px">
                          <span class="global-button-primary newdestination-testconnectionbutton">TEST CONNECTION</span>
                        </div>
                      </div>
                    </div>

                  </div>

                </div>
                <div fxFlex="nogrow" fxLayout="row" fxLayoutAlign="start start">
                  <div fxFlex="20"></div>
                  <div fxFlex="nogrow" fxLayout="column" fxLayoutAlign="start end" class="newdestination-fieldtitle newdestination-and">
                    <span fxFlex="nogrow" *ngIf="first" (click)="addSnmpTrapConfig()">+ AND</span>
                    <mat-icon fxFlex="nogrow" [style.color]="'#767676'" *ngIf="newDestination.$formGroup.get(['spec','snmp-trap-servers']).length > 1"
                      (click)="removeSnmpTrapConfig(index)">delete</mat-icon>
                  </div>
                </div>
              </div>
              <div fxFlex="40px"></div> <!-- Buffer, creating as a div so there are no hiccups in the animation-->
            </div>
          </div>
          <div fxFlex></div> <!-- For making the border line stop-->
        </div>
      </ng-container>
    </ng-container>
  </ng-container>
</ng-template>