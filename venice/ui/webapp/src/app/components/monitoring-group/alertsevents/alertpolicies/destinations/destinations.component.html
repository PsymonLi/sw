<div fxLayout="column" class="destinations-widget">
    <app-newdestination [@slideInOut] (formClose)="creationFormClose()" fxFlex="noshrink" *ngIf="creatingMode"></app-newdestination>
    <div fxFlex class="destinations-tablecontainer">
      <ng-container *ngTemplateOutlet="Header"></ng-container>
      <ng-container *ngTemplateOutlet="Table"></ng-container>
      <div *ngIf="creatingMode || editingMode" class="destinations-overlay"></div>
    </div>
</div>

<!-- TABLE HEADER -->
<ng-template #Header>
  <app-tableheader title="Destinations" [total]="count" [icon]="headerIcon" width="250px">
    <div class="destinations-search" fxFlex="fxFlex" fxLayoutAlign="start center" >
      Find destination by: 
      <mat-form-field fxFlex="nogrow" floatLabel="never">
        <input matInput placeholder="Name" (input)="destinationsTurboTable?.filterGlobal($event.target.value, 'contains')">
      </mat-form-field>
    </div>
  </app-tableheader>
</ng-template>

<ng-template #Table>
    <p-table class="global-primeng-table" [columns]="cols" [value]="destinations" 
          [(selection)]="selectedDestinationPolicy" dataKey="meta.name" [rows]="15" 
          [scrollable]="true" scrollHeight="800px" #destinationsTable [responsive]="true" 
          [globalFilterFields]="globalFilterFields" [loading]="loading" [resizableColumns]="true" rowExpandMode="single">
       <!-- Table Header -->
       <ng-template pTemplate="header" let-columns>
         <tr>
           <th *ngFor="let col of cols; " [pSortableColumn]="col.sortable? col.field : ''" [class]="col.class" [colSpan]=" col.isLast ? 2 : 1">
              {{col.header}}
              <p-sortIcon *ngIf="col.sortable" style="float: right;" [field]="col.field"></p-sortIcon>
          </th>
         </tr>
       </ng-template>
       <!-- Table Body -->
       <ng-template pTemplate="body" let-rowData>
         <tr [ngClass]="expandedRowData?.meta.name === rowData.meta.name ? 'destinations-rowhighlight': ''" [pSelectableRow]="rowData">
           <td *ngFor="let col of cols" [ngSwitch]="col.field" [class]="col.class">
            <ng-container *ngSwitchDefault>
              {{displayColumn(rowData, col)}}
            </ng-container>
          </td>
           <td class="global-column-action">
              <div class="global-column-action-icon-container" fxLayout="row" fxLayoutGap="5px">
              <mat-icon title="Edit destination" class="global-table-action-icon" (click)="onUpdateRecord($event, rowData)">edit</mat-icon>
              <mat-icon title="Delete destination" class="global-table-action-icon" (click)="onDeleteRecord($event, rowData)">delete</mat-icon>
              </div>
           </td>
         </tr>
       </ng-template>
       <ng-template pTemplate="rowexpansion" let-rowData let-columns="columns">
         <tr class="destinations-rowexpand-tr">
              <td [attr.colspan]="columns.length + 1">
                <div [@slideInOut] (@slideInOut.done)="rowExpandAnimationComplete($event)" *ngIf="editingMode" class="destinations-rowexpand">
                  <app-newdestination [destinationData]="rowData"  [isInline]="true" (formClose)="onUpdateRecord($event, rowData)"></app-newdestination>
                </div>
              </td>
         </tr>
      </ng-template>
     </p-table>
  </ng-template>