<app-pagebody [icon]="bodyicon" [header]="selectedId">
  <div fxFlex="none" fxLayout="column">
    <div fxFlex fxLayout="row wrap" class="naplesdetail-card-container">
      <ng-container *ngTemplateOutlet="detailsTable"></ng-container>
      <ng-container *roleGuard="'metricsquery_read'">
        <ng-container *ngFor="let cardData of heroCards">
          <app-herocard fxFlex="nogrow"
                        [title]="cardData.title"
                        [firstStat]="cardData.firstStat"
                        [secondStat]="cardData.secondStat"
                        [thirdStat]="cardData.thirdStat"
                        [backgroundIcon]="cardData.backgroundIcon"
                        [themeColor]="cardData.themeColor"
                        [icon]="cardData.icon"
                        [data]="cardData.data"
                        [arrowDirection]="cardData.arrowDirection"
                        [lastUpdateTime]="lastUpdateTime"
                        [cardState]="cardData.cardState">
          </app-herocard>
        </ng-container>
      </ng-container>
    </div>
  </div>
  <div *roleGuard="{opt: ['monitoringAlert_read', 'eventsevent_read']}" fxFlex
       class="naplesdetail-alertsevents-container">
    <app-shared-alertsevents [selector]="alertseventsSelector"></app-shared-alertsevents>
  </div>
  <!-- Deletion screen overlay displays when the policy we are viewing is deleted -->
  <!-- Missing screen overlay displays when the policy does not exist-->
  <div #overlay *ngIf="showDeletionScreen || showMissingScreen" fxLayout="row"
       fxLayoutAlign="center stretch" class="naplesdetail-overlay">
    <div fxFlex="50%" fxLayout="column" class="naplesdetail-overlay-content">
      <div fxFlex='20%'></div>
      <div *ngIf="showDeletionScreen" fxFlex='15%' class="naplesdetail-deleted-node"></div>
      <div *ngIf="showMissingScreen" fxFlex='15%' class="naplesdetail-missing-node"></div>
      <div *ngIf="showDeletionScreen" fxFlex="none" class="naplesdetail-overlay-text">
        {{ selectedId }} has been deleted
      </div>
      <div *ngIf="showMissingScreen" fxFlex="none" class="naplesdetail-overlay-text">
        {{ selectedId }} does not exist
      </div>
      <div fxFlex="5%"></div>
      <div fxFlex="none" fxLayout="row" fxLayoutAlign="center stretch" fxLayoutGap="40px">
        <button fxFlex="none" class="global-button-primary naplesdetail-overlay-button"
                routerLink="../">NAPLES
          OVERVIEW</button>
        <button fxFlex="none" class="global-button-primary naplesdetail-overlay-button"
                (click)="routeToHomepage()">HOMEPAGE</button>
      </div>
    </div>
  </div>
</app-pagebody>

<ng-template #detailsTable>
  <div fxFlex="none" fxLayout="column" class="naplesdetail-node-table-container">
    <div fxFlex="none" fxLayout="column" class="naplesdetail-details">
      <!-- <div fxFlex="none" class="cluster-details-title"> Naples Detail </div> -->
      <div fxFlex="none" fxLayout="row">
        <!-- Field titles -->
        <div fxFlex="50" fxLayout="column">
          <div class="naplesdetail-node-fieldtitle" fxFlex="30px" fxLayout="row"
               fxLayoutAlign="start center">
            <div>MAC Address:</div>
          </div>
          <div class="naplesdetail-node-fieldtitle" fxFlex="30px" fxLayout="row"
               fxLayoutAlign="start center">
            <div>IP Address:</div>
          </div>
          <div class="naplesdetail-node-fieldtitle" fxFlex="30px" fxLayout="row"
               fxLayoutAlign="start center">
            <div>Host Name:</div>
          </div>
          <div class="naplesdetail-node-fieldtitle" fxFlex="30px" fxLayout="row"
               fxLayoutAlign="start center">
            <div>Phase</div>
          </div>
          <div class="naplesdetail-node-fieldtitle" fxFlex="30px" fxLayout="row"
               fxLayoutAlign="start center">
            <div>Serial Number:</div>
          </div>
          <div class="naplesdetail-node-fieldtitle" fxFlex="30px" fxLayout="row"
               fxLayoutAlign="start center">
            <div>Version:</div>
          </div>
          <div class="naplesdetail-node-fieldtitle" fxFlex="30px" fxLayout="row"
               fxLayoutAlign="start center">
            <div>
              Labels:
              <mat-icon matTooltip="Edit Label" class="global-table-action-icon"
                        (click)="editLabels($event)"
                        *roleGuard="'clustersmartnic_update'">edit
              </mat-icon>
            </div>
          </div>
        </div>
        <!-- Values -->
        <div fxFlex="none" fxLayout="column">
          <div fxFlex="30px" fxLayout="row" fxLayoutAlign="start center"
               class="naplesdetail-node-value">
            <div class="naplesdetail-details-panel-virtual-ip">
              {{ selectedObj?.status['primary-mac'] }}</div>
          </div>
          <div fxFlex="30px" fxLayout="row" fxLayoutAlign="start center"
               class="naplesdetail-node-value">
            <div class="naplesdetail-details-panel-virtual-ip">
              {{ selectedObj?.status['ip-config'] ? selectedObj?.status['ip-config']["ip-address"] : '' }}
            </div>
          </div>
          <div fxFlex="30px" fxLayout="row" fxLayoutAlign="start center"
               class="naplesdetail-node-value">
            <div class="naplesdetail-details-panel-ntp-servers">
              {{ selectedObj?.spec['hostname'] }}
            </div>
          </div>
          <div fxFlex="30px" fxLayout="row" fxLayoutAlign="start center"
               class="naplesdetail-node-value">
            <div *ngIf="selectedObj" class="naplesdetail-details-panel-last-leader-transition-time"
                 [matTooltip]="selectedObj.status['admission-phase'] === 'REJECTED' || selectedObj.status['admission-phase'] === 'PENDING' ? selectedObj.status['adm-phase-reason'] : ''">
              {{ selectedObj ? admissionPhaseEnum[selectedObj.status['admission-phase']] : '' }}
              <mat-icon *ngIf="selectedObj.status['admission-phase'] === 'REJECTED'" fxFlex="nogrow"
                        [inline]="true"
                        class="global-alert-warning-icon naplesdetail-phase-icon">error</mat-icon>
              <mat-icon *ngIf="selectedObj.status['admission-phase'] === 'PENDING'" fxFlex="nogrow"
                        [inline]="true"
                        class="global-alert-info-icon naplesdetail-phase-icon">notifications
              </mat-icon>
            </div>
          </div>
          <div fxFlex="30px" fxLayout="row" fxLayoutAlign="start center"
               class="naplesdetail-node-value">
            <div class="naplesdetail-panel-auto-admit-nics">
              {{ selectedObj?.status['serial-num'] }}
            </div>
          </div>
          <div fxFlex="30px" fxLayout="row" fxLayoutAlign="start center"
               class="naplesdetail-node-value">
            <div class="naplesdetail-panel-version">
              {{ selectedObj?.status['smartNicVersion'] }}
            </div>
          </div>
          <div fxFlex="" fxLayout="row" fxLayoutAlign="start center"
               class="naplesdetail-node-value">
            <div class="naplesdetail-panel-labels" fxFlex="200px">
              <p-table [value]="genKeys()" *ngIf="ifLabelExists()" [autoLayout]="true">
                <ng-template pTemplate="header">
                  <tr>
                    <th>Key</th>
                    <th>Value</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-key>
                  <tr>
                    <td style="word-break: break-all;">{{key}}</td>
                    <td style="word-break: break-all;">{{this.selectedObj.meta.labels[key]}}</td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
            <app-labeleditor [data]="selectedObj" [metadata]="labelEditorMetaData"
                             (saveEmitter)="handleEditSave($event)"
                             (cancelEmitter)="handleEditCancel($event)"
                             [inLabelEditMode]="inLabelEditMode"></app-labeleditor>

          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
