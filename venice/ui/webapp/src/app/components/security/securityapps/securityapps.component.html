<app-pagebody class="securityapps" header="Security Apps Overview" [icon]="bodyicon">

  <div fxFlex class="securityapps-table-container">
    <ng-container *ngTemplateOutlet="DataTable"></ng-container>
  </div>

</app-pagebody>

<ng-template #DataTable>
  <app-lazyrender [data]="securityApps" [rows]="28" [virtualRowHeight]="36" [runDoCheck]="true">
    <p-table #securityappsTable class="global-primeng-table-lazyload" [columns]="cols"
             dataKey="meta.name" [responsive]="true"
             sortField="meta.mod-time" [sortOrder]='-1'
             [resizableColumns]="true"
             rowExpandMode="single">
      <!-- Table Caption -->
      <ng-template pTemplate="caption">
        <app-tableheader title="Security Apps" [total]="securityApps.length" [icon]="tableIcon"
                         width="250px">
        </app-tableheader>
      </ng-template>
      <!-- Table Header -->
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th *ngFor="let col of cols" [pSortableColumn]="col.sortable? col.field : ''"
              [class]="col.class">
            <app-sorticon [isSortable]="col.sortable" [field]="col.field">{{col.header}}
            </app-sorticon>
          </th>
        </tr>
      </ng-template>
      <!-- Table Body -->
      <ng-template pTemplate="body" let-rowData let-expanded="expanded">
        <tr>

          <td *ngFor="let col of cols" [ngSwitch]="col.field" [class]="col.class"
              (click)="onSecurityAppsTableRowClick($event, rowData)"
              title="Click to expand or collapse row">
            <div *ngSwitchCase="'meta.mod-time'">
              {{rowData.meta['mod-time'] | PrettyDate }}
            </div>
            <div *ngSwitchCase="'meta.creation-time'">
              {{rowData.meta['creation-time'] | PrettyDate }}
            </div>
            <div *ngSwitchCase="'spec.alg.type'">
              {{displaySpecAlgType(rowData, col)}}
            </div>
            <ng-container *ngSwitchDefault>
              {{displayColumn(rowData, col)}}
            </ng-container>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="rowexpansion" let-rowData let-columns="cols">
        <tr *ngIf="selectedSecurityApp" class="global-rowexpand  securityapps-rowexpand-tr">
          <td [attr.colspan]="cols.length ">
            <div class="securityapps-detail-div securityapps-rowexpand">
              <pre>{{displaySecurityApp()}}</pre>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </app-lazyrender>
</ng-template>
