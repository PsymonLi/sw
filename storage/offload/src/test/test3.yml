svc_chains:
  - svc_chain:
      idx: 1
      input:
        pattern: ababababababababababababababababababababababababababababababababababababab1234
        len: 2000
      ops:
        - compress:
            flags: 'zero_pad,insert_header'
            hdr_fmt_idx: 1
            hdr_algo: 1
            threshold_delta: 8
            output_file: '%chain_id%_compressed_1.bin'
        - decompress:
            flags: 'header_present'
            hdr_fmt_idx: 1
            output_file: '%chain_id%_decompressed.bin'
        - compress:
            flags: 'zero_pad,insert_header'
            hdr_fmt_idx: 1
            hdr_algo: 1
            threshold_delta: 8
            output_file: '%chain_id%_compressed_2.bin'
  - svc_chain:
      idx: 2
      input:
        pattern: ababababababababababababababababababababababababababababababababababababab1234
        len: 2000
      ops:
        - compress:
            flags: 'zero_pad,insert_header'
            hdr_fmt_idx: 1
            hdr_algo: 1
            threshold_delta: 8
            output_file: '%test_id%_%chain_id%_cp.bin'
        - chksum:
            algo_type: crc32c
            flags: per_block
            output_file: '%test_id%_%chain_id%_crc32c.bin'
        - encrypt:
            algo_type: xts
            output_file: '%test_id%_%chain_id%_cp_enc.bin'
  - svc_chain:
      idx: 3
      input:
        file: '2_2_cp_enc.bin'
      ops:
        - decrypt:
            algo_type: xts
            output_file: '%test_id%_%chain_id%_cp.bin'
        - chksum:
            algo_type: crc32c
            flags: per_block
            output_file: '%test_id%_%chain_id%_crc32c.bin'
        - decompress:
            flags: 'header_present'
            hdr_fmt_idx: 1
            output_file: '%test_id%_%chain_id%_dc.bin'
tests:
  - test:
      idx: 1
      svc_chains: 1
      repeat: '$iter_high'
      batch_depth: 10
      validations:
        - data_compare:
            idx: 1
            file1: '%chain_id%_compressed_1.bin'
            file2: '%chain_id%_compressed_2.bin'
  - test:
      idx: 2
      svc_chains: 2,3
      repeat: '$iter_low'
      batch_depth: 10
      validations:
        - data_compare:
            idx: 1
            file1: '%test_id%_2_cp.bin'
            file2: '%test_id%_3_cp.bin'
            len: 200
        - data_compare:
            idx: 2
            file1: '1_decompressed.bin'
            file2: '%test_id%_3_dc.bin'
        - retcode_compare:
            idx: 3
            svc_chain: 2
            retcode: 0
            svc_retcodes: 0,0,0
        - retcode_compare:
            idx: 4
            svc_chain: 3
            retcode: 0
            svc_retcodes: 0,0,0
        - data_compare:
            idx: 5
            file1: '%test_id%_2_crc32c.bin'
            file2: '%test_id%_3_crc32c.bin'
