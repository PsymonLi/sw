package(default_visibility = ["//visibility:public"])

licenses(["notice"])  # MIT license

cc_binary(
        name = "model_server",
        srcs = [ 
                 "model_server.cc",
                 "sim_server.c",
                 "zmq_wait.c",
                 "lib_driver.cc",
                 "lib_driver.hpp",
                 "zmq_wait.h",
               ],
        copts = [ "-g",
                  "-Wno-unused-variable",
                  "-Wno-error=unused-variable",
                  "-I/usr/include/python2.7",
                  "-I.",
                  "-Iplatform",
                  "-Inic/gen/proto/hal",
                  "-Iplatform/src/lib/misc/include",
                  "-Iplatform/src/lib/pciehsvc/include",
                  "-Iplatform/src/sim/libsimlib/include",
                  "-Iplatform/src/sim/libsimdev/include",
                ],
        linkopts = [
                     "-lsknobs",
                     "-lutil",
                     "-lgmp",
                     "-lgmpxx",
                     "-lpython2.7",
                     "-lmodel_cc",
                     "-lcommon_cc",
                     "-lmpuobj",
                     "-lJudy",
                     "-lsknobs",
                     "-ltop_csr_compile",
                     "-lcapsim",
                     "-lisa",
                     "-lasmsym",
                     "-lzmq",
                     "-lcapisa",
                     "-lcrypto",
                     "-lpthread",
                     "-ldl",
                     "-lz",
                     "-lhalproto",
                     "-L ./nic/model_sim/libs",
        ],
        deps = [
                "//platform/src/sim/libsimlib/include:libsimlib_hdrs",
                "//platform/src/sim/libsimlib/src:libsimlib",
                "//platform/src/sim/libsimdev/include:libsimdev_hdrs",
                "//platform/src/sim/libsimdev/src:libsimdev",
                "//platform/src/lib/misc/include:libmisc_hdrs",
                "//platform/src/lib/pciehost/src:libpciehost",
                "//platform/src/lib/pciehsvc/include:libpciehsvc_hdrs",
                "//platform/src/lib/pciehw/src:libpciehw",
                "//platform/drivers/linux/eth/ionic:liblinuxionic_hdrs",
                "//nic:halproto",
                "//nic:libprotobuf",
                "//nic:gen_proto_includes",
                "//nic:grpc_includes",
                "//nic:google_includes",
                "//nic/model_sim/include:modelsim_includes",
                "//nic/model_sim:cap_model_libs",
                "//nic/utils/host_mem:host_mem_includes",
                "//nic/utils/bm_allocator:bm_allocator",
                "//nic/hal/third-party:grpc",
                "//nic/hal/third-party:libsknobs",
        ],
)

