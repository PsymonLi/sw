# Equinix 2node baremetal topology specification
meta:
    id: EQUINIX_HOST_MODE

device:
    id          : 1
    mode        : host
    stack       : ipv4
    bridging    : false
    learning    : false
    overlay     : false
    ipaddress   : '10.10.10.10'
    gateway     : '1.0.0.1'
    macaddress  : macaddr/0000.bbbb.bbb1
    encap       : vxlan
    origin      : implicitly-created

uplink:
    - entry:
        id      : uplink0
        port    : 1
        mode    : switch
        status  : UP
        origin  : implicitly-created
    - entry:
        id      : uplink1
        port    : 2
        mode    : switch
        status  : UP
        origin  : implicitly-created

vpc:
    - id         : 100
      stack      : ipv4
      count      : 1
      type       : underlay
      origin     : implicitly-created

      interface:
        - iid           : 1
          iftype        : l3
          ifadminstatus : UP
          ipprefix      : '1.1.0.103\24'
          macaddress    : macaddr/00ae.cd00.14ce
          portid        : 1
          encap         : none
          origin        : implicitly-created
        - iid           : 2
          iftype        : l3
          ifadminstatus : UP
          ipprefix      : '1.2.0.103\24'
          macaddress    : macaddr/00ae.cd00.14cd
          portid        : 2
          encap         : none
          origin        : implicitly-created
        - iid           : 3
          iftype        : loopback
          ifadminstatus : UP
          ipprefix      : '10.10.10.10\32'
          macaddress    : macaddr/0000.0000.0000
          portid        : 0
          encap         : none
          origin        : implicitly-created
          updateneeded  : true

      nexthop:
        - id         : 1
          count      : 1
          type       : underlay
          l3intfid   : 1
          macaddress : macaddr/00ae.cd00.4fde
          origin     : implicitly-created
        - id         : 2
          count      : 1
          type       : underlay
          l3intfid   : 2
          macaddress : macaddr/00ae.cd00.4fdd
          origin     : implicitly-created

      bgpglobal:
        - localasn      : 100
          routerid      : 10.10.10.10

      bgppeer:
        - peeraddr      : 10.1.0.2  # underlay bgp peer 1
          localaddr     : 10.1.0.1
          remoteasn     : 600
          bgppeeraf:
              afi       : ipv4
              safi      : unicast
        - peeraddr      : 10.2.0.2  # underlay bgp peer 2
          localaddr     : 10.2.0.1
          remoteasn     : 600
          bgppeeraf:
              afi       : ipv4
              safi      : unicast

    - id         : 1
      stack      : ipv4
      count      : 1
      type       : tenant

      tunnel:
        - id         : 1
          count      : 1
          type       : underlay
          srcaddr    : '1.0.0.3'
          dstaddr    : '1.0.0.2'
          macaddress : macaddr/0000.bbbb.bbb1
          encap      : vxlan
          nhid       : 1

      subnet:
        - id               : 1
          count            : 1
          v4prefixlen      : 24
          v6prefixlen      : 64
          v4prefix         : '2.1.0.0\24'
          hostifidx        : 0x80000048
          fabricencap      : vxlan
          fabricencapvalue : 202
          v4routerip       : '2.1.0.0'
          vroutermac       : macaddr/0055.0100.0001

      nexthop:
        - id         : 3
          type       : overlay
          count      : 1
          tunnelid   : 1
          origin     : discovered

      routetbl:
        - type      : specific
          count     : 1
          routetype : disjoint
          teptype   : underlay
          v4routes  :
            - '10.10.0.0\16'
            - '50.5.0.0\16'

      policy:
        - type       : specific
          policytype : default
          direction  : bidir
