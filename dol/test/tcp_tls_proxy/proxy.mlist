# Feature Test Modules List
#
feature:
    id          : proxy
    sub         : proxy
    package     : test.tcp_tls_proxy
    module      : None
    enable      : True
    ignore      : False

modules:
    - module:
        name    : IN_ORDER_PKT_NOT_TO_SERQ_V4
        spec    : one_pkt.testspec
        module  : in_order
        args    :
            maxflows : 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : IN_ORDER_PKT_NOT_TO_SERQ_V4_ACK
        spec    : one_pkt_ack.testspec
        module  : in_order
        args    :
            maxflows : 1
            send_ack : 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : IN_ORDER_PKT_NOT_TO_SERQ_V4_DEL_ACK_TIMER
        spec    : one_pkt_ack.testspec
        module  : in_order
        args    :
            maxflows : 1
            send_ack : 1
            test_timer : 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : IN_ORDER_FLOWS_NOT_TO_SERQ_V4
        spec    : one_pkt.testspec
        module  : in_order
        args    :
            maxflows: 2
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : IN_ORDER_PKT_NOT_TO_SERQ_V6
        spec    : one_pkt.testspec
        module  : in_order
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV6

    - module:
        name    : IN_ORDER_FLOWS_NOT_TO_SERQ_V6
        spec    : one_pkt.testspec
        module  : in_order
        args    :
            maxflows: 2
        iterate :
            - flow: filter://type=IPV6

    - module:
        name    : IN_ORDER_PKT_NOT_TO_SERQ_VXLAN
        spec    : one_pkt_vxlan.testspec
        module  : in_order
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : IN_ORDER_FLOWS_NOT_TO_SERQ_VXLAN
        spec    : one_pkt_vxlan.testspec
        module  : in_order
        args    :
            maxflows: 2
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_SERQ_V4
        spec    : one_pkt.testspec
        module  : pkt_to_serq
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : OOO_PKT_TO_SERQ_V4
        spec    : ooo_pkt.testspec
        module  : pkt_to_serq
        args    :
            maxflows: 1
            ooo_seq_delta: 1000
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : OOO_PKT_IN_ORDER_PKT_TO_SERQ_V4
        spec    : ooo_pkt_in_order_pkt.testspec
        module  : pkt_to_serq_ooo_in_order
        args    :
            maxflows: 1
            ooo_seq_delta: 1000
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : FLOWS_TO_SERQ_V4
        spec    : one_pkt.testspec
        module  : pkt_to_serq
        args    :
            maxflows: 2
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_SERQ_V6
        spec    : one_pkt.testspec
        module  : pkt_to_serq
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV6

    - module:
        name    : MULTIPLE_PKTS_TO_SERQ
        spec    : multiple_pkts_to_serq.testspec
        module  : pkt_to_serq
        args    :
            maxflows : 1
            num_pkts : 2
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_SERQ_ATOMIC_STATS
        spec    : one_pkt.testspec
        module  : pkt_to_serq
        args    :
            maxflows: 2
            atomic_stats : 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_BRQ
        package : test.tcp_tls_proxy
        module  : pkt_to_brq
        spec    : one_pkt.testspec
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : FLOWS_TO_BRQ
        package : test.tcp_tls_proxy
        module  : pkt_to_brq
        spec    : one_pkt.testspec
        args    :
            maxflows: 2
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_BSQ_AES128_GCM_ENCRYPT
        package : test.tcp_tls_proxy
        module  : pkt_to_bsq_encrypt
        spec    : one_pkt.testspec
        args    :
            maxflows: 1
            same_flow : 1
            key_size : 16
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_BSQ_AES128_GCM_DECRYPT
        package : test.tcp_tls_proxy
        module  : pkt_to_bsq_decrypt
        spec    : one_tls_aes128_gcm_record_pkt.testspec
        args    :
            maxflows: 1
            key_size : 16
        iterate  :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_BSQ_AES256_GCM_ENCRYPT
        package : test.tcp_tls_proxy
        module  : pkt_to_bsq_encrypt
        spec    : one_pkt.testspec
        args    :
            maxflows: 1
            same_flow : 1
            key_size : 32
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_BSQ_AES256_GCM_DECRYPT
        package : test.tcp_tls_proxy
        module  : pkt_to_bsq_decrypt
        spec    : one_tls_aes256_gcm_record_pkt.testspec
        args    :
            maxflows: 1
            key_size : 32
        iterate  :
            - flow: filter://type=IPV4

    - module:
        name    : UL_TO_UL_BYPASS_BARCO_SAME_FLOW
        spec    : uplink_to_uplink.testspec
        module  : pkt_to_p4
        args    :
            bypass_barco : 1
            maxflows : 1
            same_flow : 1
        iterate :
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              segment   : filter://native=False

    - module:
        name    : UL_TO_UL_BYPASS_BARCO
        spec    : uplink_to_uplink.testspec
        module  : pkt_to_p4
        args    :
            bypass_barco : 1
            maxflows : 1
        iterate :
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=IFLOW
              segment   : filter://native=False
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=RFLOW
              segment   : filter://native=False
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=IFLOW
              segment   : filter://native=True
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=RFLOW
              segment   : filter://native=True
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              srcseg    : filter://fabencap=VXLAN
              dstseg    : filter://fabencap=VXLAN

    - module:
        name    : UL_TO_UL_BYPASS_BARCO_SEND_ACK
        spec    : uplink_to_uplink_ack.testspec
        module  : pkt_to_p4
        args    :
            bypass_barco : 1
            maxflows : 1
            send_ack : 1
        iterate :
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              segment   : filter://native=False
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              segment   : filter://native=True

    - module:
        name    : UL_TO_UL_BYPASS_BARCO_DEL_ACK_TIMER
        spec    : uplink_to_uplink_ack.testspec
        module  : pkt_to_p4
        args    :
            bypass_barco : 1
            send_ack : 1
            test_timer : 1

    - module:
        name    : UL_TO_UL_BYPASS_BARCO_CANCEL_DEL_ACK_TIMER
        spec    : uplink_to_uplink_cancel_ack.testspec
        module  : pkt_to_p4
        args    :
            bypass_barco : 1
            send_ack : 1
            test_timer : 1

    - module:
        name    : UL_TO_UL_BYPASS_BARCO_FREE_RNMDR
        spec    : uplink_to_uplink.testspec
        module  : pkt_to_p4
        args    :
            free_rnmdr : 1
            bypass_barco : 1
            maxflows : 1

    - module:
        name    : UL_TO_HOST_BYPASS_BARCO_SAME_FLOW
        spec    : uplink_to_host.testspec
        module  : pkt_to_p4
        args :
              bypass_barco : 1
              maxflows : 1
              same_flow : 1
        iterate :
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              segment   : filter://native=False

    - module:
        name    : UL_TO_HOST_BYPASS_BARCO
        spec    : uplink_to_host.testspec
        module  : pkt_to_p4
        args :
              bypass_barco : 1
              maxflows : 1
        iterate :
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=IFLOW
              segment   : filter://native=False
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=RFLOW
              segment   : filter://native=False
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=IFLOW
              segment   : filter://native=True
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=RFLOW
              segment   : filter://native=True

    - module:
        name    : UL_TO_HOST_BYPASS_BARCO_SEND_ACK
        spec    : uplink_to_host_ack.testspec
        module  : pkt_to_p4
        args    :
            bypass_barco : 1
            maxflows : 1
            send_ack : 1
        iterate :
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              segment   : filter://native=False
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              segment   : filter://native=True

    - module:
        name    : HOST_TO_UL_BYPASS_BARCO_SAME_FLOW
        spec    : host_to_uplink.testspec
        module  : pkt_to_p4
        args :
              bypass_barco : 1
              maxflows : 1
              same_flow : 1
        iterate :
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              segment   : filter://native=False

    - module:
        name    : HOST_TO_UL_BYPASS_BARCO
        spec    : host_to_uplink.testspec
        module  : pkt_to_p4
        args :
              bypass_barco : 1
              maxflows : 1
        iterate :
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=IFLOW
              segment   : filter://native=False
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=RFLOW
              segment   : filter://native=False
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=IFLOW
              segment   : filter://native=True
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2,direction=RFLOW
              segment   : filter://native=True

    - module:
        name    : HOST_TO_UL_BYPASS_BARCO_SEND_ACK
        spec    : host_to_uplink_ack.testspec
        module  : pkt_to_p4
        args    :
            bypass_barco : 1
            maxflows : 1
            send_ack : 1
        iterate :
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              segment   : filter://native=False
            - flow      : filter://type=IPV4,proto=TCP,label=TCP-PROXY,fwtype=L2
              segment   : filter://native=True

    - module:
        name    : PKT_TO_SESQ
        package : test.tcp_tls_proxy
        module  : pkt_to_sesq
        spec    : one_pkt.testspec
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4
    - module:
        name    : TLS_HANDSHAKE_RX
        package : test.tcp_tls_proxy
        module  : tls_handshake_rx
        spec    : tls_handshake.testspec
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_ARQ
        package : test.tcp_tls_proxy
        module  : pkt_to_arq
        spec    : pkt_to_arq.testspec
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_ARQ_TO_UPLINK
        package : test.tcp_tls_proxy
        module  : pkt_to_arq_to_uplink
        spec    : pkt_to_arq_to_uplink.testspec
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : SYN_ACK_TO_ARQ
        package : test.tcp_tls_proxy
        module  : syn_ack_to_arq
        spec    : one_pkt.testspec
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4


    - module:
        name    : TLS_HANDSHAKE_TX
        package : test.tcp_tls_proxy
        module  : tls_handshake_tx
        spec    : tls_handshake.testspec
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : ACK_SYN_ACK_TX
        enable  : False
        package : test.tcp_tls_proxy
        module  : ack_syn_ack_tx
        spec    : ack_syn_ack_tx.testspec
        args    :
            maxflows    : 1
            send_ack    : 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : PKT_TO_LKL_V4
        enable  : False
        package : test.tcp_tls_proxy
        module  : pkt_to_lkl
        spec    : pkt_to_lkl.testspec
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : CRYPTO_API_ASYM_ECC_POINT_MUL_P256
        package : test.tcp_tls_proxy
        module  : crypto_apis
        spec    : no_pkt.testspec
        args    :
            api:    CRYPTO_API_ASYM_ECC_POINT_MUL_P256
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : CRYPTO_API_ASYM_ECDSA_P256_SIG_GEN
        package : test.tcp_tls_proxy
        module  : crypto_apis
        spec    : no_pkt.testspec
        args    :
            api:    CRYPTO_API_ASYM_ECDSA_P256_SIG_GEN
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : CRYPTO_API_ASYM_ECDSA_P256_SIG_VERIFY
        package : test.tcp_tls_proxy
        module  : crypto_apis
        spec    : no_pkt.testspec
        args    :
            api:    CRYPTO_API_ASYM_ECDSA_P256_SIG_VERIFY
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : CRYPTO_API_ASYM_RSA2K_ENCRYPT
        package : test.tcp_tls_proxy
        module  : crypto_apis
        spec    : no_pkt.testspec
        args    :
            api:    CRYPTO_API_ASYM_RSA2K_ENCRYPT
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : CRYPTO_API_ASYM_RSA2K_DECRYPT
        package : test.tcp_tls_proxy
        module  : crypto_apis
        spec    : no_pkt.testspec
        args    :
            api:    CRYPTO_API_ASYM_RSA2K_DECRYPT
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : CRYPTO_API_ASYM_RSA2K_CRT_DECRYPT
        package : test.tcp_tls_proxy
        module  : crypto_apis
        spec    : no_pkt.testspec
        args    :
            api:    CRYPTO_API_ASYM_RSA2K_CRT_DECRYPT
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : TCP_PKT_TO_L7Q_IDS_V4
        spec    : one_pkt.testspec
        module  : tcp_pkt_to_l7q_ids
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : TCP_PKT_TO_L7Q_IDS_V6 
        spec    : one_pkt.testspec
        module  : tcp_pkt_to_l7q_ids
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV6
    
    - module:
        name    : TCP_FLOWS_TO_L7Q_IDS_V4
        spec    : one_pkt.testspec
        module  : tcp_pkt_to_l7q_ids
        args    :
            maxflows: 2
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : TCP_PKT_TO_L7Q_IPS_V4
        spec    : one_pkt.testspec
        module  : tcp_pkt_to_l7q_ips
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : TCP_PKT_TO_L7Q_IPS_V6 
        spec    : one_pkt.testspec
        module  : tcp_pkt_to_l7q_ips
        args    :
            maxflows: 1
        iterate :
            - flow: filter://type=IPV6

    - module:
        name    : TCP_FLOWS_TO_L7Q_IPS_V4
        spec    : one_pkt.testspec
        module  : tcp_pkt_to_l7q_ips
        args    :
            maxflows: 2
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : TLS_AES128_GCM_DECRYPT_L7Q_IDS_V4
        package : test.tcp_tls_proxy
        module  : tls_pkt_to_l7q_ids
        spec    : one_tls_aes128_gcm_record_pkt.testspec
        args    :
            maxflows: 1
            key_size : 16
        iterate  :
            - flow: filter://type=IPV4
    - module:
        name    : TLS_AES128_GCM_DECRYPT_L7Q_IPS_V4
        package : test.tcp_tls_proxy
        module  : tls_pkt_to_l7q_ips
        spec    : one_tls_aes128_gcm_record_pkt.testspec
        args    :
            maxflows: 1
            key_size : 16
        iterate  :
            - flow: filter://type=IPV4

