# Feature Test Modules List
feature:
    id      : firewall
    package : test.firewall
    module  : firewall
    enable  : True
    ignore  : False
    spec    : firewall.testspec
    serial  : True

modules:
    - module:
        name    : CONN_SETUP
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK

    - module:
        name    : CONN_SETUP_SIMUL_OPEN
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ONLY
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            - step  : ref://trackerstore/steps/id=RFLOW_ACK

    - module:
        name    : FULL
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # Close from the Initiator Side
            - step  : ref://trackerstore/steps/id=IFLOW_FIN
            - step  : ref://trackerstore/steps/id=RFLOW_ACK
            # Close from the Responder Side
            - step  : ref://trackerstore/steps/id=RFLOW_FIN
            - step  : ref://trackerstore/steps/id=IFLOW_ACK

    - module:
        name    : FULL_SEQ_ROLLOVER
        tracker : True
        enable  : False
        args    :
            connspec: ref://trackerstore/connections/id=SEQ_ROLLOVER
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # Close from the Initiator Side
            - step  : ref://trackerstore/steps/id=IFLOW_FIN
            - step  : ref://trackerstore/steps/id=RFLOW_ACK
            # Close from the Responder Side
            - step  : ref://trackerstore/steps/id=RFLOW_FIN
            - step  : ref://trackerstore/steps/id=IFLOW_ACK

    - module:
        name    : INIT_RETRANSMIT
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW Retransmit
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_RETRANSMIT
            # Send some more data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA

    - module:
        name    : RES_RETRANSMIT
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            # First sending rflow data so that the iflow_data
            # when sent will ack it and then we can send a
            # retransmit from responder side.
            # If we reverse this order then since rflow data
            # is still not acked yet it is not considered as
            # a retransmit
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            # RFLOW Retransmit
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_RETRANSMIT
            # Send some more data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA

    - module:
        name    : INIT_LEFT_OVERLAP
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW Overlap Left
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_OVERLAP_LEFT

    - module:
        name    : RES_LEFT_OVERLAP
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            # First sending rflow data so that the iflow_data
            # when sent will ack it and then we can send a
            # partial left overlap packet from responder side.
            # If we reverse this order then since rflow data
            # is still not acked yet it is not considered as
            # a retransmit
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            # RFLOW Overlap Left
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_OVERLAP_LEFT

    - module:
        name    : INIT_OOO_IN_WINDOW
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW OOO In Window
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_OOO_IN_WINDOW

    - module:
        name    : RES_OOO_IN_WINDOW
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # RFLOW OOO In Window
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_OOO_IN_WINDOW


    - module:
        name    : INIT_FULL_OUT_OF_WINDOW
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW Full Out of Window
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_FULL_OUT_OF_WINDOW

    - module:
        name    : RES_FULL_OUT_OF_WINDOW
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # RFLOW Full Out of Window
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_FULL_OUT_OF_WINDOW

    # TCP Data Len = 0, rcvr_win_sz = 0, send packet with rcv_nxt -1
    - module:
        name    : INIT_TDL_0_W_0_RNXT_MINUS_1
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # we need to send some iflow data so that when
            # rflow data with win zero is sent it will advance
            # the ack, otherwise we won't update the new window
            # of zero in HW.
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            # Send updated window from Responder side
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_WIN_ZERO
            - step  : ref://trackerstore/steps/id=IFLOW_ZERO_DATA_RCV_NEXT_MINUS_1

    # TCP Data Len = 0, rcvr_win_sz = 0, send packet with rcv_nxt -1
    - module:
        name    : RES_TDL_0_W_0_RNXT_MINUS_1
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # we need to send some rflow data so that when
            # iflow data with win zero is sent it will advance
            # the ack, otherwise we won't update the new window
            # of zero in HW.
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # Send updated window from Responder side
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_WIN_ZERO
            - step  : ref://trackerstore/steps/id=RFLOW_ZERO_DATA_RCV_NEXT_MINUS_1

    # TCP Data Len = 0, rcvr_win_sz = 0, send packet with rcv_nxt -2
    # Drop case
    - module:
        name    : INIT_TDL_0_W_0_RNXT_MINUS_2
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # we need to send some iflow data so that when
            # rflow data with win zero is sent it will advance
            # the ack, otherwise we won't update the new window
            # of zero in HW.
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            # Send updated window from Responder side
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_WIN_ZERO
            - step  : ref://trackerstore/steps/id=IFLOW_ZERO_DATA_RCV_NEXT_MINUS_2

    # TCP Data Len = 0, rcvr_win_sz = 0, send packet with rcv_nxt -2
    # Drop case
    - module:
        name    : RES_TDL_0_W_0_RNXT_MINUS_2
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # we need to send some rflow data so that when
            # iflow data with win zero is sent it will advance
            # the ack, otherwise we won't update the new window
            # of zero in HW.
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # Send updated window from Responder side
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_WIN_ZERO
            - step  : ref://trackerstore/steps/id=RFLOW_ZERO_DATA_RCV_NEXT_MINUS_2

    # TCP Data Len = 0, rcvr_win_sz = 0, send packet with rcv_nxt
    - module:
        name    : INIT_TDL_0_W_0_RNXT
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # we need to send some iflow data so that when
            # rflow data with win zero is sent it will advance
            # the ack, otherwise we won't update the new window
            # of zero in HW.
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            # Send updated window from Responder side
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_WIN_ZERO
            - step  : ref://trackerstore/steps/id=IFLOW_ACK

    # TCP Data Len = 0, rcvr_win_sz = 0, send packet with rcv_nxt
    - module:
        name    : RES_TDL_0_W_0_RNXT
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # we need to send some rflow data so that when
            # iflow data with win zero is sent it will advance
            # the ack, otherwise we won't update the new window
            # of zero in HW.
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # Send updated window from Responder side
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_WIN_ZERO
            - step  : ref://trackerstore/steps/id=RFLOW_ACK

    # TCP Data Len = 0, rcvr_win_sz = 0, send packet with rcv_nxt +1
    # Drop case
    - module:
        name    : INIT_TDL_0_W_0_RNXT_PLUS_1
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # we need to send some iflow data so that when
            # rflow data with win zero is sent it will advance
            # the ack, otherwise we won't update the new window
            # of zero in HW.
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            # Send updated window from Responder side
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_WIN_ZERO
            - step  : ref://trackerstore/steps/id=IFLOW_ZERO_DATA_RCV_NEXT_PLUS_1

    # TCP Data Len = 0, rcvr_win_sz = 0, send packet with rcv_nxt +1
    # Drop case
    - module:
        name    : RES_TDL_0_W_0_RNXT_PLUS_1
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # we need to send some rflow data so that when
            # iflow data with win zero is sent it will advance
            # the ack, otherwise we won't update the new window
            # of zero in HW.
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # Send updated window from Responder side
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_WIN_ZERO
            - step  : ref://trackerstore/steps/id=RFLOW_ZERO_DATA_RCV_NEXT_PLUS_1

