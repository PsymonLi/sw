# Feature Test Modules List
feature:
    id      : firewall
    package : test.firewall
    module  : firewall
    enable  : True
    ignore  : False
    spec    : firewall.testspec
    serial  : True

modules:
    - module:
        name    : CONN_SETUP
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK

    - module:
        name    : FULL
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # Close from the Initiator Side
            - step  : ref://trackerstore/steps/id=IFLOW_FIN
            - step  : ref://trackerstore/steps/id=RFLOW_ACK
            # Close from the Responder Side
            - step  : ref://trackerstore/steps/id=RFLOW_FIN
            - step  : ref://trackerstore/steps/id=IFLOW_ACK

    - module:
        name    : INIT_RETRANSMIT
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW Retransmit
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_RETRANSMIT
            # Send some more data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA

    - module:
        name    : RES_RETRANSMIT
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # RFLOW Retransmit
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_RETRANSMIT
            # Send some more data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA

    - module:
        name    : INIT_LEFT_OVERLAP
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW Overlap Left
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_OVERLAP_LEFT

    - module:
        name    : RES_LEFT_OVERLAP
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # RFLOW Overlap Left
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_OVERLAP_LEFT

    - module:
        name    : INIT_OOO_IN_WINDOW
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW OOO In Window
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_OOO_IN_WINDOW

    - module:
        name    : RES_OOO_IN_WINDOW
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # RFLOW OOO In Window
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_OOO_IN_WINDOW


    - module:
        name    : INIT_FULL_OUT_OF_WINDOW
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW Full Out of Window
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_FULL_OUT_OF_WINDOW

    - module:
        name    : RES_FULL_OUT_OF_WINDOW
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # RFLOW Full Out of Window
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_FULL_OUT_OF_WINDOW

