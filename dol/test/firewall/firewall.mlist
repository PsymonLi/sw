# Feature Test Modules List
feature:
    id      : firewall
    package : test.firewall
    module  : firewall
    enable  : True
    ignore  : False
    spec    : firewall.testspec
    serial  : True

modules:
    - module:
        name    : CONN_SETUP
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK

    - module:
        name    : FULL
        tracker : True
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # Close from the Initiator Side
            - step  : ref://trackerstore/steps/id=IFLOW_FIN
            - step  : ref://trackerstore/steps/id=RFLOW_ACK
            # Close from the Responder Side
            - step  : ref://trackerstore/steps/id=RFLOW_FIN
            - step  : ref://trackerstore/steps/id=IFLOW_ACK

    - module:
        name    : RETRANSMIT
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW Retransmit
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_RETRANSMIT
            # RFLOW Retransmit
            - step  : ref://trackerstore/steps/id=RFLOW_DATA_RETRANSMIT
            # Send some more data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA

    - module:
        name    : LEFT_OVERLAP
        tracker : True
        ignore  : False
        args    :
            connspec: ref://trackerstore/connections/id=DEFAULT
        iterate :
            # 3-way handshake
            - step  : ref://trackerstore/steps/id=IFLOW_SYN
            - step  : ref://trackerstore/steps/id=RFLOW_SYN_ACK
            - step  : ref://trackerstore/steps/id=IFLOW_ACK
            # Send some data in both directions
            - step  : ref://trackerstore/steps/id=IFLOW_DATA
            - step  : ref://trackerstore/steps/id=RFLOW_DATA
            # IFLOW Retransmit
            - step  : ref://trackerstore/steps/id=IFLOW_DATA_OVERLAP_LEFT

