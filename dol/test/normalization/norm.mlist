# For Usage details: Refer <ws>/dol/examples/sample.mlist.example
feature:
    id      : normalization
    package : test.normalization
    module  : normalization
    enable  : True
    ignore  : False

modules:
    - module:
        name    : NORMALIZATION_TCP_STATEFUL
        enable  : False
        spec    : normalization.testspec
        args    :
            flow: filter://type=IPV4,proto=TCP
        iterate :
            # Not applicable for P4
            #- profile    : SEC_PROF_TCP_SYNCOOKIE_EN_ENABLE
            #- profile    : SEC_PROF_TCP_SYNCOOKIE_EN_DISABLE
            #- profile    : SEC_PROF_TCP_SPLIT_HANDSHAKE_DETECT_EN_ENABLE
            #- profile    : SEC_PROF_TCP_SPLIT_HANDSHAKE_DETECT_EN_DISABLE
            # program iflow in syn_rcvd and rflow in init state. Send packet with syn or ack set from responder
            #- profile    : SEC_PROF_TCP_SPLIT_HANDSHAKE_DROP_ENABLE
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_SPLIT_HANDSHAKE,direction=RFLOW
            #- profile    : SEC_PROF_TCP_SPLIT_HANDSHAKE_DROP_DISABLE
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_SPLIT_HANDSHAKE,direction=RFLOW
            # Flow in established state, program iflow mss, send pkt gt mss
            #- profile    : SEC_PROF_TCP_DATA_LEN_GT_MSS_ACTION_ALLOW
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_DATA_LEN_GT_MSS,direction=IFLOW
            #- profile    : SEC_PROF_TCP_DATA_LEN_GT_MSS_ACTION_DROP
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_DATA_LEN_GT_MSS,direction=IFLOW
            # Flow in established state, program iflow wsize, send pkt gt wsize
            #- profile    : SEC_PROF_TCP_DATA_LEN_GT_WIN_SIZE_ACTION_ALLOW
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_DATA_LEN_GT_WSIZE,direction=IFLOW
            #- profile    : SEC_PROF_TCP_DATA_LEN_GT_WIN_SIZE_ACTION_DROP
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_DATA_LEN_GT_WSIZE,direction=IFLOW
            # Flow config - set tcp_ts_option, send pkt without ts option
            #- profile    : SEC_PROF_TCP_UNEXPECTED_TS_OPTION_SET_ACTION_ALLOW
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_TS
            #- profile    : SEC_PROF_TCP_UNEXPECTED_TS_OPTION_SET_ACTION_DROP
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_TS
            # Flow config - unset tcp_ts_option, send pkt with ts option, then it shud nop in edit case
            #- profile    : SEC_PROF_TCP_UNEXPECTED_TS_OPTION_UNSET_ACTION_ALLOW
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM
            #- profile    : SEC_PROF_TCP_UNEXPECTED_TS_OPTION_UNSET_ACTION_DROP
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM
            #- profile    : SEC_PROF_TCP_UNEXPECTED_TS_OPTION_UNSET_ACTION_EDIT
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM
            # Flow config - set tcp_ts_option, send pkt without ts option. must drop/not-drop
            #- profile    : SEC_PROF_TCP_TS_NOT_PRESENT_DROP_ENABLE
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_TS,direction=IFLOW
            #- profile    : SEC_PROF_TCP_TS_NOT_PRESENT_DROP_DISABLE
            #  flow       : filter://type=IPV4,proto=TCP,label=NORM_TS,direction=IFLOW
            # Flow miss case - send new flow tcp pkt with syn unset. verify cpu-rx pkt
            - profile    : SEC_PROF_TCP_NON_SYN_FIRST_PKT_DROP_ENABLE
              flow       : filter://type=IPV4,proto=TCP,label=NORM_TCP_NON_SYN,direction=IFLOW
            - profile    : SEC_PROF_TCP_NON_SYN_FIRST_PKT_DROP_DISABLE
              flow       : filter://type=IPV4,proto=TCP,label=NORM_TCP_NON_SYN,direction=IFLOW

    - module:
        name    : NORMALIZATION_TCP_STATEFUL_IGNORE
        spec    : normalization.testspec
        enable  : False
        ignore  : True
        args    :
            flow: filter://type=IPV4,proto=TCP
        iterate :
            # Flow in established state, program iflow mss, send pkt gt mss
            - profile    : SEC_PROF_TCP_DATA_LEN_GT_MSS_ACTION_EDIT
              flow       : filter://type=IPV4,proto=TCP,label=NORM_DATA_LEN_GT_MSS,direction=IFLOW
            # Flow in established state, program iflow wsize, send pkt gt wsize
            - profile    : SEC_PROF_TCP_DATA_LEN_GT_WIN_SIZE_ACTION_EDIT
              flow       : filter://type=IPV4,proto=TCP,label=NORM_DATA_LEN_GT_WSIZE,direction=IFLOW
            # Flow config - set tcp_ts_option, send pkt without ts option
            - profile    : SEC_PROF_TCP_UNEXPECTED_TS_OPTION_SET_ACTION_EDIT
              flow       : filter://type=IPV4,proto=TCP,label=NORM_TS

    - module:
        name    : NORMALIZATION_IP
        spec    : normalization.testspec
        enable  : True
        ignore  : False
        args    :
            flow: filter://type=IPV4
        iterate :
            - profile    : SEC_PROF_IP_RSVD_FLAGS_ACTION_ALLOW
            - profile    : SEC_PROF_IP_RSVD_FLAGS_ACTION_DROP
            - profile    : SEC_PROF_IP_RSVD_FLAGS_ACTION_EDIT
            - profile    : SEC_PROF_IP_DF_ACTION_ALLOW
            - profile    : SEC_PROF_IP_DF_ACTION_DROP
            - profile    : SEC_PROF_IP_DF_ACTION_EDIT

    - module:
        name    : NORMALIZATION_IP_IGNORE
        spec    : normalization.testspec
        enable  : True
        ignore  : True
        args    :
            flow: filter://type=IPV4
        iterate :
            - profile    : SEC_PROF_IP_OPTIONS_ACTION_ALLOW
            - profile    : SEC_PROF_IP_OPTIONS_ACTION_DROP
            - profile    : SEC_PROF_IP_OPTIONS_ACTION_EDIT
            - profile    : SEC_PROF_IP_INVALID_LEN_ACTION_ALLOW
            - profile    : SEC_PROF_IP_INVALID_LEN_ACTION_DROP
            - profile    : SEC_PROF_IP_INVALID_LEN_ACTION_EDIT

    - module:
        name    : NORMALIZATION_ICMP
        spec    : normalization.testspec
        enable  : True
        ignore  : True
        args    :
            flow: filter://type=IPV4,proto=ICMP
        iterate :
            - profile    : SEC_PROF_ICMP_INVALID_CODE_ECHO_REQ_ACTION_ALLOW
            - profile    : SEC_PROF_ICMP_INVALID_CODE_ECHO_REQ_ACTION_DROP
            - profile    : SEC_PROF_ICMP_INVALID_CODE_ECHO_REQ_ACTION_EDIT
            - profile    : SEC_PROF_ICMP_INVALID_CODE_ECHO_REP_ACTION_ALLOW
            - profile    : SEC_PROF_ICMP_INVALID_CODE_ECHO_REP_ACTION_DROP
            - profile    : SEC_PROF_ICMP_INVALID_CODE_ECHO_REP_ACTION_EDIT
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE4_DROP_ENABLE
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE4_DROP_DISABLE
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE6_DROP_ENABLE
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE6_DROP_DISABLE
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE15_DROP_ENABLE
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE15_DROP_DISABLE
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE39_DROP_ENABLE
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE39_DROP_DISABLE
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE27_DROP_ENABLE
            - profile    : SEC_PROF_ICMP_DEPRECATED_MSGS_TYPE27_DROP_DISABLE
            - profile    : SEC_PROF_ICMP_REDIRECT_MSG_DROP_ENABLE
            - profile    : SEC_PROF_ICMP_REDIRECT_MSG_DROP_DISABLE

    - module:
        name    : NORMALIZATION_TCP_STATELESS_IGNORE
        spec    : normalization.testspec
        enable  : True
        ignore  : True
        args    :
            flow: filter://type=IPV4,proto=TCP
        iterate :
            - profile    : SEC_PROF_TCP_UNEXPECTED_MSS_ACTION_EDIT
            - profile    : SEC_PROF_TCP_UNEXPECTED_WIN_SCALE_ACTION_EDIT
            - profile    : SEC_PROF_TCP_RST_WITH_DATA_ACTION_EDIT
            - profile    : SEC_PROF_TCP_URG_PAYLOAD_MISSING_ACTION_EDIT
            - profile    : SEC_PROF_TCP_URG_PAYLOAD_MISSING_ACTION_DROP

    - module:
        name    : NORMALIZATION_TCP_STATELESS
        spec    : normalization.testspec
        enable  : True
        ignore  : False
        args    :
            flow: filter://type=IPV4,proto=TCP
        iterate :
            - profile    : SEC_PROF_TCP_RSVD_FLAGS_ACTION_ALLOW
            - profile    : SEC_PROF_TCP_RSVD_FLAGS_ACTION_DROP
            - profile    : SEC_PROF_TCP_RSVD_FLAGS_ACTION_EDIT
            - profile    : SEC_PROF_TCP_UNEXPECTED_MSS_ACTION_ALLOW
            - profile    : SEC_PROF_TCP_UNEXPECTED_MSS_ACTION_DROP
            - profile    : SEC_PROF_TCP_UNEXPECTED_WIN_SCALE_ACTION_ALLOW
            - profile    : SEC_PROF_TCP_UNEXPECTED_WIN_SCALE_ACTION_DROP
            - profile    : SEC_PROF_TCP_URG_FLAG_NOT_SET_ACTION_ALLOW
            - profile    : SEC_PROF_TCP_URG_FLAG_NOT_SET_ACTION_DROP
            - profile    : SEC_PROF_TCP_URG_FLAG_NOT_SET_ACTION_EDIT
            - profile    : SEC_PROF_TCP_URG_PTR_NOT_SET_ACTION_ALLOW
            - profile    : SEC_PROF_TCP_URG_PTR_NOT_SET_ACTION_DROP
            - profile    : SEC_PROF_TCP_URG_PTR_NOT_SET_ACTION_EDIT
            - profile    : SEC_PROF_TCP_URG_PAYLOAD_MISSING_ACTION_ALLOW
            - profile    : SEC_PROF_TCP_RST_WITH_DATA_ACTION_ALLOW
            - profile    : SEC_PROF_TCP_RST_WITH_DATA_ACTION_DROP
            - profile    : SEC_PROF_TCP_INVALID_FLAGS_DROP_ENABLE
            - profile    : SEC_PROF_TCP_INVALID_FLAGS_DROP_DISABLE
            - profile    : SEC_PROF_TCP_FLAGS_NONSYN_NOACK_DROP_ENABLE
            - profile    : SEC_PROF_TCP_FLAGS_NONSYN_NOACK_DROP_DISABLE
            - profile    : SEC_PROF_TCP_UNEXPECTED_ECHO_TS_ACTION_ALLOW
            - profile    : SEC_PROF_TCP_UNEXPECTED_ECHO_TS_ACTION_DROP
            - profile    : SEC_PROF_TCP_UNEXPECTED_ECHO_TS_ACTION_EDIT

