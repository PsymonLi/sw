# Feature Test Modules List
feature:
    id          : l4lb
    sub         : tnat
    package     : test.l4lb
    module      : l4lb
    enable      : True
    ignore      : False
    pendol      : True

modules:   
    # Aggregated
    - module:
        # Uplink <-> Uplink
        name    : ROUTED_NW_NW
        spec    : nw_nw_l3.testspec
        iterate :
            # Native -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            # TCP
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            # Native -> Tunnel 
            # UDP
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VXLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VXLAN
            # TCP
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VXLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VXLAN
            # Tunnel -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://fabencap=VXLAN
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://fabencap=VXLAN
              dstseg : filter://fabencap=VLAN
            # TCP
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://fabencap=VXLAN
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://fabencap=VXLAN
              dstseg : filter://fabencap=VLAN

    - module:
        # Uplink <-> Uplink
        name    : BRIDGED_NW_NW
        spec    : nw_nw_l2.testspec
        iterate :
            # Native -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            # TCP
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN

    - module:
        # Host -> Uplink
        name    : BRIDGED_TX_NW
        spec    : tx_nw_l2.testspec
        iterate :
            # Native -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            # TCP
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
    - module:
        # Host -> Uplink Vxlan
        name    : BRIDGED_TX_NW_VXLAN
        spec    : tx_nw_l2_vxlan.testspec
        iterate :
            # Native -> Tunnel 
            # UDP
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
            # TCP
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY

    - module:
        # Host -> Uplink
        name    : ROUTED_TX_NW
        spec    : tx_nw_l3.testspec
        iterate :
            # Native -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            # TCP
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            # Native -> Tunnel 
            # UDP
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://fabencap=VXLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://fabencap=VXLAN
            # TCP
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://fabencap=VXLAN
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://fabencap=VXLAN

    #- module:
    #    # Uplink -> Host
    #    name    : BRIDGED_NW_RX
    #    spec    : nw_rx_l2.testspec
    #    iterate :
    #        # Native -> Native
    #        # UDP
    #        - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
    #          srcseg : filter://fabencap=VLAN
    #          dstseg : filter://any
    #        - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
    #          srcseg : filter://fabencap=VLAN
    #          dstseg : filter://any
    #        # TCP
    #        - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
    #          srcseg : filter://fabencap=VLAN
    #          dstseg : filter://any
    #        - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
    #          srcseg : filter://fabencap=VLAN
    #          dstseg : filter://any
    #        # Tunnel -> Native
    #        # UDP
    #        - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
    #          srcseg : filter://fabencap=VXLAN
    #          dstseg : filter://any
    #        - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
    #          srcseg : filter://fabencap=VXLAN
    #          dstseg : filter://any
    #        # TCP
    #        - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
    #          srcseg : filter://fabencap=VXLAN
    #          dstseg : filter://any
    #        - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
    #          srcseg : filter://fabencap=VXLAN
    #          dstseg : filter://any

    #- module:
    #    # Uplink -> Host
    #    name    : ROUTED_NW_RX
    #    spec    : nw_rx_l3.testspec
    #    iterate :
    #        # Native -> Native
    #        # UDP
    #        - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
    #          srcseg : filter://fabencap=VLAN
    #          dstseg : filter://any
    #        - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
    #          srcseg : filter://fabencap=VLAN
    #          dstseg : filter://any
    #        # TCP
    #        - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
    #          srcseg : filter://fabencap=VLAN
    #          dstseg : filter://any
    #        - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
    #          srcseg : filter://fabencap=VLAN
    #          dstseg : filter://any
    #        # Tunnel -> Native
    #        # UDP
    #        - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
    #          srcseg : filter://fabencap=VXLAN
    #          dstseg : filter://any
    #        - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
    #          srcseg : filter://fabencap=VXLAN
    #          dstseg : filter://any
    #        # TCP
    #        - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
    #          srcseg : filter://fabencap=VXLAN
    #          dstseg : filter://any
    #        - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
    #          srcseg : filter://fabencap=VXLAN
    #          dstseg : filter://any

    - module:
        # Host -> Host
        name    : BRIDGED_TX_RX
        spec    : tx_rx_l2.testspec
        iterate :
            # Native -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://any
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://any
            # TCP
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://any
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://any

    - module:
        # Host -> Host
        name    : ROUTED_TX_RX
        spec    : tx_rx_l3.testspec
        iterate :
            # Native -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://any
            - flow  : filter://label=L4LB,fwtype=L3,proto=UDP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://any
            # TCP
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_PORT
              srcseg : filter://any
              dstseg : filter://any
            - flow  : filter://label=L4LB,fwtype=L3,proto=TCP,nat_type=TWICE_NAT,nat_rw=IP_ONLY
              srcseg : filter://any
              dstseg : filter://any
    
    # DSR 
    - module:
        # Uplink <-> Uplink
        name    : DSR_BRIDGED_NW_NW
        spec    : nw_nw_l2.testspec
        iterate :
            # Native -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=DNAT,nat_rw=MAC_PORT
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=DNAT,nat_rw=MAC_ONLY
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            # TCP
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=DNAT,nat_rw=MAC_PORT
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=DNAT,nat_rw=MAC_ONLY
              srcseg : filter://fabencap=VLAN
              dstseg : filter://fabencap=VLAN

    - module:
        # Host -> Uplink
        name    : DSR_BRIDGED_TX_NW
        spec    : tx_nw_l2.testspec
        iterate :
            # Native -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=DNAT,nat_rw=MAC_PORT
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=DNAT,nat_rw=MAC_ONLY
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            # TCP
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=DNAT,nat_rw=MAC_PORT
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=DNAT,nat_rw=MAC_ONLY
              srcseg : filter://any
              dstseg : filter://fabencap=VLAN

    - module:
        # Host -> Uplink Vxlan
        name    : DSR_BRIDGED_TX_NW_VXLAN
        spec    : tx_nw_l2_vxlan.testspec
        iterate :
            # Native -> Tunnel 
            # UDP
            - flow  : filter://label=L4LB,proto=UDP,nat_type=DNAT,nat_rw=MAC_PORT
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=DNAT,nat_rw=MAC_ONLY
            # TCP
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=DNAT,nat_rw=MAC_PORT
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=DNAT,nat_rw=MAC_ONLY

    - module:
        # Host -> Host
        name    : DSR_BRIDGED_TX_RX
        spec    : tx_rx_l2.testspec
        iterate :
            # Native -> Native
            # UDP
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=DNAT,nat_rw=MAC_PORT
            - flow  : filter://label=L4LB,fwtype=L2,proto=UDP,nat_type=DNAT,nat_rw=MAC_ONLY
            # TCP
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=DNAT,nat_rw=MAC_PORT
            - flow  : filter://label=L4LB,fwtype=L2,proto=TCP,nat_type=DNAT,nat_rw=MAC_ONLY
