# Feature Test Modules List
#
feature:
    id          : app_redir
    package     : test.app_redir
    module      : app_redir
    enable      : True
    ignore      : False

modules:
    - module:
        name    : APP_REDIR_RAW_RX_TX
        module  : app_redir_raw_rx_tx
        spec    : app_redir_raw.testspec
        args    :
            num_pkts : 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_RAW_RX_TX_MULTI_PKTS
        module  : app_redir_raw_rx_tx
        spec    : app_redir_raw_multi_pkts.testspec
        args    :
            num_pkts : 3
            num_flow_miss_pkts : 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_RAW_MYSQL_APPID
        module  : app_redir_raw_appid
        spec    : app_redir_raw_mysql_appid.testspec
        args    :
            num_pkts : 4
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_RAW_DNS
        module  : app_redir_raw_appid
        spec    : app_redir_raw_dns.testspec
        args    :
            num_pkts : 2
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_RAW_HTTP
        module  : app_redir_raw_appid
        spec    : app_redir_raw_http.testspec
        args    :
            num_pkts : 5
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_RAW_MONGO
        module  : app_redir_raw_appid
        spec    : app_redir_raw_mongo.testspec
        #enable  : False
        args    :
            num_pkts : 5
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_RAW_CASSANDRA
        module  : app_redir_raw_appid
        spec    : app_redir_raw_cassandra.testspec
        #enable  : False
        args    :
            num_pkts : 5
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_RAW_POSTGRES
        module  : app_redir_raw_appid
        spec    : app_redir_raw_postgres.testspec
        args    :
            num_pkts : 5
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_PROXY_TCP_TLS_ENCRYPT
        module  : app_redir_proxy_tcp_tls_encrypt
        spec    : app_redir_proxy.testspec
        args    :
            cipher_suite: GCM
            maxflows: 1
            key_size : 16
            num_pkts : 1
            proxyr_meta_pages : 1

    - module:
        name    : APP_REDIR_PROXY_TCP_TLS_DECRYPT
        module  : app_redir_proxy_tcp_tls_decrypt
        spec    : app_redir_proxy_one_tls_aes128_gcm.testspec
        args    :
            cipher_suite: GCM
            maxflows: 1
            key_size : 16
            num_pkts : 1
            proxyr_meta_pages : 1
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_RAW_MYSQL
        module  : app_redir_raw_appid
        spec    : app_redir_raw_mysql.testspec
        args    :
            num_pkts : 4
        iterate :
            - flow: filter://type=IPV4

    - module:
        name    : APP_REDIR_RAW_SPAN
        module  : app_redir_raw_rx_tx
        spec    : app_redir_raw_span.testspec
        args    :
            num_pkts : 1
            redir_span : True
        iterate :
            - flow: filter://type=IPV4

