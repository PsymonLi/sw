# This file contains the list of DOL test modules.
modules:
    - module:
        name    : L2UC_QTAG_IPV4_UDP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        args    :
            flow    : filter://type=IPV4,proto=UDP
            segment : filter://native=False
    - module:
        name    : L2UC_UNTAG_IPV4_UDP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        ignore  : False
        args    :
            flow    : filter://type=IPV4,proto=UDP
            segment : filter://native=True
    - module:
        name    : L2UC_QTAG_IPV4_TCP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        args    :
            flow    : filter://type=IPV4,proto=TCP
            segment : filter://native=False
    - module:
        name    : L2UC_UNTAG_IPV4_TCP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        ignore  : False
        args    :
            flow    : filter://type=IPV4,proto=TCP
            segment : filter://native=True
    - module:
        name    : L2UC_QTAG_IPV4_ICMP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        ignore  : False
        args    :
            flow    : filter://type=IPV4,proto=ICMP
            segment : filter://native=False
    - module:
        name    : L2UC_UNTAG_IPV4_ICMP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        ignore  : False
        args    :
            flow    : filter://type=IPV4,proto=ICMP
            segment : filter://native=True
    - module:
        name    : L2UC_QTAG_IPV6_UDP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        args    :
            flow    : filter://type=IPV6,proto=UDP
            segment : filter://native=False
    - module:
        name    : L2UC_UNTAG_IPV6_UDP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        ignore  : False
        args    :
            flow    : filter://type=IPV6,proto=UDP
            segment : filter://native=True
    - module:
        name    : L2UC_QTAG_IPV6_TCP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        args    :
            flow    : filter://type=IPV6,proto=TCP
            segment : filter://native=False
    - module:
        name    : L2UC_UNTAG_IPV6_TCP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc.testspec
        ignore  : False
        args    :
            flow    : filter://type=IPV6,proto=TCP
            segment : filter://native=True
    - module:
        name    : L2UC_QTAG_NONIP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc_nonip.testspec
        ignore  : False
        args    :
            segment: filter://native=False
    - module:
        name    : L2UC_UNTAG_NONIP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc_nonip.testspec
        ignore  : False
        args    :
            segment: filter://native=True
    - module:
        name    : L2UC_QTAG_ARP_RARP
        enable  : True
        package : test.networking
        module  : networking
        spec    : arp.testspec
        ignore  : False
        args    :
            segment: filter://native=False
        iterate :
            - ARP_REQ_UC
            - ARP_RESP
            - RARP_REQ_UC
            - RARP_RESP

    - module:
        name    : L2UC_UNTAG_ARP_RARP
        enable  : True
        package : test.networking
        module  : networking
        spec    : arp.testspec
        ignore  : False
        args    :
            segment: filter://native=True
        iterate :
            - ARP_REQ_UC
            - ARP_RESP
            - RARP_REQ_UC
            - RARP_RESP

    - module:
        name    : L2UC_VXLAN_IPV4_UDP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l2uc_vxlan.testspec
        ignore  : True
        args    :
            flow    : filter://type=IPV4,proto=UDP

    - module:
        name    : L3UC_IPV4_UDP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l3uc.testspec
        ignore  : False
        args    :
            flow: filter://type=IPV4,proto=UDP
    - module:
        name    : L3UC_IPV6_UDP
        enable  : True
        package : test.networking
        module  : networking
        spec    : l3uc.testspec
        ignore  : False
        args    :
            flow: filter://type=IPV6,proto=UDP
    - module:
        name    : PKT_TO_SERQ
        enable  : True
        package : test.tcp-tls-proxy
        module  : tcp_proxy
        spec    : tcp_proxy.testspec
        ignore  : False
        args    :
            flow: filter://type=IPV4,proto=TCP
    - module:
        name    : PKT_TO_BSQ
        enable  : True
        package : test.tcp-tls-proxy
        module  : pkt_to_bsq
        spec    : tcp_proxy.testspec
        ignore  : False
        args    :
            flow: filter://type=IPV4,proto=TCP
    - module:
        name    : RDMA_BTH_BASIC
        enable  : True
        package : test.rdma
        module  : rdma
        spec    : firstpacket.testspec
        ignore  : True
    - module:
        name    : NORMALIZATION_IP
        enable  : True
        package : test.normalization
        module  : normalization
        spec    : normalization.testspec
        ignore  : False
        args    :
            flow: filter://type=IPV4
        iterate :
            - SEC_PROF_IP_RSVD_FLAGS_ACTION_ALLOW
            - SEC_PROF_IP_RSVD_FLAGS_ACTION_DROP
            - SEC_PROF_IP_RSVD_FLAGS_ACTION_EDIT
    - module:
        name    : NORMALIZATION_IP_IGNORE
        enable  : True
        package : test.normalization
        module  : normalization
        spec    : normalization.testspec
        ignore  : True
        args    :
            flow: filter://type=IPV4
        iterate :
            - SEC_PROF_IP_DF_ACTION_ALLOW
            - SEC_PROF_IP_DF_ACTION_DROP
            - SEC_PROF_IP_DF_ACTION_EDIT
            - SEC_PROF_IP_OPTIONS_ACTION_ALLOW
            - SEC_PROF_IP_OPTIONS_ACTION_DROP
            - SEC_PROF_IP_OPTIONS_ACTION_EDIT
            - SEC_PROF_IP_INVALID_LEN_ACTION_ALLOW
            - SEC_PROF_IP_INVALID_LEN_ACTION_DROP
            - SEC_PROF_IP_INVALID_LEN_ACTION_EDIT
    - module:
        name    : NORMALIZATION_ICMP
        enable  : True
        package : test.normalization
        module  : normalization
        spec    : normalization.testspec
        ignore  : True
        args    :
            flow: filter://type=IPV4,proto=ICMP
        iterate :
            - SEC_PROF_ICMP_INVALID_CODE_ACTION_ALLOW
            - SEC_PROF_ICMP_INVALID_CODE_ACTION_DROP
            - SEC_PROF_ICMP_INVALID_CODE_ACTION_EDIT
            - SEC_PROF_ICMP_DEPRECATED_MSGS_DROP_ENABLE
            - SEC_PROF_ICMP_DEPRECATED_MSGS_DROP_DISABLE
            - SEC_PROF_ICMP_REDIRECT_MSG_DROP_ENABLE
            - SEC_PROF_ICMP_REDIRECT_MSG_DROP_DISABLE
    - module:
        name    : NORMALIZATION_TCP_STATELESS
        enable  : True
        package : test.normalization
        module  : normalization
        spec    : normalization.testspec
        ignore  : True
        args    :
            flow: filter://type=IPV4,proto=TCP
        iterate :
            - SEC_PROF_TCP_RSVD_FLAGS_ACTION_ALLOW
            - SEC_PROF_TCP_RSVD_FLAGS_ACTION_DROP
            - SEC_PROF_TCP_RSVD_FLAGS_ACTION_EDIT
            - SEC_PROF_TCP_UNEXPECTED_MSS_ACTION_ALLOW
            - SEC_PROF_TCP_UNEXPECTED_MSS_ACTION_DROP
            - SEC_PROF_TCP_UNEXPECTED_MSS_ACTION_EDIT
            - SEC_PROF_TCP_UNEXPECTED_WIN_SCALE_ACTION_ALLOW
            - SEC_PROF_TCP_UNEXPECTED_WIN_SCALE_ACTION_DROP
            - SEC_PROF_TCP_UNEXPECTED_WIN_SCALE_ACTION_EDIT
            - SEC_PROF_TCP_URG_FLAG_NOT_SET_ACTION_ALLOW
            - SEC_PROF_TCP_URG_FLAG_NOT_SET_ACTION_DROP
            - SEC_PROF_TCP_URG_FLAG_NOT_SET_ACTION_EDIT
            - SEC_PROF_TCP_URG_PAYLOAD_MISSING_ACTION_ALLOW
            - SEC_PROF_TCP_URG_PAYLOAD_MISSING_ACTION_DROP
            - SEC_PROF_TCP_URG_PAYLOAD_MISSING_ACTION_EDIT
            - SEC_PROF_TCP_URG_PTR_NOT_SET_ACTION_ALLOW
            - SEC_PROF_TCP_URG_PTR_NOT_SET_ACTION_DROP
            - SEC_PROF_TCP_URG_PTR_NOT_SET_ACTION_EDIT
            - SEC_PROF_TCP_RST_WITH_DATA_ACTION_ALLOW
            - SEC_PROF_TCP_RST_WITH_DATA_ACTION_DROP
            - SEC_PROF_TCP_RST_WITH_DATA_ACTION_EDIT
            - SEC_PROF_TCP_INVALID_FLAGS_DROP_ENABLE
            - SEC_PROF_TCP_INVALID_FLAGS_DROP_DISABLE
            - SEC_PROF_TCP_FLAGS_NONSYN_NOACK_DROP_ENABLE
            - SEC_PROF_TCP_FLAGS_NONSYN_NOACK_DROP_DISABLE
            - SEC_PROF_TCP_UNEXPECTED_ECHO_TS_ACTION_ALLOW
            - SEC_PROF_TCP_UNEXPECTED_ECHO_TS_ACTION_DROP
            - SEC_PROF_TCP_UNEXPECTED_ECHO_TS_ACTION_EDIT
    - module:
        name    : NORMALIZATION_TCP_STATEFUL
        enable  : True
        package : test.normalization
        module  : normalization
        spec    : normalization.testspec
        ignore  : True
        args    :
            flow: filter://type=IPV4,proto=TCP
        iterate :
            - SEC_PROF_TCP_NON_SYN_FIRST_PKT_DROP_ENABLE
            - SEC_PROF_TCP_NON_SYN_FIRST_PKT_DROP_DISABLE
            - SEC_PROF_TCP_SYNCOOKIE_EN_ENABLE
            - SEC_PROF_TCP_SYNCOOKIE_EN_DISABLE
            - SEC_PROF_TCP_SPLIT_HANDSHAKE_DETECT_EN_ENABLE
            - SEC_PROF_TCP_SPLIT_HANDSHAKE_DETECT_EN_DISABLE
            - SEC_PROF_TCP_SPLIT_HANDSHAKE_DROP_ENABLE
            - SEC_PROF_TCP_SPLIT_HANDSHAKE_DROP_DISABLE
            - SEC_PROF_TCP_DATA_LEN_GT_MSS_ACTION_ALLOW
            - SEC_PROF_TCP_DATA_LEN_GT_MSS_ACTION_DROP
            - SEC_PROF_TCP_DATA_LEN_GT_MSS_ACTION_EDIT
            - SEC_PROF_TCP_DATA_LEN_GT_WIN_SIZE_ACTION_ALLOW
            - SEC_PROF_TCP_DATA_LEN_GT_WIN_SIZE_ACTION_DROP
            - SEC_PROF_TCP_DATA_LEN_GT_WIN_SIZE_ACTION_EDIT
            - SEC_PROF_TCP_UNEXPECTED_TS_OPTION_ACTION_ALLOW
            - SEC_PROF_TCP_UNEXPECTED_TS_OPTION_ACTION_DROP
            - SEC_PROF_TCP_UNEXPECTED_TS_OPTION_ACTION_EDIT
            - SEC_PROF_TCP_TS_NOT_PRESENT_DROP_ENABLE
            - SEC_PROF_TCP_TS_NOT_PRESENT_DROP_DISABLE
    - module:
        name    : ACL_IPV4
        enable  : True
        package : test.acl
        module  : acl
        spec    : ipv4.testspec
        args    : 
            flow: filter://type=IPV4
    - module:
        name    : ACL_ETH
        enable  : True
        package : test.acl
        module  : acl
        spec    : eth.testspec
        args    : None
    - module:
        name    : SFW_IN_SEQUENCE
        enable  : True
        package : test.firewall
        module  : sfw_in_sequence
        spec    : sfw_in_sequence.testspec
        ignore  : True

