# Apulu RFC IPv4 Egress modules list
feature:
    id          : rfc
    sub         : ipv4_egress
    package     : test.rfc
    module      : rfc
    enable      : False #Fix testspec once Sai raises PR for lpm
    ignore      : True

modules:

    - module:
        name    : ALLOW_ALL
        spec    : rfc_egress.testspec
        iterate :
            - policy : filter://AddrFamily=IPV4,PolicyType=allow_all,Level=subnet

    - module:
        name    : SPECIFIC
        spec    : rfc_egress.testspec
        iterate :
            - policy : filter://AddrFamily=IPV4,PolicyType=user_specific,Level=subnet
            #- policy : filter://AddrFamily=IPV4,PolicyType=icmp_specific,Level=subnet

    - module:
        name    : DISJOINT_RANDOM
        spec    : rfc_egress.testspec
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=none,Level=subnet

    - module:
        name    : DISJOINT_FIRST
        spec    : rfc_egress.testspec
        args    :
            - prefix : first
            - sport  : first
            - dport  : first
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=none,Level=subnet

    - module:
        name    : DISJOINT_LAST
        spec    : rfc_egress.testspec
        args    :
            - prefix : last
            - sport  : last
            - dport  : last
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=none,Level=subnet

    - module:
        name    : DISJOINT_LEFT
        spec    : rfc_egress.testspec
        args    :
            - prefix : left
            - sport  : left
            - dport  : left
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=none,Level=subnet

    - module:
        name    : DISJOINT_RIGHT
        spec    : rfc_egress.testspec
        args    :
            - prefix : right
            - sport  : right
            - dport  : right
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=none,Level=subnet

    - module:
        name    : OVERLAP_RANDOM
        spec    : rfc_egress.testspec
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=partial,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=full_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_overlap,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport_full,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport_full,Level=subnet

    - module:
        name    : OVERLAP_FIRST
        spec    : rfc_egress.testspec
        args    :
            - prefix : first
            - sport  : first
            - dport  : first
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=partial,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=full_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_overlap,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport_full,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport_full,Level=subnet

    - module:
        name    : OVERLAP_LAST
        spec    : rfc_egress.testspec
        args    :
            - prefix : last
            - sport  : last
            - dport  : last
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=partial,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=full_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_overlap,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport_full,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport_full,Level=subnet

    - module:
        name    : OVERLAP_LEFT
        spec    : rfc_egress.testspec
        args    :
            - prefix : left
            - sport  : left
            - dport  : left
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=partial,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=full_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_overlap,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport_full,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport_full,Level=subnet

    - module:
        name    : OVERLAP_RIGHT
        spec    : rfc_egress.testspec
        args    :
            - prefix : right
            - sport  : right
            - dport  : right
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=partial,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=full_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_overlap,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=sport_full,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=dport_full,Level=subnet

    - module:
        name    : ADJACENT_RANDOM
        spec    : rfc_egress.testspec
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx_with_default,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_adjacent,Level=subnet

    - module:
        name    : ADJACENT_FIRST
        spec    : rfc_egress.testspec
        args    :
            - prefix : first
            - sport  : first
            - dport  : first
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx_with_default,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_adjacent,Level=subnet

    - module:
        name    : ADJACENT_LAST
        spec    : rfc_egress.testspec
        args    :
            - prefix : last
            - sport  : last
            - dport  : last
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx_with_default,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_adjacent,Level=subnet

    - module:
        name    : ADJACENT_LEFT
        spec    : rfc_egress.testspec
        args    :
            - prefix : left
            - sport  : left
            - dport  : left
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx_with_default,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_adjacent,Level=subnet

    - module:
        name    : ADJACENT_RIGHT
        spec    : rfc_egress.testspec
        args    :
            - prefix : right
            - sport  : right
            - dport  : right
        iterate :
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=adjacent_pfx_with_default,Level=subnet
            - policy : filter://AddrFamily=IPV4,OverlapType=pfx_adjacent,Level=subnet
