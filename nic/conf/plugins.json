{
    "plugins": [
        {
            "name"      : "network",
            "provider"  : "pensando.io",
            "lib"       : "network/libnetwork.so",
            "init_func" : "network_init",
            "exit_func" : "network_exit",
            "auto_load" : "true",
            "deps"      : [],
            "features"  : [
                "stage-marker",
                "fwding",
                "fwding-pre-stage",
                "tunnel",
                "qos",
                "ingress-checks"
            ]
        },
        {
            "name"      : "alg_utils",
            "provider"  : "pensando.io",
            "lib"       : "alg_utils/libalg_utils.so",
            "init_func" : "alg_utils_init",
            "exit_func" : "alg_utils_exit",
            "auto_load" : "true",
            "deps"      : [],
            "features"  : ["alg_utils"]
        },
        {
            "name"      : "sfw",
            "provider"  : "pensando.io",
            "lib"       : "sfw/libsfw.so",
            "init_func" : "sfw_init",
            "exit_func" : "sfw_exit",
            "auto_load" : "true",
            "deps"      : ["pensando.io/alg_utils"],
            "features"  : [
                "sfw",
                "conntrack"
            ]
        },
        {
            "name"      : "alg_sip",
            "provider"  : "pensando.io",
            "lib"       : "alg_sip/libalg_sip.so",
            "init_func" : "alg_sip_init",
            "exit_func" : "alg_sip_exit",
            "auto_load" : "true",
            "deps"      : ["pensando.io/sfw", "pensando.io/alg_utils"],
            "features"  : ["alg_sip"]
        },
        {
            "name"      : "alg_tftp",
            "provider"  : "pensando.io",
            "lib"       : "alg_tftp/libalg_tftp.so",
            "init_func" : "alg_tftp_init",
            "exit_func" : "alg_tftp_exit",
            "auto_load" : "true",
            "deps"      : ["pensando.io/sfw", "pensando.io/alg_utils"],
            "features"  : ["alg_tftp"]
        },
        {
            "name"      : "alg_dns",
            "provider"  : "pensando.io",
            "lib"       : "alg_dns/libalg_dns.so",
            "init_func" : "alg_dns_init",
            "exit_func" : "alg_dns_exit",
            "auto_load" : "true",
            "deps"      : ["pensando.io/sfw", "pensando.io/alg_utils"],
            "features"  : ["alg_dns"]
        },
        {
            "name"      : "alg_rpc",
            "provider"  : "pensando.io",
            "lib"       : "alg_rpc/libalg_rpc.so",
            "init_func" : "alg_rpc_init",
            "exit_func" : "alg_rpc_exit",
            "auto_load" : "true",
            "deps"      : ["pensando.io/sfw", "pensando.io/alg_utils"],
            "features"  : ["alg_rpc"]
        },
        {
            "name"      : "alg_rtsp",
            "provider"  : "pensando.io",
            "lib"       : "alg_rtsp/libalg_rtsp.so",
            "init_func" : "alg_rtsp_init",
            "exit_func" : "alg_rtsp_exit",
            "auto_load" : "true",
            "deps"      : ["pensando.io/sfw", "pensando.io/alg_utils"],
            "features"  : ["alg_rtsp"]
        },
        {
            "name"      : "alg_ftp",
            "provider"  : "pensando.io",
            "lib"       : "alg_ftp/libalg_ftp.so",
            "init_func" : "alg_ftp_init",
            "exit_func" : "alg_ftp_exit",
            "auto_load" : "true",
            "deps"      : ["pensando.io/sfw", "pensando.io/alg_utils"],
            "features"  : ["alg_ftp"]
        },
        {
            "name"      : "eplearn",
            "provider"  : "pensando.io",
            "lib"       : "eplearn/libeplearn.so",
            "init_func" : "eplearn_init",
            "exit_func" : "eplearn_exit",
            "auto_load" : "true",
            "deps"      : [],
            "features"  : ["eplearn"]
        },
        {
            "name"      : "lb",
            "provider"  : "pensando.io",
            "lib"       : "lb/liblb.so",
            "init_func" : "lb_init",
            "exit_func" : "lb_exit",
            "auto_load" : "true",
            "deps"      : [],
            "features"  : ["lb"]
        },
        {
            "name"      : "nat",
            "provider"  : "pensando.io",
            "lib"       : "nat/libnat.so",
            "init_func" : "nat_init",
            "exit_func" : "nat_exit",
            "auto_load" : "true",
            "deps"      : [],
            "features"  : ["nat"]
        },
        {
            "name"      : "dol",
            "provider"  : "pensando.io",
            "lib"       : "dol/libdol.so",
            "init_func" : "dol_init",
            "exit_func" : "dol_exit",
            "auto_load" : "true",
            "deps"      : [],
            "features"  : ["test"]
        },
        {
            "name"      : "proxy",
            "provider"  : "pensando.io",
            "lib"       : "proxy/libproxyplugin.so",
            "init_func" : "proxy_plugin_init",
            "exit_func" : "proxy_exit",
            "auto_load" : "true",
            "deps"      : [],
            "features"  : [
                "tcp",
                "tcp-trigger-connection",
                "quiesce",
                "tls",
                "ipsec",
                "app-p4pt"
            ]
        },
        {
            "name"      : "app-redir",
            "provider"  : "pensando.io",
            "lib"       : "app_redir/libapp_redir.so",
            "init_func" : "app_redir_plugin_init",
            "exit_func" : "app_redir_plugin_exit",
            "thread_init_func" : "app_redir_thread_init",
            "thread_exit_func" : "app_redir_thread_exit",
            "auto_load" : "true",
            "deps"      : [],
            "features"  : [
                "app-redir-miss",
                "app-redir",
                "app-redir-fini",
                "app-redir-appid"
            ]
        },
        {
            "name"      : "nw",
            "provider"  : "pensando.io",
            "lib"       : "nw/libnw.so",
            "auto_load" : "true"
        }
    ],

    "pipelines": [
        {
            "name": "flow-miss",
            "selector": { "lif": "SERVICE_LIF_CPU", "qid": "CPUCB_ID_FLOWMISS" },
            "outbound_features": [
                "pensando.io/dol:test",
                "pensando.io/network:ingress-checks",
                "pensando.io/eplearn:eplearn",
                "pensando.io/sfw:sfw",
                "pensando.io/sfw:conntrack",
                "pensando.io/alg_ftp:alg_ftp",
                "pensando.io/alg_tftp:alg_tftp",
                "pensando.io/alg_dns:alg_dns",
                "pensando.io/alg_rpc:alg_rpc",
                "pensando.io/alg_rtsp:alg_rtsp",
                "pensando.io/proxy:tcp",
                "pensando.io/app-redir:app-redir-miss",
                "pensando.io/app-redir:app-redir-appid",
                "pensando.io/sfw:sfw",
                "pensando.io/network:qos",
                "pensando.io/network:fwding-pre-stage",
                "pensando.io/network:stage-marker",
                "pensando.io/lb:lb",
                "pensando.io/nat:nat",
                "pensando.io/network:qos",
                "pensando.io/proxy:ipsec",
                "pensando.io/network:fwding",
                "pensando.io/network:tunnel",
                "pensando.io/app-redir:app-redir-fini",
                "pensando.io/proxy:tcp-trigger-connection",
                "pensando.io/proxy:app-p4pt"
            ],
            "inbound_features": [
                "pensando.io/dol:test",
                "pensando.io/network:ingress-checks",
                "pensando.io/sfw:sfw",
                "pensando.io/eplearn:eplearn",
                "pensando.io/nat:nat",
                "pensando.io/lb:lb",
                "pensando.io/proxy:tcp",
                "pensando.io/app-redir:app-redir-miss",
                "pensando.io/sfw:sfw",
                "pensando.io/app-redir:app-redir-appid",
                "pensando.io/network:qos",
                "pensando.io/network:fwding-pre-stage",
                "pensando.io/network:stage-marker",
                "pensando.io/sfw:sfw",
                "pensando.io/sfw:conntrack",
                "pensando.io/alg_ftp:alg_ftp",
                "pensando.io/alg_tftp:alg_tftp",
                "pensando.io/alg_dns:alg_dns",
                "pensando.io/alg_rpc:alg_rpc",
                "pensando.io/alg_rtsp:alg_rtsp",
                "pensando.io/network:qos",
                "pensando.io/proxy:ipsec",
                "pensando.io/network:fwding",
                "pensando.io/network:tunnel",
                "pensando.io/app-redir:app-redir-fini",
                "pensando.io/proxy:tcp-trigger-connection",
                "pensando.io/proxy:app-p4pt"
           ]
        },
        {
            "name": "tcp-close",
            "selector": { "lif": "SERVICE_LIF_CPU", "qid": "CPUCB_ID_TCP_CLOSE" },
            "outbound_features": [
                 "pensando.io/dol:test",
                 "pensando.io/sfw:conntrack"
            ]
        },
        {
            "name": "app-redir",
            "selector": { "lif": "SERVICE_LIF_APP_REDIR", "qtype_mask": 1, "qtype": 0},
            "outbound_features": [
                "pensando.io/app-redir:app-redir",
                "pensando.io/app-redir:app-redir-appid",
                "pensando.io/sfw:sfw",
                "pensando.io/network:qos",
                "pensando.io/network:fwding",
                "pensando.io/network:tunnel",
                "pensando.io/app-redir:app-redir-fini"
            ],
            "inbound_features": [
                "pensando.io/app-redir:app-redir",
                "pensando.io/app-redir:app-redir-appid",
                "pensando.io/sfw:sfw",
                "pensando.io/network:qos",
                "pensando.io/network:fwding",
                "pensando.io/network:tunnel",
                "pensando.io/app-redir:app-redir-fini"
            ]
        },
        {
            "name": "alg-cflow",
            "selector": { "lif": "SERVICE_LIF_CPU", "qid": "CPUCB_ID_RELIABLE_COPY" },
            "outbound_features": [
                "pensando.io/alg_ftp:alg_ftp",
                "pensando.io/alg_tftp:alg_tftp",
                "pensando.io/alg_rpc:alg_rpc",
                "pensando.io/alg_rtsp:alg_rtsp"
            ]
        },
        {
            "name": "tcp-proxy",
            "selector": { "lif": "SERVICE_LIF_TCP_PROXY" },
            "outbound_features": [
                "pensando.io/proxy:tcp",
                "pensando.io/app-redir:app-redir",
                "pensando.io/app-redir:app-redir-appid",
                "pensando.io/app-redir:app-redir-fini"
            ]
        },
        {
            "name": "tls-proxy",
            "selector": { "lif": "SERVICE_LIF_TLS_PROXY"},
            "outbound_features": [
                "pensando.io/proxy:tls"
            ]
        },
        {
            "name": "nacl-redirect",
            "selector": { "lif": "SERVICE_LIF_CPU", "qid": "CPUCB_ID_NACL_REDIRECT" },
            "outbound_features": [
                "pensando.io/dol:test"
            ]
        },
        {
            "name": "nacl-log",
            "selector": { "lif": "SERVICE_LIF_CPU", "qid": "CPUCB_ID_NACL_LOG" },
            "outbound_features": [
                "pensando.io/dol:test"
            ]
        },
        {
            "name": "quiesce",
            "selector": { "lif": "SERVICE_LIF_CPU", "qid": "CPUCB_ID_QUIESCE" },
            "outbound_features": [
                "pensando.io/dol:test",
                "pensando.io/proxy:quiesce"
            ]
        }
    ]
}
