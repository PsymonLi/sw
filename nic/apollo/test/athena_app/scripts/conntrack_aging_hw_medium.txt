#Note that the test infra knows the true size of the conntrack table
#so it's fine to specify larger size parameters here. The infra will
#automatically reduce it to the actual table size as needed.

conntrack_aging_init
conntrack_aging_sim_mode false
conntrack_aging_clear_full 368944
conntrack_aging_normal_tmo_set {TCP FIN_SENT 5} {others unestablished 3}
conntrack_populate_full {TCP FIN_SENT 161072}
conntrack_aging_test
conntrack_populate_full {others ESTABLISHED 269844}
conntrack_aging_test

#random with specified {start_idx count} and random {flowtype flowstate}
conntrack_populate_random {371 8119}
conntrack_aging_test
#random with specified {start_idx count} and specified {flowtype flowstate}
conntrack_populate_random {526 2744} {tcp established}
conntrack_aging_test
#random everything
conntrack_populate_random
conntrack_aging_test

conntrack_aging_metrics_show
conntrack_aging_fini
conntrack_aging_sim_mode false

